import{r as c}from"./index-DBCl1piy.js";function y({queryFn:p,params:o}){const[g,a]=c.useState(null),[i,u]=c.useState(!1),[S,r]=c.useState(null),e=c.useRef({}),d=async(t=!1,f)=>{u(!0),r(null);const s=f??o,h=JSON.stringify(s);if(!t&&e.current[h]){a(e.current[h]),u(!1);return}try{const l=await p(s);e.current[h]=l,a(l)}catch(l){r(l.message??"Unknown error")}finally{u(!1)}};return c.useEffect(()=>{d()},[]),{data:g,loading:i,error:S,refetch:d,invalidateCache:()=>{e.current={},a(null)},invalidateCacheFor:t=>{const f=JSON.stringify(t);Object.keys(e.current).forEach(s=>{s.includes(f)&&delete e.current[s]})}}}function E({queryFn:p,defaultParams:o}){const[g,a]=c.useState(1),[i,u]=c.useState(""),S={...o,page:g,search:i},{data:r,loading:e,error:d,refetch:t,invalidateCache:f}=y({queryFn:p,params:S}),s=n=>{n>=1&&n<=(r?.last_page??1)&&(a(n),t(!0,{...o,page:n,search:i}))},h=n=>{a(1),u(n),t(!0,{...o,page:1,search:n})},l=()=>{a(1),u(""),t(!0,{...o,page:1,search:""})};return{data:r?.data??[],total:r?.total??0,loading:e,error:d,lastPage:r?.last_page??1,page:g,search:i,handlePageChange:s,handleSearch:h,resetSearch:l,refetch:t,invalidateCache:f}}export{E as u};
