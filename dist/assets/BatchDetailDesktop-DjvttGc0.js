import{c as u,r as p,s as x,j as e}from"./index-DBCl1piy.js";import{f as b}from"./whatsappUtils-TDaZTic9.js";import{g as j}from"./dateUtils-DnCeXi6b.js";import{a as k}from"./employeeAPI-DHr8FtOu.js";import{t as y}from"./examinationsApi-Bo6n5SZ3.js";import"./pdfjs-BzSgQdvw.js";import"./apiClient-BmXS3_vS.js";import"./index-NIGUFBhG.js";import"./genericApi-B1yEKLU8.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],N=u("circle-check-big",f);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],_=u("circle-x",w);function A(r){const[l,o]=p.useState(()=>r.reduce((a,n)=>(a[n.id]=n.isVisibleToEmployee,a),{})),[d,i]=p.useState(new Set);return{accessState:l,toggleAccess:async a=>{const n=!l[a];try{i(t=>new Set(t).add(a)),await y(a,n?1:0),o(t=>({...t,[a]:n})),x({title:"Berhasil",text:`Hak akses ${n?"diaktifkan":"dinonaktifkan"}.`,icon:"success",timer:1200,showConfirmButton:!1})}catch(t){console.error(t),x({title:"Gagal",text:t?.meta?.message||"Gagal memperbarui hak akses",icon:"error"})}finally{i(t=>{const c=new Set(t);return c.delete(a),c})}},loadingIds:d}}function R({examinations:r,page:l,perPage:o=10}){const d=async t=>{try{const c=await k(t),s=window.URL.createObjectURL(c);window.open(s,"_blank")}catch(c){console.error(c),alert("Gagal memuat hasil pemeriksaan.")}},i=r.map(t=>({id:t.id,isVisibleToEmployee:t.is_visible_to_employee===1||t.isVisibleToEmployee===1})),{accessState:h,toggleAccess:a,loadingIds:n}=A(i);return!r||r.length===0?e.jsx("p",{className:"p-4 text-center text-gray-500",children:"Tidak ada data pemeriksaan."}):e.jsx("div",{className:"hidden md:block max-h-[56vh] overflow-y-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{className:"bg-primary/20 backdrop-blur-3xl text-base-content sticky top-0 z-10",children:e.jsxs("tr",{className:"text-center align-middle",children:[e.jsx("th",{children:"No"}),e.jsx("th",{className:"max-w-[200px]",children:"Paket MCU"}),e.jsx("th",{children:"Nomor Pegawai"}),e.jsx("th",{children:"NIK"}),e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"Gender"}),e.jsx("th",{children:"Tanggal Lahir"}),e.jsx("th",{children:"Kontak"}),e.jsx("th",{children:"Hasil"}),e.jsx("th",{children:"Hak Akses"})]})}),e.jsx("tbody",{className:"align-middle",children:r.map((t,c)=>{const s=t.company_employee,g=typeof t.mcu_package=="string"?t.mcu_package:t.mcu_package?.name||"-",m=typeof t.result=="object"&&t.result!==null&&"id"in t.result?t.result:null;return e.jsxs("tr",{className:"hover:bg-base-200",children:[e.jsx("td",{className:"text-center",children:c+1+(l-1)*o}),e.jsxs("td",{className:"max-w-[200px]",children:[g,t.notes&&e.jsxs("div",{className:"text-xs text-base-content/70 mt-1",children:["Catatan: ",t.notes]})]}),e.jsx("td",{className:"text-center",children:s?.employee_number||"-"}),e.jsx("td",{className:"text-center",children:s?.nik||"-"}),e.jsx("td",{children:s?.name||"-"}),e.jsx("td",{className:"text-center",children:s?.gender||"-"}),e.jsxs("td",{className:"text-center",children:[s?.dob?j(s.dob):"-",e.jsx("br",{}),e.jsx("small",{children:s?.age_detail||""})]}),e.jsx("td",{className:"text-center",children:s?.phone_number?e.jsx("a",{href:b(s.phone_number),target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:s.phone_number}):"-"}),e.jsx("td",{className:"text-center",children:m?e.jsx("button",{className:"btn btn-sm rounded-full w-full text-base-content bg-primary/20",onClick:()=>d(m.id),children:"Lihat Hasil"}):e.jsx("span",{className:"text-gray-500",children:"Belum ada hasil"})}),e.jsx("td",{className:"text-center",children:e.jsx("button",{className:`btn btn-sm flex items-center gap-2 rounded-full w-full text-base-content ${h[t.id]?"bg-primary/20":"bg-secondary/5"}`,disabled:n.has(t.id),onClick:()=>a(t.id),children:h[t.id]?e.jsxs(e.Fragment,{children:[e.jsx(N,{size:16})," Aktif"]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{size:16})," Nonaktif"]})})})]},t.id)})})]})})}export{R as default};
