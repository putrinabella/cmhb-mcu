import{r as i,a as U,j as e,b as f,s as c}from"./index-BfdL3V75.js";import{u as z,a as M,b as R,X as b,S as K,U as L,F as H,E as q,t as A,C as G,f as O,g as W,d as X}from"./whatsappUtils-BaARNaLu.js";import{B as s}from"./button-Dyz-buuH.js";import{u as J}from"./use-paginated-resource-DQv-Wxs9.js";import{P as Q}from"./Pagination-C_09vddA.js";import{g as V}from"./dateUtils-DuzDAtY7.js";import{D as Y}from"./download-CQgvu3-Q.js";import"./pdfjs-BzSgQdvw.js";import"./apiClient-BmXS3_vS.js";import"./index-NIGUFBhG.js";import"./genericApi-B1yEKLU8.js";function ce(){const{downloadBlob:N}=z(),{data:y,handleFileUpload:v,resetData:w}=M(),{importData:C,loading:d}=R(),[x,h]=i.useState(null),[S,l]=i.useState(!1),[r,m]=i.useState(""),{user:p}=U(),{data:u,loading:j,error:n,page:g,lastPage:k,total:D,handlePageChange:E,handleSearch:P,resetSearch:T,invalidateCache:o}=J({queryFn:W,defaultParams:{per_page:10,sort_by:"name",sort_order:"asc"}}),F=()=>{P(r),o()},_=()=>{m(""),T(),o()},B=async()=>{try{const a=await X();N(a,"employee_template.xlsx"),c({icon:"success",title:"Berhasil",text:"Template berhasil diunduh!",timer:2e3,showConfirmButton:!1})}catch(a){console.error(a),c({icon:"error",title:"Gagal",text:"Download gagal!",confirmButtonText:"Coba lagi"})}},I=async()=>{if(!x){c({icon:"warning",title:"Tidak ada file",text:"Silakan upload file Excel terlebih dahulu.",confirmButtonText:"Mengerti"});return}await C(x)&&(l(!1),h(null),w(),o())};return p?e.jsxs("div",{className:"bg-base-100 text-base-content p-2",children:[e.jsx("h3",{className:"text-3xl mb-6",children:"Data Pegawai"}),e.jsxs("div",{className:"flex justify-between items-stretch",children:[e.jsx("div",{className:"flex-1 flex items-center overflow-hidden bg-base-200/40 rounded-t-4xl p-2 justify-center",children:e.jsx("p",{className:"break-words p-4 just",children:p.company?.name||"-"})}),e.jsxs("div",{className:"flex-shrink-0 flex gap-2 items-center px-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Search...",className:"input input-ghost rounded-l-full w-full border border-gray-300 h-10 pr-10",value:r,onChange:a=>m(a.target.value)}),r&&e.jsx("button",{type:"button",onClick:_,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-red-500",title:"Reset",children:e.jsx(b,{className:"w-4 h-4"})})]}),e.jsxs(s,{type:"button",className:"bg-accent text-accent-content hover:bg-accent-focus rounded-r-full h-10 flex items-center gap-2",onClick:F,children:[e.jsx(K,{className:"size-5"}),"Search"]})]}),e.jsx("div",{className:"tooltip","data-tip":"Download template Excel",children:e.jsxs(s,{type:"button",className:"bg-primary text-primary-content hover:bg-primary-focus rounded-full h-10 flex items-center gap-2",onClick:B,children:[e.jsx(Y,{className:"size-5"}),"Download Template"]})})]}),e.jsx("div",{className:"tooltip","data-tip":"Upload File Excel",children:e.jsxs(s,{type:"button",className:"bg-secondary text-accent-content hover:bg-accent-focus rounded-full gap-2",onClick:()=>l(!0),children:[e.jsx(L,{className:"size-5"}),"Import"]})}),S&&e.jsx("div",{className:"modal modal-open",children:e.jsxs("div",{className:"modal-box w-11/12 max-w-6xl",children:[e.jsxs("div",{className:"py-4",children:[e.jsx(H,{label:"Upload File",infoText:"Max size 2MB, format .xlsx/.xls",accept:".xlsx,.xls",onChange:a=>{v(a);const t=a.target.files?.[0];t&&h(t)}}),e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsx(q,{data:y,headers:A})})]}),e.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[e.jsxs(s,{variant:"outline",className:"gap-2 rounded-lg bg-error text-white hover:opacity-90",onClick:()=>l(!1),children:[e.jsx(b,{className:"size-4"}),"Close"]}),e.jsxs(s,{disabled:d,className:"gap-2 rounded-lg bg-primary text-white hover:opacity-90",onClick:I,children:[d?e.jsx(f,{}):null,e.jsx(G,{className:"size-4"}),"Import Data"]})]})]})})]})]}),e.jsx("div",{className:"bg-base-200/40 rounded-4xl rounded-tl-none",children:e.jsxs("div",{className:"p-4 ",children:[j&&e.jsx(f,{}),n&&e.jsx("p",{className:"text-red-500",children:n}),!j&&!n&&e.jsxs("div",{className:"overflow-x-auto mb-4",children:[e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Nomor Pegawai"}),e.jsx("th",{children:"NIK"}),e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"No. HP"}),e.jsx("th",{children:"Tanggal Lahir"}),e.jsx("th",{children:"Usia"})]})}),e.jsx("tbody",{children:u.map((a,t)=>e.jsxs("tr",{className:"hover:bg-secondary",children:[e.jsx("td",{children:(g-1)*10+t+1}),e.jsx("td",{children:a.employee_number}),e.jsx("td",{children:a.nik}),e.jsx("td",{children:a.name}),e.jsx("td",{children:a.phone_number?e.jsx("a",{href:O(a.phone_number),target:"_blank",rel:"noopener noreferrer",className:" hover:underline",children:a.phone_number}):"-"}),e.jsx("td",{children:a.dob?V(a.dob):"-"}),e.jsx("td",{children:a.age_detail})]},a.id))})]}),u.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-4",children:"Tidak ada data pegawai"})]}),e.jsx(Q,{page:g,lastPage:k,onPageChange:E,total:D})]})}),e.jsx("div",{className:"bg-base-200/40 rounded-4xl rounded-tl-none"})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-base-content",children:e.jsx("p",{className:"text-lg",children:"Memuat profil..."})})}export{ce as default};
