import{j as e,r as h,b as x,u as f,d as p}from"./index-huMUteRP.js";import{g as j}from"./companiesAPI-DVHkTGV0.js";import"./apiClient-BmXS3_vS.js";import"./index-NIGUFBhG.js";function g({page:a,lastPage:n,onPageChange:c,perPage:d=10,total:r=0}){const l=r===0?0:(a-1)*d+1,m=r===0?0:Math.min(a*d,r),i=[],o=2;for(let s=1;s<=n;s++)s===1||s===n||s>=a-o&&s<=a+o?i.push(s):i[i.length-1]!=="..."&&i.push("...");return e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 mt-6",children:[e.jsx("p",{className:"text-sm text-gray-500",children:r===0?e.jsx(e.Fragment,{children:"Menampilkan 0 data"}):e.jsxs(e.Fragment,{children:["Menampilkan ",e.jsx("span",{className:"font-medium",children:l})," sampai"," ",e.jsx("span",{className:"font-medium",children:m})," dari"," ",e.jsx("span",{className:"font-medium",children:r})," data"]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>c(a-1),disabled:a===1,className:`btn btn-sm ${a===1?"btn-disabled":"btn-outline"}`,children:"«"}),i.map((s,t)=>s==="..."?e.jsx("span",{className:"btn btn-sm btn-outline cursor-default",children:"..."},`ellipsis-${t}`):e.jsx("button",{onClick:()=>c(s),className:`btn btn-sm ${s===a?"btn-primary":"btn-outline"}`,children:s},s)),e.jsx("button",{onClick:()=>c(a+1),disabled:a===n,className:`btn btn-sm ${a===n?"btn-disabled":"btn-outline"}`,children:"»"})]})]})}function N({queryFn:a,params:n}){const[c,d]=h.useState(null),[r,l]=h.useState(!0),[m,i]=h.useState(null),o=h.useRef({}),s=n.page??1,t=async(u=!1)=>{if(l(!0),i(null),!u&&o.current[s]){d(o.current[s]),l(!1);return}try{const b=await a(n);o.current[s]=b,d(b)}catch(b){i(b.message??"Unknown error")}finally{l(!1)}};return h.useEffect(()=>{t()},[s,JSON.stringify({...n,page:void 0})]),{data:c,loading:r,error:m,refetch:t,invalidateCache:()=>{o.current={},d(null)}}}function C({queryFn:a,defaultParams:n}){const[c,d]=x(),r=Number(c.get("page")||1),{data:l,loading:m,error:i,refetch:o,invalidateCache:s}=N({queryFn:a,params:{...n,page:r}}),t=u=>{u>=1&&u<=(l?.last_page??1)&&d({page:String(u)})};return{data:l?.data??[],total:l?.total??0,loading:m,error:i,lastPage:l?.last_page??1,page:r,handlePageChange:t,refetch:o,invalidateCache:s}}function P(){const{data:a,loading:n,error:c,page:d,lastPage:r,total:l,refetch:m,invalidateCache:i,handlePageChange:o}=C({queryFn:j,defaultParams:{per_page:10,sort_by:"name",sort_order:"asc"}}),s=f();return e.jsxs("div",{className:"p-8 mx-auto min-h-screen bg-base-100 text-base-content",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Daftar Perusahaan"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>m(),children:"🔄 Refresh"}),e.jsx("button",{className:"btn btn-sm",onClick:i,children:"❌ Clear Cache"})]}),n&&e.jsx(p,{}),c&&e.jsx("p",{className:"text-red-500",children:c}),!n&&!c&&e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"space-y-2 mb-6",children:a.map(t=>e.jsxs("li",{className:"p-4 border rounded-lg shadow-sm bg-base-200 cursor-pointer hover:bg-base-300 transition",onClick:()=>s(`/company-profile/${t.id}`),children:[e.jsx("h2",{className:"font-semibold",children:t.name}),e.jsxs("p",{children:["Kode: ",t.code]}),e.jsxs("p",{children:["Alamat: ",t.address]}),e.jsxs("p",{children:["Telp: ",t.phone]}),e.jsxs("p",{children:["Email: ",t.email]})]},t.id))}),e.jsx(g,{page:d,lastPage:r,onPageChange:o,total:l})]})]})}export{P as default};
