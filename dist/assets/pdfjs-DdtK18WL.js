function getDefaultExportFromCjs(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function getAugmentedNamespace(d){if(Object.prototype.hasOwnProperty.call(d,"__esModule"))return d;var o=d.default;if(typeof o=="function"){var I=function u(){var y=!1;try{y=this instanceof u}catch{}return y?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};I.prototype=o.prototype}else I={};return Object.defineProperty(I,"__esModule",{value:!0}),Object.keys(d).forEach(function(u){var y=Object.getOwnPropertyDescriptor(d,u);Object.defineProperty(I,u,y.get?y:{enumerable:!0,get:function(){return d[u]}})}),I}var react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var d=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),n=Symbol.for("react.consumer"),x=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),s=Symbol.for("react.memo"),t=Symbol.for("react.lazy"),i=Symbol.iterator;function f(r){return r===null||typeof r!="object"?null:(r=i&&r[i]||r["@@iterator"],typeof r=="function"?r:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e=Object.assign,g={};function _(r,v,T){this.props=r,this.context=v,this.refs=g,this.updater=T||h}_.prototype.isReactComponent={},_.prototype.setState=function(r,v){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,v,"setState")},_.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function c(){}c.prototype=_.prototype;function w(r,v,T){this.props=r,this.context=v,this.refs=g,this.updater=T||h}var L=w.prototype=new c;L.constructor=w,e(L,_.prototype),L.isPureReactComponent=!0;var M=Array.isArray,m={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function z(r,v,T,P,D,R){return T=R.ref,{$$typeof:d,type:r,key:v,ref:T!==void 0?T:null,props:R}}function $(r,v){return z(r.type,v,void 0,void 0,void 0,r.props)}function j(r){return typeof r=="object"&&r!==null&&r.$$typeof===d}function tt(r){var v={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(T){return v[T]})}var nt=/\/+/g;function bt(r,v){return typeof r=="object"&&r!==null&&r.key!=null?tt(""+r.key):v.toString(36)}function dt(){}function mt(r){switch(r.status){case"fulfilled":return r.value;case"rejected":throw r.reason;default:switch(typeof r.status=="string"?r.then(dt,dt):(r.status="pending",r.then(function(v){r.status==="pending"&&(r.status="fulfilled",r.value=v)},function(v){r.status==="pending"&&(r.status="rejected",r.reason=v)})),r.status){case"fulfilled":return r.value;case"rejected":throw r.reason}}throw r}function At(r,v,T,P,D){var R=typeof r;(R==="undefined"||R==="boolean")&&(r=null);var a=!1;if(r===null)a=!0;else switch(R){case"bigint":case"string":case"number":a=!0;break;case"object":switch(r.$$typeof){case d:case o:a=!0;break;case t:return a=r._init,At(a(r._payload),v,T,P,D)}}if(a)return D=D(r),a=P===""?"."+bt(r,0):P,M(D)?(T="",a!=null&&(T=a.replace(nt,"$&/")+"/"),At(D,v,T,"",function(k){return k})):D!=null&&(j(D)&&(D=$(D,T+(D.key==null||r&&r.key===D.key?"":(""+D.key).replace(nt,"$&/")+"/")+a)),v.push(D)),1;a=0;var b=P===""?".":P+":";if(M(r))for(var A=0;A<r.length;A++)P=r[A],R=b+bt(P,A),a+=At(P,v,T,R,D);else if(A=f(r),typeof A=="function")for(r=A.call(r),A=0;!(P=r.next()).done;)P=P.value,R=b+bt(P,A++),a+=At(P,v,T,R,D);else if(R==="object"){if(typeof r.then=="function")return At(mt(r),v,T,P,D);throw v=String(r),Error("Objects are not valid as a React child (found: "+(v==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":v)+"). If you meant to render a collection of children, use an array instead.")}return a}function ot(r,v,T){if(r==null)return r;var P=[],D=0;return At(r,P,"","",function(R){return v.call(T,R,D++)}),P}function N(r){if(r._status===-1){var v=r._result;v=v(),v.then(function(T){(r._status===0||r._status===-1)&&(r._status=1,r._result=T)},function(T){(r._status===0||r._status===-1)&&(r._status=2,r._result=T)}),r._status===-1&&(r._status=0,r._result=v)}if(r._status===1)return r._result.default;throw r._result}var E=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var v=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(v))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function p(){}return react_production.Children={map:ot,forEach:function(r,v,T){ot(r,function(){v.apply(this,arguments)},T)},count:function(r){var v=0;return ot(r,function(){v++}),v},toArray:function(r){return ot(r,function(v){return v})||[]},only:function(r){if(!j(r))throw Error("React.Children.only expected to receive a single React element child.");return r}},react_production.Component=_,react_production.Fragment=I,react_production.Profiler=y,react_production.PureComponent=w,react_production.StrictMode=u,react_production.Suspense=q,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=m,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(r){return m.H.useMemoCache(r)}},react_production.cache=function(r){return function(){return r.apply(null,arguments)}},react_production.cloneElement=function(r,v,T){if(r==null)throw Error("The argument must be a React element, but you passed "+r+".");var P=e({},r.props),D=r.key,R=void 0;if(v!=null)for(a in v.ref!==void 0&&(R=void 0),v.key!==void 0&&(D=""+v.key),v)!C.call(v,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&v.ref===void 0||(P[a]=v[a]);var a=arguments.length-2;if(a===1)P.children=T;else if(1<a){for(var b=Array(a),A=0;A<a;A++)b[A]=arguments[A+2];P.children=b}return z(r.type,D,void 0,void 0,R,P)},react_production.createContext=function(r){return r={$$typeof:x,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null},r.Provider=r,r.Consumer={$$typeof:n,_context:r},r},react_production.createElement=function(r,v,T){var P,D={},R=null;if(v!=null)for(P in v.key!==void 0&&(R=""+v.key),v)C.call(v,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(D[P]=v[P]);var a=arguments.length-2;if(a===1)D.children=T;else if(1<a){for(var b=Array(a),A=0;A<a;A++)b[A]=arguments[A+2];D.children=b}if(r&&r.defaultProps)for(P in a=r.defaultProps,a)D[P]===void 0&&(D[P]=a[P]);return z(r,R,void 0,void 0,null,D)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(r){return{$$typeof:V,render:r}},react_production.isValidElement=j,react_production.lazy=function(r){return{$$typeof:t,_payload:{_status:-1,_result:r},_init:N}},react_production.memo=function(r,v){return{$$typeof:s,type:r,compare:v===void 0?null:v}},react_production.startTransition=function(r){var v=m.T,T={};m.T=T;try{var P=r(),D=m.S;D!==null&&D(T,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(p,E)}catch(R){E(R)}finally{m.T=v}},react_production.unstable_useCacheRefresh=function(){return m.H.useCacheRefresh()},react_production.use=function(r){return m.H.use(r)},react_production.useActionState=function(r,v,T){return m.H.useActionState(r,v,T)},react_production.useCallback=function(r,v){return m.H.useCallback(r,v)},react_production.useContext=function(r){return m.H.useContext(r)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(r,v){return m.H.useDeferredValue(r,v)},react_production.useEffect=function(r,v,T){var P=m.H;if(typeof T=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return P.useEffect(r,v)},react_production.useId=function(){return m.H.useId()},react_production.useImperativeHandle=function(r,v,T){return m.H.useImperativeHandle(r,v,T)},react_production.useInsertionEffect=function(r,v){return m.H.useInsertionEffect(r,v)},react_production.useLayoutEffect=function(r,v){return m.H.useLayoutEffect(r,v)},react_production.useMemo=function(r,v){return m.H.useMemo(r,v)},react_production.useOptimistic=function(r,v){return m.H.useOptimistic(r,v)},react_production.useReducer=function(r,v,T){return m.H.useReducer(r,v,T)},react_production.useRef=function(r){return m.H.useRef(r)},react_production.useState=function(r){return m.H.useState(r)},react_production.useSyncExternalStore=function(r,v,T){return m.H.useSyncExternalStore(r,v,T)},react_production.useTransition=function(){return m.H.useTransition()},react_production.version="19.1.1",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var lib={exports:{}},core_min={};function commonjsRequire(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports){(function(o,I){module.exports=o.pdfjsLib=I()})(globalThis,()=>(()=>{var __webpack_modules__=[,((d,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.VerbosityLevel=o.Util=o.UnknownErrorException=o.UnexpectedResponseException=o.TextRenderingMode=o.RenderingIntentFlag=o.PromiseCapability=o.PermissionFlag=o.PasswordResponses=o.PasswordException=o.PageActionEventType=o.OPS=o.MissingPDFException=o.MAX_IMAGE_SIZE_TO_CACHE=o.LINE_FACTOR=o.LINE_DESCENT_FACTOR=o.InvalidPDFException=o.ImageKind=o.IDENTITY_MATRIX=o.FormatError=o.FeatureTest=o.FONT_IDENTITY_MATRIX=o.DocumentActionEventType=o.CMapCompressionType=o.BaseException=o.BASELINE_FACTOR=o.AnnotationType=o.AnnotationReplyType=o.AnnotationPrefix=o.AnnotationMode=o.AnnotationFlag=o.AnnotationFieldFlag=o.AnnotationEditorType=o.AnnotationEditorPrefix=o.AnnotationEditorParamsType=o.AnnotationBorderStyleType=o.AnnotationActionEventType=o.AbortException=void 0,o.assert=p,o.bytesToString=U,o.createValidAbsoluteUrl=v,o.getModificationDate=Ae,o.getUuid=un,o.getVerbosityLevel=At,o.info=ot,o.isArrayBuffer=ne,o.isArrayEqual=Me,o.isNodeJS=void 0,o.normalizeUnicode=qe,o.objectFromMap=rt,o.objectSize=St,o.setVerbosityLevel=mt,o.shadow=T,o.string32=it,o.stringToBytes=X,o.stringToPDFString=Bt,o.stringToUTF8String=Xt,o.unreachable=E,o.utf8StringToString=$t,o.warn=N;const I=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");o.isNodeJS=I;const u=[1,0,0,1,0,0];o.IDENTITY_MATRIX=u;const y=[.001,0,0,.001,0,0];o.FONT_IDENTITY_MATRIX=y;const n=1e7;o.MAX_IMAGE_SIZE_TO_CACHE=n;const x=1.35;o.LINE_FACTOR=x;const V=.35;o.LINE_DESCENT_FACTOR=V;const q=V/x;o.BASELINE_FACTOR=q;const s={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};o.RenderingIntentFlag=s;const t={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};o.AnnotationMode=t;const i="pdfjs_internal_editor_";o.AnnotationEditorPrefix=i;const f={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};o.AnnotationEditorType=f;const h={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};o.AnnotationEditorParamsType=h;const e={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};o.PermissionFlag=e;const g={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};o.TextRenderingMode=g;const _={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};o.ImageKind=_;const c={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};o.AnnotationType=c;const w={GROUP:"Group",REPLY:"R"};o.AnnotationReplyType=w;const L={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};o.AnnotationFlag=L;const M={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};o.AnnotationFieldFlag=M;const m={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};o.AnnotationBorderStyleType=m;const C={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};o.AnnotationActionEventType=C;const z={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};o.DocumentActionEventType=z;const $={O:"PageOpen",C:"PageClose"};o.PageActionEventType=$;const j={ERRORS:0,WARNINGS:1,INFOS:5};o.VerbosityLevel=j;const tt={NONE:0,BINARY:1};o.CMapCompressionType=tt;const nt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};o.OPS=nt;const bt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};o.PasswordResponses=bt;let dt=j.WARNINGS;function mt(_t){Number.isInteger(_t)&&(dt=_t)}function At(){return dt}function ot(_t){dt>=j.INFOS&&console.log(`Info: ${_t}`)}function N(_t){dt>=j.WARNINGS&&console.log(`Warning: ${_t}`)}function E(_t){throw new Error(_t)}function p(_t,et){_t||E(et)}function r(_t){switch(_t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function v(_t,et=null,Q=null){if(!_t)return null;try{if(Q&&typeof _t=="string"&&(Q.addDefaultProtocol&&_t.startsWith("www.")&&_t.match(/\./g)?.length>=2&&(_t=`http://${_t}`),Q.tryConvertEncoding))try{_t=Xt(_t)}catch{}const Et=et?new URL(_t,et):new URL(_t);if(r(Et))return Et}catch{}return null}function T(_t,et,Q,Et=!1){return Object.defineProperty(_t,et,{value:Q,enumerable:!Et,configurable:!0,writable:!1}),Q}const P=(function(){function et(Q,Et){this.constructor===et&&E("Cannot initialize BaseException."),this.message=Q,this.name=Et}return et.prototype=new Error,et.constructor=et,et})();o.BaseException=P;class D extends P{constructor(et,Q){super(et,"PasswordException"),this.code=Q}}o.PasswordException=D;class R extends P{constructor(et,Q){super(et,"UnknownErrorException"),this.details=Q}}o.UnknownErrorException=R;class a extends P{constructor(et){super(et,"InvalidPDFException")}}o.InvalidPDFException=a;class b extends P{constructor(et){super(et,"MissingPDFException")}}o.MissingPDFException=b;class A extends P{constructor(et,Q){super(et,"UnexpectedResponseException"),this.status=Q}}o.UnexpectedResponseException=A;class k extends P{constructor(et){super(et,"FormatError")}}o.FormatError=k;class F extends P{constructor(et){super(et,"AbortException")}}o.AbortException=F;function U(_t){(typeof _t!="object"||_t?.length===void 0)&&E("Invalid argument for bytesToString");const et=_t.length,Q=8192;if(et<Q)return String.fromCharCode.apply(null,_t);const Et=[];for(let oe=0;oe<et;oe+=Q){const Wt=Math.min(oe+Q,et),Qt=_t.subarray(oe,Wt);Et.push(String.fromCharCode.apply(null,Qt))}return Et.join("")}function X(_t){typeof _t!="string"&&E("Invalid argument for stringToBytes");const et=_t.length,Q=new Uint8Array(et);for(let Et=0;Et<et;++Et)Q[Et]=_t.charCodeAt(Et)&255;return Q}function it(_t){return String.fromCharCode(_t>>24&255,_t>>16&255,_t>>8&255,_t&255)}function St(_t){return Object.keys(_t).length}function rt(_t){const et=Object.create(null);for(const[Q,Et]of _t)et[Q]=Et;return et}function st(){const _t=new Uint8Array(4);return _t[0]=1,new Uint32Array(_t.buffer,0,1)[0]===1}function ut(){try{return new Function(""),!0}catch{return!1}}class ht{static get isLittleEndian(){return T(this,"isLittleEndian",st())}static get isEvalSupported(){return T(this,"isEvalSupported",ut())}static get isOffscreenCanvasSupported(){return T(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?T(this,"platform",{isWin:!1,isMac:!1}):T(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return T(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}o.FeatureTest=ht;const gt=[...Array(256).keys()].map(_t=>_t.toString(16).padStart(2,"0"));class Ct{static makeHexColor(et,Q,Et){return`#${gt[et]}${gt[Q]}${gt[Et]}`}static scaleMinMax(et,Q){let Et;et[0]?(et[0]<0&&(Et=Q[0],Q[0]=Q[1],Q[1]=Et),Q[0]*=et[0],Q[1]*=et[0],et[3]<0&&(Et=Q[2],Q[2]=Q[3],Q[3]=Et),Q[2]*=et[3],Q[3]*=et[3]):(Et=Q[0],Q[0]=Q[2],Q[2]=Et,Et=Q[1],Q[1]=Q[3],Q[3]=Et,et[1]<0&&(Et=Q[2],Q[2]=Q[3],Q[3]=Et),Q[2]*=et[1],Q[3]*=et[1],et[2]<0&&(Et=Q[0],Q[0]=Q[1],Q[1]=Et),Q[0]*=et[2],Q[1]*=et[2]),Q[0]+=et[4],Q[1]+=et[4],Q[2]+=et[5],Q[3]+=et[5]}static transform(et,Q){return[et[0]*Q[0]+et[2]*Q[1],et[1]*Q[0]+et[3]*Q[1],et[0]*Q[2]+et[2]*Q[3],et[1]*Q[2]+et[3]*Q[3],et[0]*Q[4]+et[2]*Q[5]+et[4],et[1]*Q[4]+et[3]*Q[5]+et[5]]}static applyTransform(et,Q){const Et=et[0]*Q[0]+et[1]*Q[2]+Q[4],oe=et[0]*Q[1]+et[1]*Q[3]+Q[5];return[Et,oe]}static applyInverseTransform(et,Q){const Et=Q[0]*Q[3]-Q[1]*Q[2],oe=(et[0]*Q[3]-et[1]*Q[2]+Q[2]*Q[5]-Q[4]*Q[3])/Et,Wt=(-et[0]*Q[1]+et[1]*Q[0]+Q[4]*Q[1]-Q[5]*Q[0])/Et;return[oe,Wt]}static getAxialAlignedBoundingBox(et,Q){const Et=this.applyTransform(et,Q),oe=this.applyTransform(et.slice(2,4),Q),Wt=this.applyTransform([et[0],et[3]],Q),Qt=this.applyTransform([et[2],et[1]],Q);return[Math.min(Et[0],oe[0],Wt[0],Qt[0]),Math.min(Et[1],oe[1],Wt[1],Qt[1]),Math.max(Et[0],oe[0],Wt[0],Qt[0]),Math.max(Et[1],oe[1],Wt[1],Qt[1])]}static inverseTransform(et){const Q=et[0]*et[3]-et[1]*et[2];return[et[3]/Q,-et[1]/Q,-et[2]/Q,et[0]/Q,(et[2]*et[5]-et[4]*et[3])/Q,(et[4]*et[1]-et[5]*et[0])/Q]}static singularValueDecompose2dScale(et){const Q=[et[0],et[2],et[1],et[3]],Et=et[0]*Q[0]+et[1]*Q[2],oe=et[0]*Q[1]+et[1]*Q[3],Wt=et[2]*Q[0]+et[3]*Q[2],Qt=et[2]*Q[1]+et[3]*Q[3],Ge=(Et+Qt)/2,Xe=Math.sqrt((Et+Qt)**2-4*(Et*Qt-Wt*oe))/2,ze=Ge+Xe||1,xe=Ge-Xe||1;return[Math.sqrt(ze),Math.sqrt(xe)]}static normalizeRect(et){const Q=et.slice(0);return et[0]>et[2]&&(Q[0]=et[2],Q[2]=et[0]),et[1]>et[3]&&(Q[1]=et[3],Q[3]=et[1]),Q}static intersect(et,Q){const Et=Math.max(Math.min(et[0],et[2]),Math.min(Q[0],Q[2])),oe=Math.min(Math.max(et[0],et[2]),Math.max(Q[0],Q[2]));if(Et>oe)return null;const Wt=Math.max(Math.min(et[1],et[3]),Math.min(Q[1],Q[3])),Qt=Math.min(Math.max(et[1],et[3]),Math.max(Q[1],Q[3]));return Wt>Qt?null:[Et,Wt,oe,Qt]}static bezierBoundingBox(et,Q,Et,oe,Wt,Qt,Ge,Xe){const ze=[],xe=[[],[]];let Ue,Be,rn,Se,sn,an,hn,dn;for(let fn=0;fn<2;++fn){if(fn===0?(Be=6*et-12*Et+6*Wt,Ue=-3*et+9*Et-9*Wt+3*Ge,rn=3*Et-3*et):(Be=6*Q-12*oe+6*Qt,Ue=-3*Q+9*oe-9*Qt+3*Xe,rn=3*oe-3*Q),Math.abs(Ue)<1e-12){if(Math.abs(Be)<1e-12)continue;Se=-rn/Be,0<Se&&Se<1&&ze.push(Se);continue}hn=Be*Be-4*rn*Ue,dn=Math.sqrt(hn),!(hn<0)&&(sn=(-Be+dn)/(2*Ue),0<sn&&sn<1&&ze.push(sn),an=(-Be-dn)/(2*Ue),0<an&&an<1&&ze.push(an))}let Qe=ze.length,Fe;const tn=Qe;for(;Qe--;)Se=ze[Qe],Fe=1-Se,xe[0][Qe]=Fe*Fe*Fe*et+3*Fe*Fe*Se*Et+3*Fe*Se*Se*Wt+Se*Se*Se*Ge,xe[1][Qe]=Fe*Fe*Fe*Q+3*Fe*Fe*Se*oe+3*Fe*Se*Se*Qt+Se*Se*Se*Xe;return xe[0][tn]=et,xe[1][tn]=Q,xe[0][tn+1]=Ge,xe[1][tn+1]=Xe,xe[0].length=xe[1].length=tn+2,[Math.min(...xe[0]),Math.min(...xe[1]),Math.max(...xe[0]),Math.max(...xe[1])]}}o.Util=Ct;const Lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Bt(_t){if(_t[0]>="ï"){let Q;if(_t[0]==="þ"&&_t[1]==="ÿ"?Q="utf-16be":_t[0]==="ÿ"&&_t[1]==="þ"?Q="utf-16le":_t[0]==="ï"&&_t[1]==="»"&&_t[2]==="¿"&&(Q="utf-8"),Q)try{const Et=new TextDecoder(Q,{fatal:!0}),oe=X(_t);return Et.decode(oe)}catch(Et){N(`stringToPDFString: "${Et}".`)}}const et=[];for(let Q=0,Et=_t.length;Q<Et;Q++){const oe=Lt[_t.charCodeAt(Q)];et.push(oe?String.fromCharCode(oe):_t.charAt(Q))}return et.join("")}function Xt(_t){return decodeURIComponent(escape(_t))}function $t(_t){return unescape(encodeURIComponent(_t))}function ne(_t){return typeof _t=="object"&&_t?.byteLength!==void 0}function Me(_t,et){if(_t.length!==et.length)return!1;for(let Q=0,Et=_t.length;Q<Et;Q++)if(_t[Q]!==et[Q])return!1;return!0}function Ae(_t=new Date){return[_t.getUTCFullYear().toString(),(_t.getUTCMonth()+1).toString().padStart(2,"0"),_t.getUTCDate().toString().padStart(2,"0"),_t.getUTCHours().toString().padStart(2,"0"),_t.getUTCMinutes().toString().padStart(2,"0"),_t.getUTCSeconds().toString().padStart(2,"0")].join("")}class je{#t=!1;constructor(){this.promise=new Promise((et,Q)=>{this.resolve=Et=>{this.#t=!0,et(Et)},this.reject=Et=>{this.#t=!0,Q(Et)}})}get settled(){return this.#t}}o.PromiseCapability=je;let Pe=null,Oe=null;function qe(_t){return Pe||(Pe=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Oe=new Map([["ﬅ","ſt"]])),_t.replaceAll(Pe,(et,Q,Et)=>Q?Q.normalize("NFKC"):Oe.get(Et))}function un(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const _t=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(_t);else for(let et=0;et<32;et++)_t[et]=Math.floor(Math.random()*255);return U(_t)}const Ne="pdfjs_internal_id_";o.AnnotationPrefix=Ne}),((__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(d){if(typeof d=="string"||d instanceof URL?d={url:d}:(0,_util.isArrayBuffer)(d)&&(d={data:d}),typeof d!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!d.url&&!d.data&&!d.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const o=new PDFDocumentLoadingTask,{docId:I}=o,u=d.url?getUrlProp(d.url):null,y=d.data?getDataProp(d.data):null,n=d.httpHeaders||null,x=d.withCredentials===!0,V=d.password??null,q=d.range instanceof PDFDataRangeTransport?d.range:null,s=Number.isInteger(d.rangeChunkSize)&&d.rangeChunkSize>0?d.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let t=d.worker instanceof PDFWorker?d.worker:null;const i=d.verbosity,f=typeof d.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(d.docBaseUrl)?d.docBaseUrl:null,h=typeof d.cMapUrl=="string"?d.cMapUrl:null,e=d.cMapPacked!==!1,g=d.CMapReaderFactory||DefaultCMapReaderFactory,_=typeof d.standardFontDataUrl=="string"?d.standardFontDataUrl:null,c=d.StandardFontDataFactory||DefaultStandardFontDataFactory,w=d.stopAtErrors!==!0,L=Number.isInteger(d.maxImageSize)&&d.maxImageSize>-1?d.maxImageSize:-1,M=d.isEvalSupported!==!1,m=typeof d.isOffscreenCanvasSupported=="boolean"?d.isOffscreenCanvasSupported:!_util.isNodeJS,C=Number.isInteger(d.canvasMaxAreaInBytes)?d.canvasMaxAreaInBytes:-1,z=typeof d.disableFontFace=="boolean"?d.disableFontFace:_util.isNodeJS,$=d.fontExtraProperties===!0,j=d.enableXfa===!0,tt=d.ownerDocument||globalThis.document,nt=d.disableRange===!0,bt=d.disableStream===!0,dt=d.disableAutoFetch===!0,mt=d.pdfBug===!0,At=q?q.length:d.length??NaN,ot=typeof d.useSystemFonts=="boolean"?d.useSystemFonts:!_util.isNodeJS&&!z,N=typeof d.useWorkerFetch=="boolean"?d.useWorkerFetch:g===_display_utils.DOMCMapReaderFactory&&c===_display_utils.DOMStandardFontDataFactory&&h&&_&&(0,_display_utils.isValidFetchUrl)(h,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(_,document.baseURI),E=d.canvasFactory||new DefaultCanvasFactory({ownerDocument:tt}),p=d.filterFactory||new DefaultFilterFactory({docId:I,ownerDocument:tt}),r=null;(0,_util.setVerbosityLevel)(i);const v={canvasFactory:E,filterFactory:p};if(N||(v.cMapReaderFactory=new g({baseUrl:h,isCompressed:e}),v.standardFontDataFactory=new c({baseUrl:_})),!t){const D={verbosity:i,port:_worker_options.GlobalWorkerOptions.workerPort};t=D.port?PDFWorker.fromPort(D):new PDFWorker(D),o._worker=t}const T={docId:I,apiVersion:"3.11.174",data:y,password:V,disableAutoFetch:dt,rangeChunkSize:s,length:At,docBaseUrl:f,enableXfa:j,evaluatorOptions:{maxImageSize:L,disableFontFace:z,ignoreErrors:w,isEvalSupported:M,isOffscreenCanvasSupported:m,canvasMaxAreaInBytes:C,fontExtraProperties:$,useSystemFonts:ot,cMapUrl:N?h:null,standardFontDataUrl:N?_:null}},P={ignoreErrors:w,isEvalSupported:M,disableFontFace:z,fontExtraProperties:$,enableXfa:j,ownerDocument:tt,disableAutoFetch:dt,pdfBug:mt,styleElement:r};return t.promise.then(function(){if(o.destroyed)throw new Error("Loading aborted");const D=_fetchDocument(t,T),R=new Promise(function(a){let b;q?b=new _transport_stream.PDFDataTransportStream({length:At,initialData:q.initialData,progressiveDone:q.progressiveDone,contentDispositionFilename:q.contentDispositionFilename,disableRange:nt,disableStream:bt},q):y||(b=(k=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(k):(0,_display_utils.isValidFetchUrl)(k.url)?new _displayFetch_stream.PDFFetchStream(k):new _displayNetwork.PDFNetworkStream(k))({url:u,length:At,httpHeaders:n,withCredentials:x,rangeChunkSize:s,disableRange:nt,disableStream:bt})),a(b)});return Promise.all([D,R]).then(function([a,b]){if(o.destroyed)throw new Error("Loading aborted");const A=new _message_handler.MessageHandler(I,a,t.port),k=new WorkerTransport(A,o,b,P,v);o._transport=k,A.send("Ready",null)})}).catch(o._capability.reject),o}async function _fetchDocument(d,o){if(d.destroyed)throw new Error("Worker was destroyed");const I=await d.messageHandler.sendWithPromise("GetDocRequest",o,o.data?[o.data.buffer]:null);if(d.destroyed)throw new Error("Worker was destroyed");return I}function getUrlProp(d){if(d instanceof URL)return d.href;try{return new URL(d,window.location).href}catch{if(_util.isNodeJS&&typeof d=="string")return d}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(d){if(_util.isNodeJS&&typeof Buffer<"u"&&d instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength)return d;if(typeof d=="string")return(0,_util.stringToBytes)(d);if(typeof d=="object"&&!isNaN(d?.length)||(0,_util.isArrayBuffer)(d))return new Uint8Array(d);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(o){throw this._worker?.port&&delete this._worker._pendingDestroy,o}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(o,I,u=!1,y=null){this.length=o,this.initialData=I,this.progressiveDone=u,this.contentDispositionFilename=y,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(o){this._rangeListeners.push(o)}addProgressListener(o){this._progressListeners.push(o)}addProgressiveReadListener(o){this._progressiveReadListeners.push(o)}addProgressiveDoneListener(o){this._progressiveDoneListeners.push(o)}onDataRange(o,I){for(const u of this._rangeListeners)u(o,I)}onDataProgress(o,I){this._readyCapability.promise.then(()=>{for(const u of this._progressListeners)u(o,I)})}onDataProgressiveRead(o){this._readyCapability.promise.then(()=>{for(const I of this._progressiveReadListeners)I(o)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const o of this._progressiveDoneListeners)o()})}transportReady(){this._readyCapability.resolve()}requestDataRange(o,I){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(o,I){this._pdfInfo=o,this._transport=I,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(u=>{if(!u)return u;const y=[];for(const n in u)y.push(...u[n]);return y}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(o){return this._transport.getPage(o)}getPageIndex(o){return this._transport.getPageIndex(o)}getDestinations(){return this._transport.getDestinations()}getDestination(o){return this._transport.getDestination(o)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(o=!1){return this._transport.startCleanup(o||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(o,I,u,y=!1){this._pageIndex=o,this._pageInfo=I,this._transport=u,this._stats=y?new _display_utils.StatTimer:null,this._pdfBug=y,this.commonObjs=u.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:o,rotation:I=this.rotate,offsetX:u=0,offsetY:y=0,dontFlip:n=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:I,offsetX:u,offsetY:y,dontFlip:n})}getAnnotations({intent:o="display"}={}){const I=this._transport.getRenderingIntent(o);return this._transport.getAnnotations(this._pageIndex,I.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:o,viewport:I,intent:u="display",annotationMode:y=_util.AnnotationMode.ENABLE,transform:n=null,background:x=null,optionalContentConfigPromise:V=null,annotationCanvasMap:q=null,pageColors:s=null,printAnnotationStorage:t=null}){this._stats?.time("Overall");const i=this._transport.getRenderingIntent(u,y,t);this.#e=!1,this.#i(),V||(V=this._transport.getOptionalContentConfig());let f=this._intentStates.get(i.cacheKey);f||(f=Object.create(null),this._intentStates.set(i.cacheKey,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const h=!!(i.renderingIntent&_util.RenderingIntentFlag.PRINT);f.displayReadyCapability||(f.displayReadyCapability=new _util.PromiseCapability,f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(i));const e=c=>{f.renderTasks.delete(g),(this._maybeCleanupAfterRender||h)&&(this.#e=!0),this.#n(!h),c?(g.capability.reject(c),this._abortOperatorList({intentState:f,reason:c instanceof Error?c:new Error(c)})):g.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},g=new InternalRenderTask({callback:e,params:{canvasContext:o,viewport:I,transform:n,background:x},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:q,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!h,pdfBug:this._pdfBug,pageColors:s});(f.renderTasks||=new Set).add(g);const _=g.task;return Promise.all([f.displayReadyCapability.promise,V]).then(([c,w])=>{if(this.destroyed){e();return}this._stats?.time("Rendering"),g.initializeGraphics({transparency:c,optionalContentConfig:w}),g.operatorListChanged()}).catch(e),_}getOperatorList({intent:o="display",annotationMode:I=_util.AnnotationMode.ENABLE,printAnnotationStorage:u=null}={}){function y(){x.operatorList.lastChunk&&(x.opListReadCapability.resolve(x.operatorList),x.renderTasks.delete(V))}const n=this._transport.getRenderingIntent(o,I,u,!0);let x=this._intentStates.get(n.cacheKey);x||(x=Object.create(null),this._intentStates.set(n.cacheKey,x));let V;return x.opListReadCapability||(V=Object.create(null),V.operatorListChanged=y,x.opListReadCapability=new _util.PromiseCapability,(x.renderTasks||=new Set).add(V),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(n)),x.opListReadCapability.promise}streamTextContent({includeMarkedContent:o=!1,disableNormalization:I=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:o===!0,disableNormalization:I===!0},{highWaterMark:100,size(y){return y.items.length}})}getTextContent(o={}){if(this._transport._htmlForXfa)return this.getXfa().then(u=>_xfa_text.XfaText.textContent(u));const I=this.streamTextContent(o);return new Promise(function(u,y){function n(){x.read().then(function({value:q,done:s}){if(s){u(V);return}Object.assign(V.styles,q.styles),V.items.push(...q.items),n()},y)}const x=I.getReader(),V={items:[],styles:Object.create(null)};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const o=[];for(const I of this._intentStates.values())if(this._abortOperatorList({intentState:I,reason:new Error("Page was destroyed."),force:!0}),!I.opListReadCapability)for(const u of I.renderTasks)o.push(u.completed),u.cancel();return this.objs.clear(),this.#e=!1,this.#i(),Promise.all(o)}cleanup(o=!1){this.#e=!0;const I=this.#n(!1);return o&&I&&(this._stats&&=new _display_utils.StatTimer),I}#n(o=!1){if(this.#i(),!this.#e||this.destroyed)return!1;if(o)return this.#t=setTimeout(()=>{this.#t=null,this.#n(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:I,operatorList:u}of this._intentStates.values())if(I.size>0||!u.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#i(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(o,I){const u=this._intentStates.get(I);u&&(this._stats?.timeEnd("Page Request"),u.displayReadyCapability?.resolve(o))}_renderPageChunk(o,I){for(let u=0,y=o.length;u<y;u++)I.operatorList.fnArray.push(o.fnArray[u]),I.operatorList.argsArray.push(o.argsArray[u]);I.operatorList.lastChunk=o.lastChunk,I.operatorList.separateAnnots=o.separateAnnots;for(const u of I.renderTasks)u.operatorListChanged();o.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:o,cacheKey:I,annotationStorageSerializable:u}){const{map:y,transfers:n}=u,V=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:o,cacheKey:I,annotationStorage:y},n).getReader(),q=this._intentStates.get(I);q.streamReader=V;const s=()=>{V.read().then(({value:t,done:i})=>{if(i){q.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(t,q),s())},t=>{if(q.streamReader=null,!this._transport.destroyed){if(q.operatorList){q.operatorList.lastChunk=!0;for(const i of q.renderTasks)i.operatorListChanged();this.#n(!0)}if(q.displayReadyCapability)q.displayReadyCapability.reject(t);else if(q.opListReadCapability)q.opListReadCapability.reject(t);else throw t}})};s()}_abortOperatorList({intentState:o,reason:I,force:u=!1}){if(o.streamReader){if(o.streamReaderCancelTimeout&&(clearTimeout(o.streamReaderCancelTimeout),o.streamReaderCancelTimeout=null),!u){if(o.renderTasks.size>0)return;if(I instanceof _display_utils.RenderingCancelledException){let y=RENDERING_CANCELLED_TIMEOUT;I.extraDelay>0&&I.extraDelay<1e3&&(y+=I.extraDelay),o.streamReaderCancelTimeout=setTimeout(()=>{o.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:o,reason:I,force:!0})},y);return}}if(o.streamReader.cancel(new _util.AbortException(I.message)).catch(()=>{}),o.streamReader=null,!this._transport.destroyed){for(const[y,n]of this._intentStates)if(n===o){this._intentStates.delete(y);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(o,I){const u={data:structuredClone(o,I?{transfer:I}:null)};this.#e.then(()=>{for(const y of this.#t)y.call(this,u)})}addEventListener(o,I){this.#t.add(I)}removeEventListener(o,I){this.#t.delete(I)}terminate(){this.#t.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const d=document?.currentScript?.src;d&&(PDFWorkerUtil.fallbackWorkerSrc=d.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(d,o){let I;try{if(I=new URL(d),!I.origin||I.origin==="null")return!1}catch{return!1}const u=new URL(o,I);return I.origin===u.origin},PDFWorkerUtil.createCDNWrapper=function(d){const o=`importScripts("${d}");`;return URL.createObjectURL(new Blob([o]))}}class PDFWorker{static#workerPorts;constructor({name:d=null,port:o=null,verbosity:I=(0,_util.getVerbosityLevel)()}={}){if(this.name=d,this.destroyed=!1,this.verbosity=I,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,o){if(PDFWorker.#workerPorts?.has(o))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(o,this),this._initializeFromPort(o);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(d){this._port=d,this._messageHandler=new _message_handler.MessageHandler("main","worker",d),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:d}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,d)||(d=PDFWorkerUtil.createCDNWrapper(new URL(d,window.location).href));const o=new Worker(d),I=new _message_handler.MessageHandler("main","worker",o),u=()=>{o.removeEventListener("error",y),I.destroy(),o.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},y=()=>{this._webWorker||u()};o.addEventListener("error",y),I.on("test",x=>{if(o.removeEventListener("error",y),this.destroyed){u();return}x?(this._messageHandler=I,this._port=o,this._webWorker=o,this._readyCapability.resolve(),I.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),I.destroy(),o.terminate())}),I.on("ready",x=>{if(o.removeEventListener("error",y),this.destroyed){u();return}try{n()}catch{this._setupFakeWorker()}});const n=()=>{const x=new Uint8Array;I.send("test",x,[x.buffer])};n();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(d=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const o=new LoopbackPort;this._port=o;const I=`fake${PDFWorkerUtil.fakeWorkerId++}`,u=new _message_handler.MessageHandler(I+"_worker",I,o);d.setup(u,o);const y=new _message_handler.MessageHandler(I,I+"_worker",o);this._messageHandler=y,this._readyCapability.resolve(),y.send("configure",{verbosity:this.verbosity})}).catch(d=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${d.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(d){if(!d?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const o=this.#workerPorts?.get(d.port);if(o){if(o._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return o}return new PDFWorker(d)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#n=new Map;#i=null;constructor(o,I,u,y,n){this.messageHandler=o,this.loadingTask=I,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:y.ownerDocument,styleElement:y.styleElement}),this._params=y,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=u,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(o,I=null){const u=this.#t.get(o);if(u)return u;const y=this.messageHandler.sendWithPromise(o,I);return this.#t.set(o,y),y}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(o,I=_util.AnnotationMode.ENABLE,u=null,y=!1){let n=_util.RenderingIntentFlag.DISPLAY,x=_annotation_storage.SerializableEmpty;switch(o){case"any":n=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":n=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${o}`)}switch(I){case _util.AnnotationMode.DISABLE:n+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:n+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:n+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,x=(n&_util.RenderingIntentFlag.PRINT&&u instanceof _annotation_storage.PrintAnnotationStorage?u:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${I}`)}return y&&(n+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:n,cacheKey:`${n}_${x.hash}`,annotationStorageSerializable:x}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const o=[];for(const u of this.#e.values())o.push(u._destroy());this.#e.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const I=this.messageHandler.sendWithPromise("Terminate",null);return o.push(I),Promise.all(o).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:o,loadingTask:I}=this;o.on("GetReader",(u,y)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},y.onPull=()=>{this._fullReader.read().then(function({value:n,done:x}){if(x){y.close();return}(0,_util.assert)(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),y.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{y.error(n)})},y.onCancel=n=>{this._fullReader.cancel(n),y.ready.catch(x=>{if(!this.destroyed)throw x})}}),o.on("ReaderHeadersReady",u=>{const y=new _util.PromiseCapability,n=this._fullReader;return n.headersReady.then(()=>{(!n.isStreamingSupported||!n.isRangeSupported)&&(this._lastProgress&&I.onProgress?.(this._lastProgress),n.onProgress=x=>{I.onProgress?.({loaded:x.loaded,total:x.total})}),y.resolve({isStreamingSupported:n.isStreamingSupported,isRangeSupported:n.isRangeSupported,contentLength:n.contentLength})},y.reject),y.promise}),o.on("GetRangeReader",(u,y)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(u.begin,u.end);if(!n){y.close();return}y.onPull=()=>{n.read().then(function({value:x,done:V}){if(V){y.close();return}(0,_util.assert)(x instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),y.enqueue(new Uint8Array(x),1,[x])}).catch(x=>{y.error(x)})},y.onCancel=x=>{n.cancel(x),y.ready.catch(V=>{if(!this.destroyed)throw V})}}),o.on("GetDoc",({pdfInfo:u})=>{this._numPages=u.numPages,this._htmlForXfa=u.htmlForXfa,delete u.htmlForXfa,I._capability.resolve(new PDFDocumentProxy(u,this))}),o.on("DocException",function(u){let y;switch(u.name){case"PasswordException":y=new _util.PasswordException(u.message,u.code);break;case"InvalidPDFException":y=new _util.InvalidPDFException(u.message);break;case"MissingPDFException":y=new _util.MissingPDFException(u.message);break;case"UnexpectedResponseException":y=new _util.UnexpectedResponseException(u.message,u.status);break;case"UnknownErrorException":y=new _util.UnknownErrorException(u.message,u.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}I._capability.reject(y)}),o.on("PasswordRequest",u=>{if(this.#i=new _util.PromiseCapability,I.onPassword){const y=n=>{n instanceof Error?this.#i.reject(n):this.#i.resolve({password:n})};try{I.onPassword(y,u.code)}catch(n){this.#i.reject(n)}}else this.#i.reject(new _util.PasswordException(u.message,u.code));return this.#i.promise}),o.on("DataLoaded",u=>{I.onProgress?.({loaded:u.length,total:u.length}),this.downloadInfoCapability.resolve(u)}),o.on("StartRenderPage",u=>{if(this.destroyed)return;this.#e.get(u.pageIndex)._startRenderPage(u.transparency,u.cacheKey)}),o.on("commonobj",([u,y,n])=>{if(!this.destroyed&&!this.commonObjs.has(u))switch(y){case"Font":const x=this._params;if("error"in n){const s=n.error;(0,_util.warn)(`Error during font loading: ${s}`),this.commonObjs.resolve(u,s);break}const V=x.pdfBug&&globalThis.FontInspector?.enabled?(s,t)=>globalThis.FontInspector.fontAdded(s,t):null,q=new _font_loader.FontFaceObject(n,{isEvalSupported:x.isEvalSupported,disableFontFace:x.disableFontFace,ignoreErrors:x.ignoreErrors,inspectFont:V});this.fontLoader.bind(q).catch(s=>o.sendWithPromise("FontFallback",{id:u})).finally(()=>{!x.fontExtraProperties&&q.data&&(q.data=null),this.commonObjs.resolve(u,q)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(u,n);break;default:throw new Error(`Got unknown common object type ${y}`)}}),o.on("obj",([u,y,n,x])=>{if(this.destroyed)return;const V=this.#e.get(y);if(!V.objs.has(u))switch(n){case"Image":if(V.objs.resolve(u,x),x){let q;if(x.bitmap){const{width:s,height:t}=x;q=s*t*4}else q=x.data?.length||0;q>_util.MAX_IMAGE_SIZE_TO_CACHE&&(V._maybeCleanupAfterRender=!0)}break;case"Pattern":V.objs.resolve(u,x);break;default:throw new Error(`Got unknown object type ${n}`)}}),o.on("DocProgress",u=>{this.destroyed||I.onProgress?.({loaded:u.loaded,total:u.total})}),o.on("FetchBuiltInCMap",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(u):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),o.on("FetchStandardFontData",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(u):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:o,transfers:I}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:o,filename:this._fullReader?.filename??null},I).finally(()=>{this.annotationStorage.resetModified()})}getPage(o){if(!Number.isInteger(o)||o<=0||o>this._numPages)return Promise.reject(new Error("Invalid page request."));const I=o-1,u=this.#n.get(I);if(u)return u;const y=this.messageHandler.sendWithPromise("GetPage",{pageIndex:I}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");const x=new PDFPageProxy(I,n,this,this._params.pdfBug);return this.#e.set(I,x),x});return this.#n.set(I,y),y}getPageIndex(o){return typeof o!="object"||o===null||!Number.isInteger(o.num)||o.num<0||!Number.isInteger(o.gen)||o.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:o.num,gen:o.gen})}getAnnotations(o,I){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o,intent:I})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(o){return typeof o!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:o})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(o){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o})}getStructTree(o){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(o=>new _optional_content_config.OptionalContentConfig(o))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const o="GetMetadata",I=this.#t.get(o);if(I)return I;const u=this.messageHandler.sendWithPromise(o,null).then(y=>({info:y[0],metadata:y[1]?new _metadata.Metadata(y[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(o,u),u}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(o=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const I of this.#e.values())if(!I.cleanup())throw new Error(`startCleanup: Page ${I.pageNumber} is currently rendering.`);this.commonObjs.clear(),o||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:o,enableXfa:I}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o,enableXfa:I})}}class PDFObjects{#t=Object.create(null);#e(o){return this.#t[o]||={capability:new _util.PromiseCapability,data:null}}get(o,I=null){if(I){const y=this.#e(o);return y.capability.promise.then(()=>I(y.data)),null}const u=this.#t[o];if(!u?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${o}.`);return u.data}has(o){return this.#t[o]?.capability.settled||!1}resolve(o,I=null){const u=this.#e(o);u.data=I,u.capability.resolve()}clear(){for(const o in this.#t){const{data:I}=this.#t[o];I?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(o){this.#t=o,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(o=0){this.#t.cancel(null,o)}get separateAnnots(){const{separateAnnots:o}=this.#t.operatorList;if(!o)return!1;const{annotationCanvasMap:I}=this.#t;return o.form||o.canvas&&I?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:o,params:I,objs:u,commonObjs:y,annotationCanvasMap:n,operatorList:x,pageIndex:V,canvasFactory:q,filterFactory:s,useRequestAnimationFrame:t=!1,pdfBug:i=!1,pageColors:f=null}){this.callback=o,this.params=I,this.objs=u,this.commonObjs=y,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=x,this._pageIndex=V,this.canvasFactory=q,this.filterFactory=s,this._pdfBug=i,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=t===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=I.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:o=!1,optionalContentConfig:I}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:u,viewport:y,transform:n,background:x}=this.params;this.gfx=new _canvas.CanvasGraphics(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:I},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:y,transparency:o,background:x}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(o=null,I=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,I))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SerializableEmpty=o.PrintAnnotationStorage=o.AnnotationStorage=void 0;var u=I(1),y=I(4),n=I(8);const x=Object.freeze({map:null,hash:"",transfers:void 0});o.SerializableEmpty=x;class V{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const f=this.#e.get(t);return f===void 0?i:Object.assign(i,f)}getRawValue(t){return this.#e.get(t)}remove(t){if(this.#e.delete(t),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const i of this.#e.values())if(i instanceof y.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(t,i){const f=this.#e.get(t);let h=!1;if(f!==void 0)for(const[e,g]of Object.entries(i))f[e]!==g&&(h=!0,f[e]=g);else h=!0,this.#e.set(t,i);h&&this.#n(),i instanceof y.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type)}has(t){return this.#e.has(t)}getAll(){return this.#e.size>0?(0,u.objectFromMap)(this.#e):null}setAll(t){for(const[i,f]of Object.entries(t))this.setValue(i,f)}get size(){return this.#e.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new q(this)}get serializable(){if(this.#e.size===0)return x;const t=new Map,i=new n.MurmurHash3_64,f=[],h=Object.create(null);let e=!1;for(const[g,_]of this.#e){const c=_ instanceof y.AnnotationEditor?_.serialize(!1,h):_;c&&(t.set(g,c),i.update(`${g}:${JSON.stringify(c)}`),e||=!!c.bitmap)}if(e)for(const g of t.values())g.bitmap&&f.push(g.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfers:f}:x}}o.AnnotationStorage=V;class q extends V{#t;constructor(t){super();const{map:i,hash:f,transfers:h}=t.serializable,e=structuredClone(i,h?{transfer:h}:null);this.#t={map:e,hash:f,transfers:h}}get print(){(0,u.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}o.PrintAnnotationStorage=q}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationEditor=void 0;var u=I(5),y=I(1),n=I(6);class x{#t="";#e=!1;#n=null;#i=null;#o=null;#a=!1;#s=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#r=!1;#f=!1;#h=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#d=!1;#p=x._zIndex++;static _borderLineWidth=-1;static _colorManager=new u.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(s){this.constructor===x&&(0,y.unreachable)("Cannot initialize AnnotationEditor."),this.parent=s.parent,this.id=s.id,this.width=this.height=null,this.pageIndex=s.parent.pageIndex,this.name=s.name,this.div=null,this._uiManager=s.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=s.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:f,pageX:h,pageY:e}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,f],this.pageTranslation=[h,e];const[g,_]=this.parentDimensions;this.x=s.x/g,this.y=s.y/_,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,y.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(s){const t=new V({id:s.parent.getNextId(),parent:s.parent,uiManager:s._uiManager});t.annotationElementId=s.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(s,t=null){if(x._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(f=>[f,s.get(f)])),t?.strings)for(const f of t.strings)x._l10nPromise.set(f,s.get(f));if(x._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);x._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(s,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(s){return!1}static paste(s,t){(0,y.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#d}set _isDraggable(s){this.#d=s,this.div?.classList.toggle("draggable",s)}center(){const[s,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(s*2),this.y+=this.width*s/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(s*2),this.y-=this.width*s/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(s){this._uiManager.addCommands(s)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(s){s!==null&&(this.pageIndex=s.pageIndex,this.pageDimensions=s.pageDimensions),this.parent=s}focusin(s){this._focusEventsAllowed&&(this.#r?this.#r=!1:this.parent.setSelected(this))}focusout(s){!this._focusEventsAllowed||!this.isAttachedToDOM||s.relatedTarget?.closest(`#${this.id}`)||(s.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(s,t,i,f){const[h,e]=this.parentDimensions;[i,f]=this.screenToPageTranslation(i,f),this.x=(s+i)/h,this.y=(t+f)/e,this.fixAndSetPosition()}#v([s,t],i,f){[i,f]=this.screenToPageTranslation(i,f),this.x+=i/s,this.y+=f/t,this.fixAndSetPosition()}translate(s,t){this.#v(this.parentDimensions,s,t)}translateInPage(s,t){this.#v(this.pageDimensions,s,t),this.div.scrollIntoView({block:"nearest"})}drag(s,t){const[i,f]=this.parentDimensions;if(this.x+=s/i,this.y+=t/f,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:w}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,w)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:h,y:e}=this;const[g,_]=this.#m();h+=g,e+=_,this.div.style.left=`${(100*h).toFixed(2)}%`,this.div.style.top=`${(100*e).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){const[s,t]=this.parentDimensions,{_borderLineWidth:i}=x,f=i/s,h=i/t;switch(this.rotation){case 90:return[-f,h];case 180:return[f,h];case 270:return[f,-h];default:return[-f,-h]}}fixAndSetPosition(){const[s,t]=this.pageDimensions;let{x:i,y:f,width:h,height:e}=this;switch(h*=s,e*=t,i*=s,f*=t,this.rotation){case 0:i=Math.max(0,Math.min(s-h,i)),f=Math.max(0,Math.min(t-e,f));break;case 90:i=Math.max(0,Math.min(s-e,i)),f=Math.min(t,Math.max(h,f));break;case 180:i=Math.min(s,Math.max(h,i)),f=Math.min(t,Math.max(e,f));break;case 270:i=Math.min(s,Math.max(e,i)),f=Math.max(0,Math.min(t-h,f));break}this.x=i/=s,this.y=f/=t;const[g,_]=this.#m();i+=g,f+=_;const{style:c}=this.div;c.left=`${(100*i).toFixed(2)}%`,c.top=`${(100*f).toFixed(2)}%`,this.moveInDOM()}static#g(s,t,i){switch(i){case 90:return[t,-s];case 180:return[-s,-t];case 270:return[-t,s];default:return[s,t]}}screenToPageTranslation(s,t){return x.#g(s,t,this.parentRotation)}pageTranslationToScreen(s,t){return x.#g(s,t,360-this.parentRotation)}#u(s){switch(s){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:s,pageDimensions:[t,i]}=this,f=t*s,h=i*s;return y.FeatureTest.isCSSRoundSupported?[Math.round(f),Math.round(h)]:[f,h]}setDims(s,t){const[i,f]=this.parentDimensions;this.div.style.width=`${(100*s/i).toFixed(2)}%`,this.#a||(this.div.style.height=`${(100*t/f).toFixed(2)}%`),this.#n?.classList.toggle("small",s<x.SMALL_EDITOR_SIZE||t<x.SMALL_EDITOR_SIZE)}fixDims(){const{style:s}=this.div,{height:t,width:i}=s,f=i.endsWith("%"),h=!this.#a&&t.endsWith("%");if(f&&h)return;const[e,g]=this.parentDimensions;f||(s.width=`${(100*parseFloat(i)/e).toFixed(2)}%`),!this.#a&&!h&&(s.height=`${(100*parseFloat(t)/g).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#_(){if(this.#s)return;this.#s=document.createElement("div"),this.#s.classList.add("resizers");const s=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||s.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of s){const i=document.createElement("div");this.#s.append(i),i.classList.add("resizer",t),i.addEventListener("pointerdown",this.#E.bind(this,t)),i.addEventListener("contextmenu",n.noContextMenu)}this.div.prepend(this.#s)}#E(s,t){t.preventDefault();const{isMac:i}=y.FeatureTest.platform;if(t.button!==0||t.ctrlKey&&i)return;const f=this.#S.bind(this,s),h=this._isDraggable;this._isDraggable=!1;const e={passive:!0,capture:!0};window.addEventListener("pointermove",f,e);const g=this.x,_=this.y,c=this.width,w=this.height,L=this.parent.div.style.cursor,M=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const m=()=>{this._isDraggable=h,window.removeEventListener("pointerup",m),window.removeEventListener("blur",m),window.removeEventListener("pointermove",f,e),this.parent.div.style.cursor=L,this.div.style.cursor=M;const C=this.x,z=this.y,$=this.width,j=this.height;C===g&&z===_&&$===c&&j===w||this.addCommands({cmd:()=>{this.width=$,this.height=j,this.x=C,this.y=z;const[tt,nt]=this.parentDimensions;this.setDims(tt*$,nt*j),this.fixAndSetPosition()},undo:()=>{this.width=c,this.height=w,this.x=g,this.y=_;const[tt,nt]=this.parentDimensions;this.setDims(tt*c,nt*w),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",m),window.addEventListener("blur",m)}#S(s,t){const[i,f]=this.parentDimensions,h=this.x,e=this.y,g=this.width,_=this.height,c=x.MIN_SIZE/i,w=x.MIN_SIZE/f,L=R=>Math.round(R*1e4)/1e4,M=this.#u(this.rotation),m=(R,a)=>[M[0]*R+M[2]*a,M[1]*R+M[3]*a],C=this.#u(360-this.rotation),z=(R,a)=>[C[0]*R+C[2]*a,C[1]*R+C[3]*a];let $,j,tt=!1,nt=!1;switch(s){case"topLeft":tt=!0,$=(R,a)=>[0,0],j=(R,a)=>[R,a];break;case"topMiddle":$=(R,a)=>[R/2,0],j=(R,a)=>[R/2,a];break;case"topRight":tt=!0,$=(R,a)=>[R,0],j=(R,a)=>[0,a];break;case"middleRight":nt=!0,$=(R,a)=>[R,a/2],j=(R,a)=>[0,a/2];break;case"bottomRight":tt=!0,$=(R,a)=>[R,a],j=(R,a)=>[0,0];break;case"bottomMiddle":$=(R,a)=>[R/2,a],j=(R,a)=>[R/2,0];break;case"bottomLeft":tt=!0,$=(R,a)=>[0,a],j=(R,a)=>[R,0];break;case"middleLeft":nt=!0,$=(R,a)=>[0,a/2],j=(R,a)=>[R,a/2];break}const bt=$(g,_),dt=j(g,_);let mt=m(...dt);const At=L(h+mt[0]),ot=L(e+mt[1]);let N=1,E=1,[p,r]=this.screenToPageTranslation(t.movementX,t.movementY);if([p,r]=z(p/i,r/f),tt){const R=Math.hypot(g,_);N=E=Math.max(Math.min(Math.hypot(dt[0]-bt[0]-p,dt[1]-bt[1]-r)/R,1/g,1/_),c/g,w/_)}else nt?N=Math.max(c,Math.min(1,Math.abs(dt[0]-bt[0]-p)))/g:E=Math.max(w,Math.min(1,Math.abs(dt[1]-bt[1]-r)))/_;const v=L(g*N),T=L(_*E);mt=m(...j(v,T));const P=At-mt[0],D=ot-mt[1];this.width=v,this.height=T,this.x=P,this.y=D,this.setDims(i*v,f*T),this.fixAndSetPosition()}async addAltTextButton(){if(this.#n)return;const s=this.#n=document.createElement("button");s.className="altText";const t=await x._l10nPromise.get("editor_alt_text_button_label");s.textContent=t,s.setAttribute("aria-label",t),s.tabIndex="0",s.addEventListener("contextmenu",n.noContextMenu),s.addEventListener("pointerdown",i=>i.stopPropagation()),s.addEventListener("click",i=>{i.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),s.addEventListener("keydown",i=>{i.target===s&&i.key==="Enter"&&(i.preventDefault(),this._uiManager.editAltText(this))}),this.#P(),this.div.append(s),x.SMALL_EDITOR_SIZE||(x.SMALL_EDITOR_SIZE=Math.min(128,Math.round(s.getBoundingClientRect().width*1.4)))}async#P(){const s=this.#n;if(!s)return;if(!this.#t&&!this.#e){s.classList.remove("done"),this.#i?.remove();return}x._l10nPromise.get("editor_alt_text_edit_button_label").then(i=>{s.setAttribute("aria-label",i)});let t=this.#i;if(!t){this.#i=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip");const i=t.id=`alt-text-tooltip-${this.id}`;s.setAttribute("aria-describedby",i);const f=100;s.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#i.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},f)}),s.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#i?.classList.remove("show")})}s.classList.add("done"),t.innerText=this.#e?await x._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#t,t.parentNode||s.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#t,decorative:this.#e}}set altTextData({altText:s,decorative:t}){this.#t===s&&this.#e===t||(this.#t=s,this.#e=t,this.#P())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);const[s,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/s).toFixed(2)}%`,this.div.style.maxHeight=`${(100*s/t).toFixed(2)}%`);const[i,f]=this.getInitialTranslation();return this.translate(i,f),(0,u.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(s){const{isMac:t}=y.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&t){s.preventDefault();return}this.#r=!0,this.#R(s)}#R(s){if(!this._isDraggable)return;const t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let i,f;t&&(i={passive:!0,capture:!0},f=e=>{const[g,_]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(g,_)},window.addEventListener("pointermove",f,i));const h=()=>{if(window.removeEventListener("pointerup",h),window.removeEventListener("blur",h),t&&window.removeEventListener("pointermove",f,i),this.#r=!1,!this._uiManager.endDragSession()){const{isMac:e}=y.FeatureTest.platform;s.ctrlKey&&!e||s.shiftKey||s.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",h),window.addEventListener("blur",h)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(s,t,i){s.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition()}getRect(s,t){const i=this.parentScale,[f,h]=this.pageDimensions,[e,g]=this.pageTranslation,_=s/i,c=t/i,w=this.x*f,L=this.y*h,M=this.width*f,m=this.height*h;switch(this.rotation){case 0:return[w+_+e,h-L-c-m+g,w+_+M+e,h-L-c+g];case 90:return[w+c+e,h-L+_+g,w+c+m+e,h-L+_+M+g];case 180:return[w-_-M+e,h-L+c+g,w-_+e,h-L+c+m+g];case 270:return[w-c-m+e,h-L-_-M+g,w-c+e,h-L-_+g];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(s,t){const[i,f,h,e]=s,g=h-i,_=e-f;switch(this.rotation){case 0:return[i,t-e,g,_];case 90:return[i,t-f,_,g];case 180:return[h,t-f,g,_];case 270:return[h,t-e,_,g];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#h=!0}disableEditMode(){this.#h=!1}isInEditMode(){return this.#h}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(s=!1,t=null){(0,y.unreachable)("An editor must be serializable")}static deserialize(s,t,i){const f=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});f.rotation=s.rotation;const[h,e]=f.pageDimensions,[g,_,c,w]=f.getRectInCurrentCoords(s.rect,e);return f.x=g/h,f.y=_/e,f.width=c/h,f.height=w/e,f}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#n?.remove(),this.#n=null,this.#i=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#_(),this.#s.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#s?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(s,t){}disableEditing(){this.#n&&(this.#n.hidden=!0)}enableEditing(){this.#n&&(this.#n.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#f}set isEditing(s){this.#f=s,this.parent&&(s?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(s,t){this.#a=!0;const i=s/t,{style:f}=this.div;f.aspectRatio=i,f.height="auto"}static get MIN_SIZE(){return 16}}o.AnnotationEditor=x;class V extends x{constructor(s){super(s),this.annotationElementId=s.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.KeyboardManager=o.CommandManager=o.ColorManager=o.AnnotationEditorUIManager=void 0,o.bindEvents=n,o.opacityToHex=x;var u=I(1),y=I(6);function n(h,e,g){for(const _ of g)e.addEventListener(_,h[_].bind(h))}function x(h){return Math.round(Math.min(255,Math.max(1,255*h))).toString(16).padStart(2,"0")}class V{#t=0;getId(){return`${u.AnnotationEditorPrefix}${this.#t++}`}}class q{#t=(0,u.getUuid)();#e=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',_=new OffscreenCanvas(1,3).getContext("2d"),c=new Image;c.src=e;const w=c.decode().then(()=>(_.drawImage(c,0,0,1,1,0,0,1,3),new Uint32Array(_.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,u.shadow)(this,"_isSVGFittingCanvas",w)}async#i(e,g){this.#n||=new Map;let _=this.#n.get(e);if(_===null)return null;if(_?.bitmap)return _.refCounter+=1,_;try{_||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let c;if(typeof g=="string"){_.url=g;const w=await fetch(g);if(!w.ok)throw new Error(w.statusText);c=await w.blob()}else c=_.file=g;if(c.type==="image/svg+xml"){const w=q._isSVGFittingCanvas,L=new FileReader,M=new Image,m=new Promise((C,z)=>{M.onload=()=>{_.bitmap=M,_.isSvg=!0,C()},L.onload=async()=>{const $=_.svgUrl=L.result;M.src=await w?`${$}#svgView(preserveAspectRatio(none))`:$},M.onerror=L.onerror=z});L.readAsDataURL(c),await m}else _.bitmap=await createImageBitmap(c);_.refCounter=1}catch(c){console.error(c),_=null}return this.#n.set(e,_),_&&this.#n.set(_.id,_),_}async getFromFile(e){const{lastModified:g,name:_,size:c,type:w}=e;return this.#i(`${g}_${_}_${c}_${w}`,e)}async getFromUrl(e){return this.#i(e,e)}async getFromId(e){this.#n||=new Map;const g=this.#n.get(e);return g?g.bitmap?(g.refCounter+=1,g):g.file?this.getFromFile(g.file):this.getFromUrl(g.url):null}getSvgUrl(e){const g=this.#n.get(e);return g?.isSvg?g.svgUrl:null}deleteId(e){this.#n||=new Map;const g=this.#n.get(e);g&&(g.refCounter-=1,g.refCounter===0&&(g.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#t}_`)}}class s{#t=[];#e=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:g,mustExec:_,type:c=NaN,overwriteIfSameType:w=!1,keepUndo:L=!1}){if(_&&e(),this.#e)return;const M={cmd:e,undo:g,type:c};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(M);return}if(w&&this.#t[this.#i].type===c){L&&(M.undo=this.#t[this.#i].undo),this.#t[this.#i]=M;return}const m=this.#i+1;m===this.#n?this.#t.splice(0,1):(this.#i=m,m<this.#t.length&&this.#t.splice(m)),this.#t.push(M)}undo(){this.#i!==-1&&(this.#e=!0,this.#t[this.#i].undo(),this.#e=!1,this.#i-=1)}redo(){this.#i<this.#t.length-1&&(this.#i+=1,this.#e=!0,this.#t[this.#i].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}destroy(){this.#t=null}}o.CommandManager=s;class t{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:g}=u.FeatureTest.platform;for(const[_,c,w={}]of e)for(const L of _){const M=L.startsWith("mac+");g&&M?(this.callbacks.set(L.slice(4),{callback:c,options:w}),this.allKeys.add(L.split("+").at(-1))):!g&&!M&&(this.callbacks.set(L,{callback:c,options:w}),this.allKeys.add(L.split("+").at(-1)))}}#t(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const g=this.buffer.join("+");return this.buffer.length=0,g}exec(e,g){if(!this.allKeys.has(g.key))return;const _=this.callbacks.get(this.#t(g));if(!_)return;const{callback:c,options:{bubbles:w=!1,args:L=[],checker:M=null}}=_;M&&!M(e,g)||(c.bind(e,...L)(),w||(g.stopPropagation(),g.preventDefault()))}}o.KeyboardManager=t;class i{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,y.getColorValues)(e),(0,u.shadow)(this,"_colors",e)}convert(e){const g=(0,y.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return g;for(const[_,c]of this._colors)if(c.every((w,L)=>w===g[L]))return i._colorsMapping.get(_);return g}getHexCode(e){const g=this._colors.get(e);return g?u.Util.makeHexColor(...g):e}}o.ColorManager=i;class f{#t=null;#e=new Map;#n=new Map;#i=null;#o=null;#a=new s;#s=0;#l=new Set;#c=null;#r=null;#f=new Set;#h=null;#d=new V;#p=!1;#v=!1;#m=null;#g=u.AnnotationEditorType.NONE;#u=new Set;#_=null;#E=this.blur.bind(this);#S=this.focus.bind(this);#P=this.copy.bind(this);#R=this.cut.bind(this);#D=this.paste.bind(this);#I=this.keydown.bind(this);#O=this.onEditingAction.bind(this);#b=this.onPageChanging.bind(this);#L=this.onScaleChanging.bind(this);#k=this.onRotationChanging.bind(this);#M={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#y=[0,0];#T=null;#w=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=f.prototype,g=w=>{const{activeElement:L}=document;return L&&w.#w.contains(L)&&w.hasSomethingToControl()},_=this.TRANSLATE_SMALL,c=this.TRANSLATE_BIG;return(0,u.shadow)(this,"_keyboardManager",new t([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-_,0],checker:g}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-c,0],checker:g}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[_,0],checker:g}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[c,0],checker:g}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-_],checker:g}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-c],checker:g}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,_],checker:g}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,c],checker:g}]]))}constructor(e,g,_,c,w,L){this.#w=e,this.#N=g,this.#i=_,this._eventBus=c,this._eventBus._on("editingaction",this.#O),this._eventBus._on("pagechanging",this.#b),this._eventBus._on("scalechanging",this.#L),this._eventBus._on("rotationchanging",this.#k),this.#o=w.annotationStorage,this.#h=w.filterFactory,this.#_=L,this.viewParameters={realScale:y.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#x(),this.#H(),this._eventBus._off("editingaction",this.#O),this._eventBus._off("pagechanging",this.#b),this._eventBus._off("scalechanging",this.#L),this._eventBus._off("rotationchanging",this.#k);for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#e.clear(),this.#f.clear(),this.#t=null,this.#u.clear(),this.#a.destroy(),this.#i.destroy()}get hcmFilter(){return(0,u.shadow)(this,"hcmFilter",this.#_?this.#h.addHCMFilter(this.#_.foreground,this.#_.background):"none")}get direction(){return(0,u.shadow)(this,"direction",getComputedStyle(this.#w).direction)}editAltText(e){this.#i?.editAltText(this,e)}onPageChanging({pageNumber:e}){this.#s=e-1}focusMainContainer(){this.#w.focus()}findParent(e,g){for(const _ of this.#n.values()){const{x:c,y:w,width:L,height:M}=_.div.getBoundingClientRect();if(e>=c&&e<=c+L&&g>=w&&g<=w+M)return _}return null}disableUserSelect(e=!1){this.#N.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#f.add(e)}removeShouldRescale(e){this.#f.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*y.PixelsPerInch.PDF_TO_CSS_UNITS;for(const g of this.#f)g.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&this.#o&&!this.#o.has(e.id)&&this.#o.setValue(e.id,e)}#B(){window.addEventListener("focus",this.#S),window.addEventListener("blur",this.#E)}#H(){window.removeEventListener("focus",this.#S),window.removeEventListener("blur",this.#E)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const g of this.#u)if(g.div.contains(e)){this.#m=[g,e],g._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;const[e,g]=this.#m;this.#m=null,g.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),g.focus()}#j(){window.addEventListener("keydown",this.#I,{capture:!0})}#x(){window.removeEventListener("keydown",this.#I,{capture:!0})}#F(){document.addEventListener("copy",this.#P),document.addEventListener("cut",this.#R),document.addEventListener("paste",this.#D)}#C(){document.removeEventListener("copy",this.#P),document.removeEventListener("cut",this.#R),document.removeEventListener("paste",this.#D)}addEditListeners(){this.#j(),this.#F()}removeEditListeners(){this.#x(),this.#C()}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const g=[];for(const _ of this.#u){const c=_.serialize(!0);c&&g.push(c)}g.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(g))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:g}=e;for(const w of g.items)for(const L of this.#r)if(L.isHandlingMimeForPasting(w.type)){L.paste(w,this.currentLayer);return}let _=g.getData("application/pdfjs");if(!_)return;try{_=JSON.parse(_)}catch(w){(0,u.warn)(`paste: "${w.message}".`);return}if(!Array.isArray(_))return;this.unselectAll();const c=this.currentLayer;try{const w=[];for(const m of _){const C=c.deserialize(m);if(!C)return;w.push(C)}const L=()=>{for(const m of w)this.#z(m);this.#V(w)},M=()=>{for(const m of w)m.remove()};this.addCommands({cmd:L,undo:M,mustExec:!0})}catch(w){(0,u.warn)(`paste: "${w.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||f._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#A(e){Object.entries(e).some(([_,c])=>this.#M[_]!==c)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#M,e)})}#U(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#B(),this.#j(),this.#F(),this.#A({isEditing:this.#g!==u.AnnotationEditorType.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#H(),this.#x(),this.#C(),this.#A({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#r){this.#r=e;for(const g of this.#r)this.#U(g.defaultPropertiesToUpdate)}}getId(){return this.#d.getId()}get currentLayer(){return this.#n.get(this.#s)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#s}addLayer(e){this.#n.set(e.pageIndex,e),this.#p?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}updateMode(e,g=null){if(this.#g!==e){if(this.#g=e,e===u.AnnotationEditorType.NONE){this.setEditingState(!1),this.#G();return}this.setEditingState(!0),this.#q(),this.unselectAll();for(const _ of this.#n.values())_.updateMode(e);if(g){for(const _ of this.#e.values())if(_.annotationElementId===g){this.setSelected(_),_.enterInEditMode();break}}}}updateToolbar(e){e!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,g){if(this.#r){if(e===u.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const _ of this.#u)_.updateParams(e,g);for(const _ of this.#r)_.updateDefaultParams(e,g)}}enableWaiting(e=!1){if(this.#v!==e){this.#v=e;for(const g of this.#n.values())e?g.disableClick():g.enableClick(),g.div.classList.toggle("waiting",e)}}#q(){if(!this.#p){this.#p=!0;for(const e of this.#n.values())e.enable()}}#G(){if(this.unselectAll(),this.#p){this.#p=!1;for(const e of this.#n.values())e.disable()}}getEditors(e){const g=[];for(const _ of this.#e.values())_.pageIndex===e&&g.push(_);return g}getEditor(e){return this.#e.get(e)}addEditor(e){this.#e.set(e.id,e)}removeEditor(e){this.#e.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#l.has(e.annotationElementId))&&this.#o?.remove(e.id)}addDeletedAnnotationElement(e){this.#l.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#l.has(e)}removeDeletedAnnotationElement(e){this.#l.delete(e.annotationElementId),e.deleted=!1}#z(e){const g=this.#n.get(e.pageIndex);g?g.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#U(e.propertiesToUpdate))}toggleSelected(e){if(this.#u.has(e)){this.#u.delete(e),e.unselect(),this.#A({hasSelectedEditor:this.hasSelection});return}this.#u.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#A({hasSelectedEditor:!0})}setSelected(e){for(const g of this.#u)g!==e&&g.unselect();this.#u.clear(),this.#u.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#A({hasSelectedEditor:!0})}isSelected(e){return this.#u.has(e)}unselect(e){e.unselect(),this.#u.delete(e),this.#A({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#u.size!==0}undo(){this.#a.undo(),this.#A({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()})}redo(){this.#a.redo(),this.#A({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(e){this.#a.add(e),this.#A({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}#W(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const e of this.#e.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#u],g=()=>{for(const c of e)c.remove()},_=()=>{for(const c of e)this.#z(c)};this.addCommands({cmd:g,undo:_,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#V(e){this.#u.clear();for(const g of e)g.isEmpty()||(this.#u.add(g),g.select());this.#A({hasSelectedEditor:!0})}selectAll(){for(const e of this.#u)e.commit();this.#V(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.hasSelection){for(const e of this.#u)e.unselect();this.#u.clear(),this.#A({hasSelectedEditor:!1})}}translateSelectedEditors(e,g,_=!1){if(_||this.commitOrRemove(),!this.hasSelection)return;this.#y[0]+=e,this.#y[1]+=g;const[c,w]=this.#y,L=[...this.#u],M=1e3;this.#T&&clearTimeout(this.#T),this.#T=setTimeout(()=>{this.#T=null,this.#y[0]=this.#y[1]=0,this.addCommands({cmd:()=>{for(const m of L)this.#e.has(m.id)&&m.translateInPage(c,w)},undo:()=>{for(const m of L)this.#e.has(m.id)&&m.translateInPage(-c,-w)},mustExec:!1})},M);for(const m of L)m.translateInPage(e,g)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(const e of this.#u)this.#c.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);const e=this.#c;this.#c=null;let g=!1;for(const[{x:c,y:w,pageIndex:L},M]of e)M.newX=c,M.newY=w,M.newPageIndex=L,g||=c!==M.savedX||w!==M.savedY||L!==M.savedPageIndex;if(!g)return!1;const _=(c,w,L,M)=>{if(this.#e.has(c.id)){const m=this.#n.get(M);m?c._setParentAndPosition(m,w,L):(c.pageIndex=M,c.x=w,c.y=L)}};return this.addCommands({cmd:()=>{for(const[c,{newX:w,newY:L,newPageIndex:M}]of e)_(c,w,L,M)},undo:()=>{for(const[c,{savedX:w,savedY:L,savedPageIndex:M}]of e)_(c,w,L,M)},mustExec:!0}),!0}dragSelectedEditors(e,g){if(this.#c)for(const _ of this.#c.keys())_.drag(e,g)}rebuild(e){if(e.parent===null){const g=this.getLayer(e.pageIndex);g?(g.changeParent(e),g.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#g}get imageManager(){return(0,u.shadow)(this,"imageManager",new q)}}o.AnnotationEditorUIManager=f}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.StatTimer=o.RenderingCancelledException=o.PixelsPerInch=o.PageViewport=o.PDFDateString=o.DOMStandardFontDataFactory=o.DOMSVGFactory=o.DOMFilterFactory=o.DOMCanvasFactory=o.DOMCMapReaderFactory=void 0,o.deprecated=z,o.getColorValues=bt,o.getCurrentTransform=dt,o.getCurrentTransformInverse=mt,o.getFilenameFromUrl=c,o.getPdfFilenameFromUrl=w,o.getRGB=nt,o.getXfaPageViewport=tt,o.isDataScheme=g,o.isPdfFile=_,o.isValidFetchUrl=M,o.loadScript=C,o.noContextMenu=m,o.setLayerDimensions=At;var u=I(7),y=I(1);const n="http://www.w3.org/2000/svg";class x{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}o.PixelsPerInch=x;class V extends u.BaseFilterFactory{#t;#e;#n;#i;#o;#a;#s;#l;#c;#r;#f=0;constructor({docId:N,ownerDocument:E=globalThis.document}={}){super(),this.#n=N,this.#i=E}get#h(){return this.#t||=new Map}get#d(){if(!this.#e){const N=this.#i.createElement("div"),{style:E}=N;E.visibility="hidden",E.contain="strict",E.width=E.height=0,E.position="absolute",E.top=E.left=0,E.zIndex=-1;const p=this.#i.createElementNS(n,"svg");p.setAttribute("width",0),p.setAttribute("height",0),this.#e=this.#i.createElementNS(n,"defs"),N.append(p),p.append(this.#e),this.#i.body.append(N)}return this.#e}addFilter(N){if(!N)return"none";let E=this.#h.get(N);if(E)return E;let p,r,v,T;if(N.length===1){const a=N[0],b=new Array(256);for(let A=0;A<256;A++)b[A]=a[A]/255;T=p=r=v=b.join(",")}else{const[a,b,A]=N,k=new Array(256),F=new Array(256),U=new Array(256);for(let X=0;X<256;X++)k[X]=a[X]/255,F[X]=b[X]/255,U[X]=A[X]/255;p=k.join(","),r=F.join(","),v=U.join(","),T=`${p}${r}${v}`}if(E=this.#h.get(T),E)return this.#h.set(N,E),E;const P=`g_${this.#n}_transfer_map_${this.#f++}`,D=`url(#${P})`;this.#h.set(N,D),this.#h.set(T,D);const R=this.#v(P);return this.#g(p,r,v,R),D}addHCMFilter(N,E){const p=`${N}-${E}`;if(this.#a===p)return this.#s;if(this.#a=p,this.#s="none",this.#o?.remove(),!N||!E)return this.#s;const r=this.#u(N);N=y.Util.makeHexColor(...r);const v=this.#u(E);if(E=y.Util.makeHexColor(...v),this.#d.style.color="",N==="#000000"&&E==="#ffffff"||N===E)return this.#s;const T=new Array(256);for(let b=0;b<=255;b++){const A=b/255;T[b]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const P=T.join(","),D=`g_${this.#n}_hcm_filter`,R=this.#l=this.#v(D);this.#g(P,P,P,R),this.#p(R);const a=(b,A)=>{const k=r[b]/255,F=v[b]/255,U=new Array(A+1);for(let X=0;X<=A;X++)U[X]=k+X/A*(F-k);return U.join(",")};return this.#g(a(0,5),a(1,5),a(2,5),R),this.#s=`url(#${D})`,this.#s}addHighlightHCMFilter(N,E,p,r){const v=`${N}-${E}-${p}-${r}`;if(this.#c===v)return this.#r;if(this.#c=v,this.#r="none",this.#l?.remove(),!N||!E)return this.#r;const[T,P]=[N,E].map(this.#u.bind(this));let D=Math.round(.2126*T[0]+.7152*T[1]+.0722*T[2]),R=Math.round(.2126*P[0]+.7152*P[1]+.0722*P[2]),[a,b]=[p,r].map(this.#u.bind(this));R<D&&([D,R,a,b]=[R,D,b,a]),this.#d.style.color="";const A=(U,X,it)=>{const St=new Array(256),rt=(R-D)/it,st=U/255,ut=(X-U)/(255*it);let ht=0;for(let gt=0;gt<=it;gt++){const Ct=Math.round(D+gt*rt),Lt=st+gt*ut;for(let Bt=ht;Bt<=Ct;Bt++)St[Bt]=Lt;ht=Ct+1}for(let gt=ht;gt<256;gt++)St[gt]=St[ht-1];return St.join(",")},k=`g_${this.#n}_hcm_highlight_filter`,F=this.#l=this.#v(k);return this.#p(F),this.#g(A(a[0],b[0],5),A(a[1],b[1],5),A(a[2],b[2],5),F),this.#r=`url(#${k})`,this.#r}destroy(N=!1){N&&(this.#s||this.#r)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#f=0)}#p(N){const E=this.#i.createElementNS(n,"feColorMatrix");E.setAttribute("type","matrix"),E.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),N.append(E)}#v(N){const E=this.#i.createElementNS(n,"filter");return E.setAttribute("color-interpolation-filters","sRGB"),E.setAttribute("id",N),this.#d.append(E),E}#m(N,E,p){const r=this.#i.createElementNS(n,E);r.setAttribute("type","discrete"),r.setAttribute("tableValues",p),N.append(r)}#g(N,E,p,r){const v=this.#i.createElementNS(n,"feComponentTransfer");r.append(v),this.#m(v,"feFuncR",N),this.#m(v,"feFuncG",E),this.#m(v,"feFuncB",p)}#u(N){return this.#d.style.color=N,nt(getComputedStyle(this.#d).getPropertyValue("color"))}}o.DOMFilterFactory=V;class q extends u.BaseCanvasFactory{constructor({ownerDocument:N=globalThis.document}={}){super(),this._document=N}_createCanvas(N,E){const p=this._document.createElement("canvas");return p.width=N,p.height=E,p}}o.DOMCanvasFactory=q;async function s(ot,N=!1){if(M(ot,document.baseURI)){const E=await fetch(ot);if(!E.ok)throw new Error(E.statusText);return N?new Uint8Array(await E.arrayBuffer()):(0,y.stringToBytes)(await E.text())}return new Promise((E,p)=>{const r=new XMLHttpRequest;r.open("GET",ot,!0),N&&(r.responseType="arraybuffer"),r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){let v;if(N&&r.response?v=new Uint8Array(r.response):!N&&r.responseText&&(v=(0,y.stringToBytes)(r.responseText)),v){E(v);return}}p(new Error(r.statusText))}},r.send(null)})}class t extends u.BaseCMapReaderFactory{_fetchData(N,E){return s(N,this.isCompressed).then(p=>({cMapData:p,compressionType:E}))}}o.DOMCMapReaderFactory=t;class i extends u.BaseStandardFontDataFactory{_fetchData(N){return s(N,!0)}}o.DOMStandardFontDataFactory=i;class f extends u.BaseSVGFactory{_createSVG(N){return document.createElementNS(n,N)}}o.DOMSVGFactory=f;class h{constructor({viewBox:N,scale:E,rotation:p,offsetX:r=0,offsetY:v=0,dontFlip:T=!1}){this.viewBox=N,this.scale=E,this.rotation=p,this.offsetX=r,this.offsetY=v;const P=(N[2]+N[0])/2,D=(N[3]+N[1])/2;let R,a,b,A;switch(p%=360,p<0&&(p+=360),p){case 180:R=-1,a=0,b=0,A=1;break;case 90:R=0,a=1,b=1,A=0;break;case 270:R=0,a=-1,b=-1,A=0;break;case 0:R=1,a=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}T&&(b=-b,A=-A);let k,F,U,X;R===0?(k=Math.abs(D-N[1])*E+r,F=Math.abs(P-N[0])*E+v,U=(N[3]-N[1])*E,X=(N[2]-N[0])*E):(k=Math.abs(P-N[0])*E+r,F=Math.abs(D-N[1])*E+v,U=(N[2]-N[0])*E,X=(N[3]-N[1])*E),this.transform=[R*E,a*E,b*E,A*E,k-R*E*P-b*E*D,F-a*E*P-A*E*D],this.width=U,this.height=X}get rawDims(){const{viewBox:N}=this;return(0,y.shadow)(this,"rawDims",{pageWidth:N[2]-N[0],pageHeight:N[3]-N[1],pageX:N[0],pageY:N[1]})}clone({scale:N=this.scale,rotation:E=this.rotation,offsetX:p=this.offsetX,offsetY:r=this.offsetY,dontFlip:v=!1}={}){return new h({viewBox:this.viewBox.slice(),scale:N,rotation:E,offsetX:p,offsetY:r,dontFlip:v})}convertToViewportPoint(N,E){return y.Util.applyTransform([N,E],this.transform)}convertToViewportRectangle(N){const E=y.Util.applyTransform([N[0],N[1]],this.transform),p=y.Util.applyTransform([N[2],N[3]],this.transform);return[E[0],E[1],p[0],p[1]]}convertToPdfPoint(N,E){return y.Util.applyInverseTransform([N,E],this.transform)}}o.PageViewport=h;class e extends y.BaseException{constructor(N,E=0){super(N,"RenderingCancelledException"),this.extraDelay=E}}o.RenderingCancelledException=e;function g(ot){const N=ot.length;let E=0;for(;E<N&&ot[E].trim()==="";)E++;return ot.substring(E,E+5).toLowerCase()==="data:"}function _(ot){return typeof ot=="string"&&/\.pdf$/i.test(ot)}function c(ot,N=!1){return N||([ot]=ot.split(/[#?]/,1)),ot.substring(ot.lastIndexOf("/")+1)}function w(ot,N="document.pdf"){if(typeof ot!="string")return N;if(g(ot))return(0,y.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),N;const E=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,p=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=E.exec(ot);let v=p.exec(r[1])||p.exec(r[2])||p.exec(r[3]);if(v&&(v=v[0],v.includes("%")))try{v=p.exec(decodeURIComponent(v))[0]}catch{}return v||N}class L{started=Object.create(null);times=[];time(N){N in this.started&&(0,y.warn)(`Timer is already running for ${N}`),this.started[N]=Date.now()}timeEnd(N){N in this.started||(0,y.warn)(`Timer has not been started for ${N}`),this.times.push({name:N,start:this.started[N],end:Date.now()}),delete this.started[N]}toString(){const N=[];let E=0;for(const{name:p}of this.times)E=Math.max(p.length,E);for(const{name:p,start:r,end:v}of this.times)N.push(`${p.padEnd(E)} ${v-r}ms
`);return N.join("")}}o.StatTimer=L;function M(ot,N){try{const{protocol:E}=N?new URL(ot,N):new URL(ot);return E==="http:"||E==="https:"}catch{return!1}}function m(ot){ot.preventDefault()}function C(ot,N=!1){return new Promise((E,p)=>{const r=document.createElement("script");r.src=ot,r.onload=function(v){N&&r.remove(),E(v)},r.onerror=function(){p(new Error(`Cannot load script at: ${r.src}`))},(document.head||document.documentElement).append(r)})}function z(ot){console.log("Deprecated API usage: "+ot)}let $;class j{static toDateObject(N){if(!N||typeof N!="string")return null;$||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const E=$.exec(N);if(!E)return null;const p=parseInt(E[1],10);let r=parseInt(E[2],10);r=r>=1&&r<=12?r-1:0;let v=parseInt(E[3],10);v=v>=1&&v<=31?v:1;let T=parseInt(E[4],10);T=T>=0&&T<=23?T:0;let P=parseInt(E[5],10);P=P>=0&&P<=59?P:0;let D=parseInt(E[6],10);D=D>=0&&D<=59?D:0;const R=E[7]||"Z";let a=parseInt(E[8],10);a=a>=0&&a<=23?a:0;let b=parseInt(E[9],10)||0;return b=b>=0&&b<=59?b:0,R==="-"?(T+=a,P+=b):R==="+"&&(T-=a,P-=b),new Date(Date.UTC(p,r,v,T,P,D))}}o.PDFDateString=j;function tt(ot,{scale:N=1,rotation:E=0}){const{width:p,height:r}=ot.attributes.style,v=[0,0,parseInt(p),parseInt(r)];return new h({viewBox:v,scale:N,rotation:E})}function nt(ot){if(ot.startsWith("#")){const N=parseInt(ot.slice(1),16);return[(N&16711680)>>16,(N&65280)>>8,N&255]}return ot.startsWith("rgb(")?ot.slice(4,-1).split(",").map(N=>parseInt(N)):ot.startsWith("rgba(")?ot.slice(5,-1).split(",").map(N=>parseInt(N)).slice(0,3):((0,y.warn)(`Not a valid color format: "${ot}"`),[0,0,0])}function bt(ot){const N=document.createElement("span");N.style.visibility="hidden",document.body.append(N);for(const E of ot.keys()){N.style.color=E;const p=window.getComputedStyle(N).color;ot.set(E,nt(p))}N.remove()}function dt(ot){const{a:N,b:E,c:p,d:r,e:v,f:T}=ot.getTransform();return[N,E,p,r,v,T]}function mt(ot){const{a:N,b:E,c:p,d:r,e:v,f:T}=ot.getTransform().invertSelf();return[N,E,p,r,v,T]}function At(ot,N,E=!1,p=!0){if(N instanceof h){const{pageWidth:r,pageHeight:v}=N.rawDims,{style:T}=ot,P=y.FeatureTest.isCSSRoundSupported,D=`var(--scale-factor) * ${r}px`,R=`var(--scale-factor) * ${v}px`,a=P?`round(${D}, 1px)`:`calc(${D})`,b=P?`round(${R}, 1px)`:`calc(${R})`;!E||N.rotation%180===0?(T.width=a,T.height=b):(T.width=b,T.height=a)}p&&ot.setAttribute("data-main-rotation",N.rotation)}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BaseStandardFontDataFactory=o.BaseSVGFactory=o.BaseFilterFactory=o.BaseCanvasFactory=o.BaseCMapReaderFactory=void 0;var u=I(1);class y{constructor(){this.constructor===y&&(0,u.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addHighlightHCMFilter(t,i,f,h){return"none"}destroy(t=!1){}}o.BaseFilterFactory=y;class n{constructor(){this.constructor===n&&(0,u.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const f=this._createCanvas(t,i);return{canvas:f,context:f.getContext("2d")}}reset(t,i,f){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||f<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=f}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){(0,u.unreachable)("Abstract method `_createCanvas` called.")}}o.BaseCanvasFactory=n;class x{constructor({baseUrl:t=null,isCompressed:i=!0}){this.constructor===x&&(0,u.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":""),f=this.isCompressed?u.CMapCompressionType.BINARY:u.CMapCompressionType.NONE;return this._fetchData(i,f).catch(h=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}_fetchData(t,i){(0,u.unreachable)("Abstract method `_fetchData` called.")}}o.BaseCMapReaderFactory=x;class V{constructor({baseUrl:t=null}){this.constructor===V&&(0,u.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetchData(i).catch(f=>{throw new Error(`Unable to load font data at: ${i}`)})}_fetchData(t){(0,u.unreachable)("Abstract method `_fetchData` called.")}}o.BaseStandardFontDataFactory=V;class q{constructor(){this.constructor===q&&(0,u.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,i,f=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const h=this._createSVG("svg:svg");return h.setAttribute("version","1.1"),f||(h.setAttribute("width",`${t}px`),h.setAttribute("height",`${i}px`)),h.setAttribute("preserveAspectRatio","none"),h.setAttribute("viewBox",`0 0 ${t} ${i}`),h}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,u.unreachable)("Abstract method `_createSVG` called.")}}o.BaseSVGFactory=q}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.MurmurHash3_64=void 0;var u=I(1);const y=3285377520,n=4294901760,x=65535;class V{constructor(s){this.h1=s?s&4294967295:y,this.h2=s?s&4294967295:y}update(s){let t,i;if(typeof s=="string"){t=new Uint8Array(s.length*2),i=0;for(let z=0,$=s.length;z<$;z++){const j=s.charCodeAt(z);j<=255?t[i++]=j:(t[i++]=j>>>8,t[i++]=j&255)}}else if((0,u.isArrayBuffer)(s))t=s.slice(),i=t.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const f=i>>2,h=i-f*4,e=new Uint32Array(t.buffer,0,f);let g=0,_=0,c=this.h1,w=this.h2;const L=3432918353,M=461845907,m=L&x,C=M&x;for(let z=0;z<f;z++)z&1?(g=e[z],g=g*L&n|g*m&x,g=g<<15|g>>>17,g=g*M&n|g*C&x,c^=g,c=c<<13|c>>>19,c=c*5+3864292196):(_=e[z],_=_*L&n|_*m&x,_=_<<15|_>>>17,_=_*M&n|_*C&x,w^=_,w=w<<13|w>>>19,w=w*5+3864292196);switch(g=0,h){case 3:g^=t[f*4+2]<<16;case 2:g^=t[f*4+1]<<8;case 1:g^=t[f*4],g=g*L&n|g*m&x,g=g<<15|g>>>17,g=g*M&n|g*C&x,f&1?c^=g:w^=g}this.h1=c,this.h2=w}hexdigest(){let s=this.h1,t=this.h2;return s^=t>>>1,s=s*3981806797&n|s*36045&x,t=t*4283543511&n|((t<<16|s>>>16)*2950163797&n)>>>16,s^=t>>>1,s=s*444984403&n|s*60499&x,t=t*3301882366&n|((t<<16|s>>>16)*3120437893&n)>>>16,s^=t>>>1,(s>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}o.MurmurHash3_64=V}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FontLoader=o.FontFaceObject=void 0;var u=I(1);class y{#t=new Set;constructor({ownerDocument:V=globalThis.document,styleElement:q=null}){this._document=V,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(V){this.nativeFontFaces.add(V),this._document.fonts.add(V)}removeNativeFontFace(V){this.nativeFontFaces.delete(V),this._document.fonts.delete(V)}insertRule(V){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const q=this.styleElement.sheet;q.insertRule(V,q.cssRules.length)}clear(){for(const V of this.nativeFontFaces)this._document.fonts.delete(V);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(V){if(!(!V||this.#t.has(V.loadedName))){if((0,u.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:q,src:s,style:t}=V,i=new FontFace(q,s,t);this.addNativeFontFace(i);try{await i.load(),this.#t.add(q)}catch{(0,u.warn)(`Cannot load system font: ${V.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(i)}return}(0,u.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(V){if(V.attached||V.missingFile&&!V.systemFontInfo)return;if(V.attached=!0,V.systemFontInfo){await this.loadSystemFont(V.systemFontInfo);return}if(this.isFontLoadingAPISupported){const s=V.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(t){throw(0,u.warn)(`Failed to load font '${s.family}': '${t}'.`),V.disableFontFace=!0,t}}return}const q=V.createFontFaceRule();if(q){if(this.insertRule(q),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const t=this._queueLoadingCallback(s);this._prepareFontLoadEvent(V,t)})}}get isFontLoadingAPISupported(){const V=!!this._document?.fonts;return(0,u.shadow)(this,"isFontLoadingAPISupported",V)}get isSyncFontLoadingSupported(){let V=!1;return(u.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(V=!0),(0,u.shadow)(this,"isSyncFontLoadingSupported",V)}_queueLoadingCallback(V){function q(){for((0,u.assert)(!t.done,"completeRequest() cannot be called twice."),t.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,t={done:!1,complete:q,callback:V};return s.push(t),t}get _loadTestFont(){const V=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,u.shadow)(this,"_loadTestFont",V)}_prepareFontLoadEvent(V,q){function s(tt,nt){return tt.charCodeAt(nt)<<24|tt.charCodeAt(nt+1)<<16|tt.charCodeAt(nt+2)<<8|tt.charCodeAt(nt+3)&255}function t(tt,nt,bt,dt){const mt=tt.substring(0,nt),At=tt.substring(nt+bt);return mt+dt+At}let i,f;const h=this._document.createElement("canvas");h.width=1,h.height=1;const e=h.getContext("2d");let g=0;function _(tt,nt){if(++g>30){(0,u.warn)("Load test font never loaded."),nt();return}if(e.font="30px "+tt,e.fillText(".",0,20),e.getImageData(0,0,1,1).data[3]>0){nt();return}setTimeout(_.bind(null,tt,nt))}const c=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=t(w,976,c.length,c);const M=16,m=1482184792;let C=s(w,M);for(i=0,f=c.length-3;i<f;i+=4)C=C-m+s(c,i)|0;i<c.length&&(C=C-m+s(c+"XXX",i)|0),w=t(w,M,4,(0,u.string32)(C));const z=`url(data:font/opentype;base64,${btoa(w)});`,$=`@font-face {font-family:"${c}";src:${z}}`;this.insertRule($);const j=this._document.createElement("div");j.style.visibility="hidden",j.style.width=j.style.height="10px",j.style.position="absolute",j.style.top=j.style.left="0px";for(const tt of[V.loadedName,c]){const nt=this._document.createElement("span");nt.textContent="Hi",nt.style.fontFamily=tt,j.append(nt)}this._document.body.append(j),_(c,()=>{j.remove(),q.complete()})}}o.FontLoader=y;class n{constructor(V,{isEvalSupported:q=!0,disableFontFace:s=!1,ignoreErrors:t=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const f in V)this[f]=V[f];this.isEvalSupported=q!==!1,this.disableFontFace=s===!0,this.ignoreErrors=t===!0,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let V;if(!this.cssFontInfo)V=new FontFace(this.loadedName,this.data,{});else{const q={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(q.style=`oblique ${this.cssFontInfo.italicAngle}deg`),V=new FontFace(this.cssFontInfo.fontFamily,this.data,q)}return this._inspectFont?.(this),V}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const V=(0,u.bytesToString)(this.data),q=`url(data:${this.mimetype};base64,${btoa(V)});`;let s;if(!this.cssFontInfo)s=`@font-face {font-family:"${this.loadedName}";src:${q}}`;else{let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${q}}`}return this._inspectFont?.(this,q),s}getPathGenerator(V,q){if(this.compiledGlyphs[q]!==void 0)return this.compiledGlyphs[q];let s;try{s=V.get(this.loadedName+"_path_"+q)}catch(t){if(!this.ignoreErrors)throw t;return(0,u.warn)(`getPathGenerator - ignoring character: "${t}".`),this.compiledGlyphs[q]=function(i,f){}}if(this.isEvalSupported&&u.FeatureTest.isEvalSupported){const t=[];for(const i of s){const f=i.args!==void 0?i.args.join(","):"";t.push("c.",i.cmd,"(",f,`);
`)}return this.compiledGlyphs[q]=new Function("c","size",t.join(""))}return this.compiledGlyphs[q]=function(t,i){for(const f of s)f.cmd==="scale"&&(f.args=[i,-i]),t[f.cmd].apply(t,f.args)}}}o.FontFaceObject=n}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.NodeStandardFontDataFactory=o.NodeFilterFactory=o.NodeCanvasFactory=o.NodeCMapReaderFactory=void 0;var u=I(7);I(1);const y=function(s){return new Promise((t,i)=>{require$$5.readFile(s,(h,e)=>{if(h||!e){i(new Error(h));return}t(new Uint8Array(e))})})};class n extends u.BaseFilterFactory{}o.NodeFilterFactory=n;class x extends u.BaseCanvasFactory{_createCanvas(t,i){return require$$5.createCanvas(t,i)}}o.NodeCanvasFactory=x;class V extends u.BaseCMapReaderFactory{_fetchData(t,i){return y(t).then(f=>({cMapData:f,compressionType:i}))}}o.NodeCMapReaderFactory=V;class q extends u.BaseStandardFontDataFactory{_fetchData(t){return y(t)}}o.NodeStandardFontDataFactory=q}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CanvasGraphics=void 0;var u=I(1),y=I(6),n=I(12),x=I(13);const V=16,q=100,s=4096,t=15,i=10,f=1e3,h=16;function e(E,p){if(E._removeMirroring)throw new Error("Context is already forwarding operations.");E.__originalSave=E.save,E.__originalRestore=E.restore,E.__originalRotate=E.rotate,E.__originalScale=E.scale,E.__originalTranslate=E.translate,E.__originalTransform=E.transform,E.__originalSetTransform=E.setTransform,E.__originalResetTransform=E.resetTransform,E.__originalClip=E.clip,E.__originalMoveTo=E.moveTo,E.__originalLineTo=E.lineTo,E.__originalBezierCurveTo=E.bezierCurveTo,E.__originalRect=E.rect,E.__originalClosePath=E.closePath,E.__originalBeginPath=E.beginPath,E._removeMirroring=()=>{E.save=E.__originalSave,E.restore=E.__originalRestore,E.rotate=E.__originalRotate,E.scale=E.__originalScale,E.translate=E.__originalTranslate,E.transform=E.__originalTransform,E.setTransform=E.__originalSetTransform,E.resetTransform=E.__originalResetTransform,E.clip=E.__originalClip,E.moveTo=E.__originalMoveTo,E.lineTo=E.__originalLineTo,E.bezierCurveTo=E.__originalBezierCurveTo,E.rect=E.__originalRect,E.closePath=E.__originalClosePath,E.beginPath=E.__originalBeginPath,delete E._removeMirroring},E.save=function(){p.save(),this.__originalSave()},E.restore=function(){p.restore(),this.__originalRestore()},E.translate=function(v,T){p.translate(v,T),this.__originalTranslate(v,T)},E.scale=function(v,T){p.scale(v,T),this.__originalScale(v,T)},E.transform=function(v,T,P,D,R,a){p.transform(v,T,P,D,R,a),this.__originalTransform(v,T,P,D,R,a)},E.setTransform=function(v,T,P,D,R,a){p.setTransform(v,T,P,D,R,a),this.__originalSetTransform(v,T,P,D,R,a)},E.resetTransform=function(){p.resetTransform(),this.__originalResetTransform()},E.rotate=function(v){p.rotate(v),this.__originalRotate(v)},E.clip=function(v){p.clip(v),this.__originalClip(v)},E.moveTo=function(r,v){p.moveTo(r,v),this.__originalMoveTo(r,v)},E.lineTo=function(r,v){p.lineTo(r,v),this.__originalLineTo(r,v)},E.bezierCurveTo=function(r,v,T,P,D,R){p.bezierCurveTo(r,v,T,P,D,R),this.__originalBezierCurveTo(r,v,T,P,D,R)},E.rect=function(r,v,T,P){p.rect(r,v,T,P),this.__originalRect(r,v,T,P)},E.closePath=function(){p.closePath(),this.__originalClosePath()},E.beginPath=function(){p.beginPath(),this.__originalBeginPath()}}class g{constructor(p){this.canvasFactory=p,this.cache=Object.create(null)}getCanvas(p,r,v){let T;return this.cache[p]!==void 0?(T=this.cache[p],this.canvasFactory.reset(T,r,v)):(T=this.canvasFactory.create(r,v),this.cache[p]=T),T}delete(p){delete this.cache[p]}clear(){for(const p in this.cache){const r=this.cache[p];this.canvasFactory.destroy(r),delete this.cache[p]}}}function _(E,p,r,v,T,P,D,R,a,b){const[A,k,F,U,X,it]=(0,y.getCurrentTransform)(E);if(k===0&&F===0){const st=D*A+X,ut=Math.round(st),ht=R*U+it,gt=Math.round(ht),Ct=(D+a)*A+X,Lt=Math.abs(Math.round(Ct)-ut)||1,Bt=(R+b)*U+it,Xt=Math.abs(Math.round(Bt)-gt)||1;return E.setTransform(Math.sign(A),0,0,Math.sign(U),ut,gt),E.drawImage(p,r,v,T,P,0,0,Lt,Xt),E.setTransform(A,k,F,U,X,it),[Lt,Xt]}if(A===0&&U===0){const st=R*F+X,ut=Math.round(st),ht=D*k+it,gt=Math.round(ht),Ct=(R+b)*F+X,Lt=Math.abs(Math.round(Ct)-ut)||1,Bt=(D+a)*k+it,Xt=Math.abs(Math.round(Bt)-gt)||1;return E.setTransform(0,Math.sign(k),Math.sign(F),0,ut,gt),E.drawImage(p,r,v,T,P,0,0,Xt,Lt),E.setTransform(A,k,F,U,X,it),[Xt,Lt]}E.drawImage(p,r,v,T,P,D,R,a,b);const St=Math.hypot(A,k),rt=Math.hypot(F,U);return[St*a,rt*b]}function c(E){const{width:p,height:r}=E;if(p>f||r>f)return null;const v=1e3,T=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),P=p+1;let D=new Uint8Array(P*(r+1)),R,a,b;const A=p+7&-8;let k=new Uint8Array(A*r),F=0;for(const rt of E.data){let st=128;for(;st>0;)k[F++]=rt&st?0:255,st>>=1}let U=0;for(F=0,k[F]!==0&&(D[0]=1,++U),a=1;a<p;a++)k[F]!==k[F+1]&&(D[a]=k[F]?2:1,++U),F++;for(k[F]!==0&&(D[a]=2,++U),R=1;R<r;R++){F=R*A,b=R*P,k[F-A]!==k[F]&&(D[b]=k[F]?1:8,++U);let rt=(k[F]?4:0)+(k[F-A]?8:0);for(a=1;a<p;a++)rt=(rt>>2)+(k[F+1]?4:0)+(k[F-A+1]?8:0),T[rt]&&(D[b+a]=T[rt],++U),F++;if(k[F-A]!==k[F]&&(D[b+a]=k[F]?2:4,++U),U>v)return null}for(F=A*(r-1),b=R*P,k[F]!==0&&(D[b]=8,++U),a=1;a<p;a++)k[F]!==k[F+1]&&(D[b+a]=k[F]?4:8,++U),F++;if(k[F]!==0&&(D[b+a]=4,++U),U>v)return null;const X=new Int32Array([0,P,-1,0,-P,0,0,0,1]),it=new Path2D;for(R=0;U&&R<=r;R++){let rt=R*P;const st=rt+p;for(;rt<st&&!D[rt];)rt++;if(rt===st)continue;it.moveTo(rt%P,R);const ut=rt;let ht=D[rt];do{const gt=X[ht];do rt+=gt;while(!D[rt]);const Ct=D[rt];Ct!==5&&Ct!==10?(ht=Ct,D[rt]=0):(ht=Ct&51*ht>>4,D[rt]&=ht>>2|ht<<2),it.lineTo(rt%P,rt/P|0),D[rt]||--U}while(ut!==rt);--R}return k=null,D=null,function(rt){rt.save(),rt.scale(1/p,-1/r),rt.translate(0,-r),rt.fill(it),rt.beginPath(),rt.restore()}}class w{constructor(p,r){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=u.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=u.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,p,r])}clone(){const p=Object.create(this);return p.clipBox=this.clipBox.slice(),p}setCurrentPoint(p,r){this.x=p,this.y=r}updatePathMinMax(p,r,v){[r,v]=u.Util.applyTransform([r,v],p),this.minX=Math.min(this.minX,r),this.minY=Math.min(this.minY,v),this.maxX=Math.max(this.maxX,r),this.maxY=Math.max(this.maxY,v)}updateRectMinMax(p,r){const v=u.Util.applyTransform(r,p),T=u.Util.applyTransform(r.slice(2),p);this.minX=Math.min(this.minX,v[0],T[0]),this.minY=Math.min(this.minY,v[1],T[1]),this.maxX=Math.max(this.maxX,v[0],T[0]),this.maxY=Math.max(this.maxY,v[1],T[1])}updateScalingPathMinMax(p,r){u.Util.scaleMinMax(p,r),this.minX=Math.min(this.minX,r[0]),this.maxX=Math.max(this.maxX,r[1]),this.minY=Math.min(this.minY,r[2]),this.maxY=Math.max(this.maxY,r[3])}updateCurvePathMinMax(p,r,v,T,P,D,R,a,b,A){const k=u.Util.bezierBoundingBox(r,v,T,P,D,R,a,b);if(A){A[0]=Math.min(A[0],k[0],k[2]),A[1]=Math.max(A[1],k[0],k[2]),A[2]=Math.min(A[2],k[1],k[3]),A[3]=Math.max(A[3],k[1],k[3]);return}this.updateRectMinMax(p,k)}getPathBoundingBox(p=n.PathType.FILL,r=null){const v=[this.minX,this.minY,this.maxX,this.maxY];if(p===n.PathType.STROKE){r||(0,u.unreachable)("Stroke bounding box must include transform.");const T=u.Util.singularValueDecompose2dScale(r),P=T[0]*this.lineWidth/2,D=T[1]*this.lineWidth/2;v[0]-=P,v[1]-=D,v[2]+=P,v[3]+=D}return v}updateClipFromPath(){const p=u.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(p||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(p){this.clipBox=p,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(p=n.PathType.FILL,r=null){return u.Util.intersect(this.clipBox,this.getPathBoundingBox(p,r))}}function L(E,p){if(typeof ImageData<"u"&&p instanceof ImageData){E.putImageData(p,0,0);return}const r=p.height,v=p.width,T=r%h,P=(r-T)/h,D=T===0?P:P+1,R=E.createImageData(v,h);let a=0,b;const A=p.data,k=R.data;let F,U,X,it;if(p.kind===u.ImageKind.GRAYSCALE_1BPP){const St=A.byteLength,rt=new Uint32Array(k.buffer,0,k.byteLength>>2),st=rt.length,ut=v+7>>3,ht=4294967295,gt=u.FeatureTest.isLittleEndian?4278190080:255;for(F=0;F<D;F++){for(X=F<P?h:T,b=0,U=0;U<X;U++){const Ct=St-a;let Lt=0;const Bt=Ct>ut?v:Ct*8-7,Xt=Bt&-8;let $t=0,ne=0;for(;Lt<Xt;Lt+=8)ne=A[a++],rt[b++]=ne&128?ht:gt,rt[b++]=ne&64?ht:gt,rt[b++]=ne&32?ht:gt,rt[b++]=ne&16?ht:gt,rt[b++]=ne&8?ht:gt,rt[b++]=ne&4?ht:gt,rt[b++]=ne&2?ht:gt,rt[b++]=ne&1?ht:gt;for(;Lt<Bt;Lt++)$t===0&&(ne=A[a++],$t=128),rt[b++]=ne&$t?ht:gt,$t>>=1}for(;b<st;)rt[b++]=0;E.putImageData(R,0,F*h)}}else if(p.kind===u.ImageKind.RGBA_32BPP){for(U=0,it=v*h*4,F=0;F<P;F++)k.set(A.subarray(a,a+it)),a+=it,E.putImageData(R,0,U),U+=h;F<D&&(it=v*T*4,k.set(A.subarray(a,a+it)),E.putImageData(R,0,U))}else if(p.kind===u.ImageKind.RGB_24BPP)for(X=h,it=v*X,F=0;F<D;F++){for(F>=P&&(X=T,it=v*X),b=0,U=it;U--;)k[b++]=A[a++],k[b++]=A[a++],k[b++]=A[a++],k[b++]=255;E.putImageData(R,0,F*h)}else throw new Error(`bad image kind: ${p.kind}`)}function M(E,p){if(p.bitmap){E.drawImage(p.bitmap,0,0);return}const r=p.height,v=p.width,T=r%h,P=(r-T)/h,D=T===0?P:P+1,R=E.createImageData(v,h);let a=0;const b=p.data,A=R.data;for(let k=0;k<D;k++){const F=k<P?h:T;({srcPos:a}=(0,x.convertBlackAndWhiteToRGBA)({src:b,srcPos:a,dest:A,width:v,height:F,nonBlackColor:0})),E.putImageData(R,0,k*h)}}function m(E,p){const r=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const v of r)E[v]!==void 0&&(p[v]=E[v]);E.setLineDash!==void 0&&(p.setLineDash(E.getLineDash()),p.lineDashOffset=E.lineDashOffset)}function C(E){if(E.strokeStyle=E.fillStyle="#000000",E.fillRule="nonzero",E.globalAlpha=1,E.lineWidth=1,E.lineCap="butt",E.lineJoin="miter",E.miterLimit=10,E.globalCompositeOperation="source-over",E.font="10px sans-serif",E.setLineDash!==void 0&&(E.setLineDash([]),E.lineDashOffset=0),!u.isNodeJS){const{filter:p}=E;p!=="none"&&p!==""&&(E.filter="none")}}function z(E,p,r,v){const T=E.length;for(let P=3;P<T;P+=4){const D=E[P];if(D===0)E[P-3]=p,E[P-2]=r,E[P-1]=v;else if(D<255){const R=255-D;E[P-3]=E[P-3]*D+p*R>>8,E[P-2]=E[P-2]*D+r*R>>8,E[P-1]=E[P-1]*D+v*R>>8}}}function $(E,p,r){const v=E.length,T=1/255;for(let P=3;P<v;P+=4){const D=r?r[E[P]]:E[P];p[P]=p[P]*D*T|0}}function j(E,p,r){const v=E.length;for(let T=3;T<v;T+=4){const P=E[T-3]*77+E[T-2]*152+E[T-1]*28;p[T]=r?p[T]*r[P>>8]>>8:p[T]*P>>16}}function tt(E,p,r,v,T,P,D,R,a,b,A){const k=!!P,F=k?P[0]:0,U=k?P[1]:0,X=k?P[2]:0,it=T==="Luminosity"?j:$,rt=Math.min(v,Math.ceil(1048576/r));for(let st=0;st<v;st+=rt){const ut=Math.min(rt,v-st),ht=E.getImageData(R-b,st+(a-A),r,ut),gt=p.getImageData(R,st+a,r,ut);k&&z(ht.data,F,U,X),it(ht.data,gt.data,D),p.putImageData(gt,R,st+a)}}function nt(E,p,r,v){const T=v[0],P=v[1],D=v[2]-T,R=v[3]-P;D===0||R===0||(tt(p.context,r,D,R,p.subtype,p.backdrop,p.transferMap,T,P,p.offsetX,p.offsetY),E.save(),E.globalAlpha=1,E.globalCompositeOperation="source-over",E.setTransform(1,0,0,1,0,0),E.drawImage(r.canvas,0,0),E.restore())}function bt(E,p){const r=u.Util.singularValueDecompose2dScale(E);r[0]=Math.fround(r[0]),r[1]=Math.fround(r[1]);const v=Math.fround((globalThis.devicePixelRatio||1)*y.PixelsPerInch.PDF_TO_CSS_UNITS);return p!==void 0?p:r[0]<=v||r[1]<=v}const dt=["butt","round","square"],mt=["miter","round","bevel"],At={},ot={};class N{constructor(p,r,v,T,P,{optionalContentConfig:D,markedContentStack:R=null},a,b){this.ctx=p,this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=r,this.objs=v,this.canvasFactory=T,this.filterFactory=P,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=R||[],this.optionalContentConfig=D,this.cachedCanvases=new g(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=a,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=b,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(p,r=null){return typeof p=="string"?p.startsWith("g_")?this.commonObjs.get(p):this.objs.get(p):r}beginDrawing({transform:p,viewport:r,transparency:v=!1,background:T=null}){const P=this.ctx.canvas.width,D=this.ctx.canvas.height,R=this.ctx.fillStyle;if(this.ctx.fillStyle=T||"#ffffff",this.ctx.fillRect(0,0,P,D),this.ctx.fillStyle=R,v){const a=this.cachedCanvases.getCanvas("transparent",P,D);this.compositeCtx=this.ctx,this.transparentCanvas=a.canvas,this.ctx=a.context,this.ctx.save(),this.ctx.transform(...(0,y.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),C(this.ctx),p&&(this.ctx.transform(...p),this.outputScaleX=p[0],this.outputScaleY=p[0]),this.ctx.transform(...r.transform),this.viewportScale=r.scale,this.baseTransform=(0,y.getCurrentTransform)(this.ctx)}executeOperatorList(p,r,v,T){const P=p.argsArray,D=p.fnArray;let R=r||0;const a=P.length;if(a===R)return R;const b=a-R>i&&typeof v=="function",A=b?Date.now()+t:0;let k=0;const F=this.commonObjs,U=this.objs;let X;for(;;){if(T!==void 0&&R===T.nextBreakPoint)return T.breakIt(R,v),R;if(X=D[R],X!==u.OPS.dependency)this[X].apply(this,P[R]);else for(const it of P[R]){const St=it.startsWith("g_")?F:U;if(!St.has(it))return St.get(it,v),R}if(R++,R===a)return R;if(b&&++k>i){if(Date.now()>A)return v(),R;k=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const p of this._cachedBitmapsMap.values()){for(const r of p.values())typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&(r.width=r.height=0);p.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const p=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(p!=="none"){const r=this.ctx.filter;this.ctx.filter=p,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=r}}}_scaleImage(p,r){const v=p.width,T=p.height;let P=Math.max(Math.hypot(r[0],r[1]),1),D=Math.max(Math.hypot(r[2],r[3]),1),R=v,a=T,b="prescale1",A,k;for(;P>2&&R>1||D>2&&a>1;){let F=R,U=a;P>2&&R>1&&(F=R>=16384?Math.floor(R/2)-1||1:Math.ceil(R/2),P/=R/F),D>2&&a>1&&(U=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a)/2,D/=a/U),A=this.cachedCanvases.getCanvas(b,F,U),k=A.context,k.clearRect(0,0,F,U),k.drawImage(p,0,0,R,a,0,0,F,U),p=A.canvas,R=F,a=U,b=b==="prescale1"?"prescale2":"prescale1"}return{img:p,paintWidth:R,paintHeight:a}}_createMaskCanvas(p){const r=this.ctx,{width:v,height:T}=p,P=this.current.fillColor,D=this.current.patternFill,R=(0,y.getCurrentTransform)(r);let a,b,A,k;if((p.bitmap||p.data)&&p.count>1){const Lt=p.bitmap||p.data.buffer;b=JSON.stringify(D?R:[R.slice(0,4),P]),a=this._cachedBitmapsMap.get(Lt),a||(a=new Map,this._cachedBitmapsMap.set(Lt,a));const Bt=a.get(b);if(Bt&&!D){const Xt=Math.round(Math.min(R[0],R[2])+R[4]),$t=Math.round(Math.min(R[1],R[3])+R[5]);return{canvas:Bt,offsetX:Xt,offsetY:$t}}A=Bt}A||(k=this.cachedCanvases.getCanvas("maskCanvas",v,T),M(k.context,p));let F=u.Util.transform(R,[1/v,0,0,-1/T,0,0]);F=u.Util.transform(F,[1,0,0,1,0,-T]);const U=u.Util.applyTransform([0,0],F),X=u.Util.applyTransform([v,T],F),it=u.Util.normalizeRect([U[0],U[1],X[0],X[1]]),St=Math.round(it[2]-it[0])||1,rt=Math.round(it[3]-it[1])||1,st=this.cachedCanvases.getCanvas("fillCanvas",St,rt),ut=st.context,ht=Math.min(U[0],X[0]),gt=Math.min(U[1],X[1]);ut.translate(-ht,-gt),ut.transform(...F),A||(A=this._scaleImage(k.canvas,(0,y.getCurrentTransformInverse)(ut)),A=A.img,a&&D&&a.set(b,A)),ut.imageSmoothingEnabled=bt((0,y.getCurrentTransform)(ut),p.interpolate),_(ut,A,0,0,A.width,A.height,0,0,v,T),ut.globalCompositeOperation="source-in";const Ct=u.Util.transform((0,y.getCurrentTransformInverse)(ut),[1,0,0,1,-ht,-gt]);return ut.fillStyle=D?P.getPattern(r,this,Ct,n.PathType.FILL):P,ut.fillRect(0,0,v,T),a&&!D&&(this.cachedCanvases.delete("fillCanvas"),a.set(b,st.canvas)),{canvas:st.canvas,offsetX:Math.round(ht),offsetY:Math.round(gt)}}setLineWidth(p){p!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=p,this.ctx.lineWidth=p}setLineCap(p){this.ctx.lineCap=dt[p]}setLineJoin(p){this.ctx.lineJoin=mt[p]}setMiterLimit(p){this.ctx.miterLimit=p}setDash(p,r){const v=this.ctx;v.setLineDash!==void 0&&(v.setLineDash(p),v.lineDashOffset=r)}setRenderingIntent(p){}setFlatness(p){}setGState(p){for(const[r,v]of p)switch(r){case"LW":this.setLineWidth(v);break;case"LC":this.setLineCap(v);break;case"LJ":this.setLineJoin(v);break;case"ML":this.setMiterLimit(v);break;case"D":this.setDash(v[0],v[1]);break;case"RI":this.setRenderingIntent(v);break;case"FL":this.setFlatness(v);break;case"Font":this.setFont(v[0],v[1]);break;case"CA":this.current.strokeAlpha=v;break;case"ca":this.current.fillAlpha=v,this.ctx.globalAlpha=v;break;case"BM":this.ctx.globalCompositeOperation=v;break;case"SMask":this.current.activeSMask=v?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(v);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const p=this.inSMaskMode;this.current.activeSMask&&!p?this.beginSMaskMode():!this.current.activeSMask&&p&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const p=this.ctx.canvas.width,r=this.ctx.canvas.height,v="smaskGroupAt"+this.groupLevel,T=this.cachedCanvases.getCanvas(v,p,r);this.suspendedCtx=this.ctx,this.ctx=T.context;const P=this.ctx;P.setTransform(...(0,y.getCurrentTransform)(this.suspendedCtx)),m(this.suspendedCtx,P),e(P,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),m(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(p){if(!this.current.activeSMask)return;p?(p[0]=Math.floor(p[0]),p[1]=Math.floor(p[1]),p[2]=Math.ceil(p[2]),p[3]=Math.ceil(p[3])):p=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const r=this.current.activeSMask,v=this.suspendedCtx;nt(v,r,this.ctx,p),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(m(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const p=this.current;this.stateStack.push(p),this.current=p.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),m(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(p,r,v,T,P,D){this.ctx.transform(p,r,v,T,P,D),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(p,r,v){const T=this.ctx,P=this.current;let D=P.x,R=P.y,a,b;const A=(0,y.getCurrentTransform)(T),k=A[0]===0&&A[3]===0||A[1]===0&&A[2]===0,F=k?v.slice(0):null;for(let U=0,X=0,it=p.length;U<it;U++)switch(p[U]|0){case u.OPS.rectangle:D=r[X++],R=r[X++];const St=r[X++],rt=r[X++],st=D+St,ut=R+rt;T.moveTo(D,R),St===0||rt===0?T.lineTo(st,ut):(T.lineTo(st,R),T.lineTo(st,ut),T.lineTo(D,ut)),k||P.updateRectMinMax(A,[D,R,st,ut]),T.closePath();break;case u.OPS.moveTo:D=r[X++],R=r[X++],T.moveTo(D,R),k||P.updatePathMinMax(A,D,R);break;case u.OPS.lineTo:D=r[X++],R=r[X++],T.lineTo(D,R),k||P.updatePathMinMax(A,D,R);break;case u.OPS.curveTo:a=D,b=R,D=r[X+4],R=r[X+5],T.bezierCurveTo(r[X],r[X+1],r[X+2],r[X+3],D,R),P.updateCurvePathMinMax(A,a,b,r[X],r[X+1],r[X+2],r[X+3],D,R,F),X+=6;break;case u.OPS.curveTo2:a=D,b=R,T.bezierCurveTo(D,R,r[X],r[X+1],r[X+2],r[X+3]),P.updateCurvePathMinMax(A,a,b,D,R,r[X],r[X+1],r[X+2],r[X+3],F),D=r[X+2],R=r[X+3],X+=4;break;case u.OPS.curveTo3:a=D,b=R,D=r[X+2],R=r[X+3],T.bezierCurveTo(r[X],r[X+1],D,R,D,R),P.updateCurvePathMinMax(A,a,b,r[X],r[X+1],D,R,D,R,F),X+=4;break;case u.OPS.closePath:T.closePath();break}k&&P.updateScalingPathMinMax(A,F),P.setCurrentPoint(D,R)}closePath(){this.ctx.closePath()}stroke(p=!0){const r=this.ctx,v=this.current.strokeColor;r.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof v=="object"&&v?.getPattern?(r.save(),r.strokeStyle=v.getPattern(r,this,(0,y.getCurrentTransformInverse)(r),n.PathType.STROKE),this.rescaleAndStroke(!1),r.restore()):this.rescaleAndStroke(!0)),p&&this.consumePath(this.current.getClippedPathBoundingBox()),r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(p=!0){const r=this.ctx,v=this.current.fillColor,T=this.current.patternFill;let P=!1;T&&(r.save(),r.fillStyle=v.getPattern(r,this,(0,y.getCurrentTransformInverse)(r),n.PathType.FILL),P=!0);const D=this.current.getClippedPathBoundingBox();this.contentVisible&&D!==null&&(this.pendingEOFill?(r.fill("evenodd"),this.pendingEOFill=!1):r.fill()),P&&r.restore(),p&&this.consumePath(D)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=At}eoClip(){this.pendingClip=ot}beginText(){this.current.textMatrix=u.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const p=this.pendingTextPaths,r=this.ctx;if(p===void 0){r.beginPath();return}r.save(),r.beginPath();for(const v of p)r.setTransform(...v.transform),r.translate(v.x,v.y),v.addToPath(r,v.fontSize);r.restore(),r.clip(),r.beginPath(),delete this.pendingTextPaths}setCharSpacing(p){this.current.charSpacing=p}setWordSpacing(p){this.current.wordSpacing=p}setHScale(p){this.current.textHScale=p/100}setLeading(p){this.current.leading=-p}setFont(p,r){const v=this.commonObjs.get(p),T=this.current;if(!v)throw new Error(`Can't find font for ${p}`);if(T.fontMatrix=v.fontMatrix||u.FONT_IDENTITY_MATRIX,(T.fontMatrix[0]===0||T.fontMatrix[3]===0)&&(0,u.warn)("Invalid font matrix for font "+p),r<0?(r=-r,T.fontDirection=-1):T.fontDirection=1,this.current.font=v,this.current.fontSize=r,v.isType3Font)return;const P=v.loadedName||"sans-serif",D=v.systemFontInfo?.css||`"${P}", ${v.fallbackName}`;let R="normal";v.black?R="900":v.bold&&(R="bold");const a=v.italic?"italic":"normal";let b=r;r<V?b=V:r>q&&(b=q),this.current.fontSizeScale=r/b,this.ctx.font=`${a} ${R} ${b}px ${D}`}setTextRenderingMode(p){this.current.textRenderingMode=p}setTextRise(p){this.current.textRise=p}moveText(p,r){this.current.x=this.current.lineX+=p,this.current.y=this.current.lineY+=r}setLeadingMoveText(p,r){this.setLeading(-r),this.moveText(p,r)}setTextMatrix(p,r,v,T,P,D){this.current.textMatrix=[p,r,v,T,P,D],this.current.textMatrixScale=Math.hypot(p,r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(p,r,v,T){const P=this.ctx,D=this.current,R=D.font,a=D.textRenderingMode,b=D.fontSize/D.fontSizeScale,A=a&u.TextRenderingMode.FILL_STROKE_MASK,k=!!(a&u.TextRenderingMode.ADD_TO_PATH_FLAG),F=D.patternFill&&!R.missingFile;let U;(R.disableFontFace||k||F)&&(U=R.getPathGenerator(this.commonObjs,p)),R.disableFontFace||F?(P.save(),P.translate(r,v),P.beginPath(),U(P,b),T&&P.setTransform(...T),(A===u.TextRenderingMode.FILL||A===u.TextRenderingMode.FILL_STROKE)&&P.fill(),(A===u.TextRenderingMode.STROKE||A===u.TextRenderingMode.FILL_STROKE)&&P.stroke(),P.restore()):((A===u.TextRenderingMode.FILL||A===u.TextRenderingMode.FILL_STROKE)&&P.fillText(p,r,v),(A===u.TextRenderingMode.STROKE||A===u.TextRenderingMode.FILL_STROKE)&&P.strokeText(p,r,v)),k&&(this.pendingTextPaths||=[]).push({transform:(0,y.getCurrentTransform)(P),x:r,y:v,fontSize:b,addToPath:U})}get isFontSubpixelAAEnabled(){const{context:p}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);p.scale(1.5,1),p.fillText("I",0,10);const r=p.getImageData(0,0,10,10).data;let v=!1;for(let T=3;T<r.length;T+=4)if(r[T]>0&&r[T]<255){v=!0;break}return(0,u.shadow)(this,"isFontSubpixelAAEnabled",v)}showText(p){const r=this.current,v=r.font;if(v.isType3Font)return this.showType3Text(p);const T=r.fontSize;if(T===0)return;const P=this.ctx,D=r.fontSizeScale,R=r.charSpacing,a=r.wordSpacing,b=r.fontDirection,A=r.textHScale*b,k=p.length,F=v.vertical,U=F?1:-1,X=v.defaultVMetrics,it=T*r.fontMatrix[0],St=r.textRenderingMode===u.TextRenderingMode.FILL&&!v.disableFontFace&&!r.patternFill;P.save(),P.transform(...r.textMatrix),P.translate(r.x,r.y+r.textRise),b>0?P.scale(A,-1):P.scale(A,1);let rt;if(r.patternFill){P.save();const Ct=r.fillColor.getPattern(P,this,(0,y.getCurrentTransformInverse)(P),n.PathType.FILL);rt=(0,y.getCurrentTransform)(P),P.restore(),P.fillStyle=Ct}let st=r.lineWidth;const ut=r.textMatrixScale;if(ut===0||st===0){const Ct=r.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;(Ct===u.TextRenderingMode.STROKE||Ct===u.TextRenderingMode.FILL_STROKE)&&(st=this.getSinglePixelWidth())}else st/=ut;if(D!==1&&(P.scale(D,D),st/=D),P.lineWidth=st,v.isInvalidPDFjsFont){const Ct=[];let Lt=0;for(const Bt of p)Ct.push(Bt.unicode),Lt+=Bt.width;P.fillText(Ct.join(""),0,0),r.x+=Lt*it*A,P.restore(),this.compose();return}let ht=0,gt;for(gt=0;gt<k;++gt){const Ct=p[gt];if(typeof Ct=="number"){ht+=U*Ct*T/1e3;continue}let Lt=!1;const Bt=(Ct.isSpace?a:0)+R,Xt=Ct.fontChar,$t=Ct.accent;let ne,Me,Ae=Ct.width;if(F){const Pe=Ct.vmetric||X,Oe=-(Ct.vmetric?Pe[1]:Ae*.5)*it,qe=Pe[2]*it;Ae=Pe?-Pe[0]:Ae,ne=Oe/D,Me=(ht+qe)/D}else ne=ht/D,Me=0;if(v.remeasure&&Ae>0){const Pe=P.measureText(Xt).width*1e3/T*D;if(Ae<Pe&&this.isFontSubpixelAAEnabled){const Oe=Ae/Pe;Lt=!0,P.save(),P.scale(Oe,1),ne/=Oe}else Ae!==Pe&&(ne+=(Ae-Pe)/2e3*T/D)}if(this.contentVisible&&(Ct.isInFont||v.missingFile)){if(St&&!$t)P.fillText(Xt,ne,Me);else if(this.paintChar(Xt,ne,Me,rt),$t){const Pe=ne+T*$t.offset.x/D,Oe=Me-T*$t.offset.y/D;this.paintChar($t.fontChar,Pe,Oe,rt)}}const je=F?Ae*it-Bt*b:Ae*it+Bt*b;ht+=je,Lt&&P.restore()}F?r.y-=ht:r.x+=ht*A,P.restore(),this.compose()}showType3Text(p){const r=this.ctx,v=this.current,T=v.font,P=v.fontSize,D=v.fontDirection,R=T.vertical?1:-1,a=v.charSpacing,b=v.wordSpacing,A=v.textHScale*D,k=v.fontMatrix||u.FONT_IDENTITY_MATRIX,F=p.length,U=v.textRenderingMode===u.TextRenderingMode.INVISIBLE;let X,it,St,rt;if(!(U||P===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),r.transform(...v.textMatrix),r.translate(v.x,v.y),r.scale(A,D),X=0;X<F;++X){if(it=p[X],typeof it=="number"){rt=R*it*P/1e3,this.ctx.translate(rt,0),v.x+=rt*A;continue}const st=(it.isSpace?b:0)+a,ut=T.charProcOperatorList[it.operatorListId];if(!ut){(0,u.warn)(`Type3 character "${it.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=it,this.save(),r.scale(P,P),r.transform(...k),this.executeOperatorList(ut),this.restore()),St=u.Util.applyTransform([it.width,0],k)[0]*P+st,r.translate(St,0),v.x+=St*A}r.restore(),this.processingType3=null}}setCharWidth(p,r){}setCharWidthAndBounds(p,r,v,T,P,D){this.ctx.rect(v,T,P-v,D-T),this.ctx.clip(),this.endPath()}getColorN_Pattern(p){let r;if(p[0]==="TilingPattern"){const v=p[1],T=this.baseTransform||(0,y.getCurrentTransform)(this.ctx),P={createCanvasGraphics:D=>new N(D,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};r=new n.TilingPattern(p,v,this.ctx,P,T)}else r=this._getPattern(p[1],p[2]);return r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(p,r,v){const T=u.Util.makeHexColor(p,r,v);this.ctx.strokeStyle=T,this.current.strokeColor=T}setFillRGBColor(p,r,v){const T=u.Util.makeHexColor(p,r,v);this.ctx.fillStyle=T,this.current.fillColor=T,this.current.patternFill=!1}_getPattern(p,r=null){let v;return this.cachedPatterns.has(p)?v=this.cachedPatterns.get(p):(v=(0,n.getShadingPattern)(this.getObject(p)),this.cachedPatterns.set(p,v)),r&&(v.matrix=r),v}shadingFill(p){if(!this.contentVisible)return;const r=this.ctx;this.save();const v=this._getPattern(p);r.fillStyle=v.getPattern(r,this,(0,y.getCurrentTransformInverse)(r),n.PathType.SHADING);const T=(0,y.getCurrentTransformInverse)(r);if(T){const{width:P,height:D}=r.canvas,[R,a,b,A]=u.Util.getAxialAlignedBoundingBox([0,0,P,D],T);this.ctx.fillRect(R,a,b-R,A-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,u.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,u.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(p,r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(p)&&p.length===6&&this.transform(...p),this.baseTransform=(0,y.getCurrentTransform)(this.ctx),r)){const v=r[2]-r[0],T=r[3]-r[1];this.ctx.rect(r[0],r[1],v,T),this.current.updateRectMinMax((0,y.getCurrentTransform)(this.ctx),r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(p){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;p.isolated||(0,u.info)("TODO: Support non-isolated groups."),p.knockout&&(0,u.warn)("Knockout groups not supported.");const v=(0,y.getCurrentTransform)(r);if(p.matrix&&r.transform(...p.matrix),!p.bbox)throw new Error("Bounding box is required.");let T=u.Util.getAxialAlignedBoundingBox(p.bbox,(0,y.getCurrentTransform)(r));const P=[0,0,r.canvas.width,r.canvas.height];T=u.Util.intersect(T,P)||[0,0,0,0];const D=Math.floor(T[0]),R=Math.floor(T[1]);let a=Math.max(Math.ceil(T[2])-D,1),b=Math.max(Math.ceil(T[3])-R,1),A=1,k=1;a>s&&(A=a/s,a=s),b>s&&(k=b/s,b=s),this.current.startNewPathAndClipBox([0,0,a,b]);let F="groupAt"+this.groupLevel;p.smask&&(F+="_smask_"+this.smaskCounter++%2);const U=this.cachedCanvases.getCanvas(F,a,b),X=U.context;X.scale(1/A,1/k),X.translate(-D,-R),X.transform(...v),p.smask?this.smaskStack.push({canvas:U.canvas,context:X,offsetX:D,offsetY:R,scaleX:A,scaleY:k,subtype:p.smask.subtype,backdrop:p.smask.backdrop,transferMap:p.smask.transferMap||null,startTransformInverse:null}):(r.setTransform(1,0,0,1,0,0),r.translate(D,R),r.scale(A,k),r.save()),m(r,X),this.ctx=X,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(p){if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,v=this.groupStack.pop();if(this.ctx=v,this.ctx.imageSmoothingEnabled=!1,p.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const T=(0,y.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...T);const P=u.Util.getAxialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],T);this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(P)}}beginAnnotation(p,r,v,T,P){if(this.#t(),C(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(r)&&r.length===4){const D=r[2]-r[0],R=r[3]-r[1];if(P&&this.annotationCanvasMap){v=v.slice(),v[4]-=r[0],v[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=D,r[3]=R;const[a,b]=u.Util.singularValueDecompose2dScale((0,y.getCurrentTransform)(this.ctx)),{viewportScale:A}=this,k=Math.ceil(D*this.outputScaleX*A),F=Math.ceil(R*this.outputScaleY*A);this.annotationCanvas=this.canvasFactory.create(k,F);const{canvas:U,context:X}=this.annotationCanvas;this.annotationCanvasMap.set(p,U),this.annotationCanvas.savedCtx=this.ctx,this.ctx=X,this.ctx.save(),this.ctx.setTransform(a,0,0,-b,0,R*b),C(this.ctx)}else C(this.ctx),this.ctx.rect(r[0],r[1],D,R),this.ctx.clip(),this.endPath()}this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...v),this.transform(...T)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(p){if(!this.contentVisible)return;const r=p.count;p=this.getObject(p.data,p),p.count=r;const v=this.ctx,T=this.processingType3;if(T&&(T.compiled===void 0&&(T.compiled=c(p)),T.compiled)){T.compiled(v);return}const P=this._createMaskCanvas(p),D=P.canvas;v.save(),v.setTransform(1,0,0,1,0,0),v.drawImage(D,P.offsetX,P.offsetY),v.restore(),this.compose()}paintImageMaskXObjectRepeat(p,r,v=0,T=0,P,D){if(!this.contentVisible)return;p=this.getObject(p.data,p);const R=this.ctx;R.save();const a=(0,y.getCurrentTransform)(R);R.transform(r,v,T,P,0,0);const b=this._createMaskCanvas(p);R.setTransform(1,0,0,1,b.offsetX-a[4],b.offsetY-a[5]);for(let A=0,k=D.length;A<k;A+=2){const F=u.Util.transform(a,[r,v,T,P,D[A],D[A+1]]),[U,X]=u.Util.applyTransform([0,0],F);R.drawImage(b.canvas,U,X)}R.restore(),this.compose()}paintImageMaskXObjectGroup(p){if(!this.contentVisible)return;const r=this.ctx,v=this.current.fillColor,T=this.current.patternFill;for(const P of p){const{data:D,width:R,height:a,transform:b}=P,A=this.cachedCanvases.getCanvas("maskCanvas",R,a),k=A.context;k.save();const F=this.getObject(D,P);M(k,F),k.globalCompositeOperation="source-in",k.fillStyle=T?v.getPattern(k,this,(0,y.getCurrentTransformInverse)(r),n.PathType.FILL):v,k.fillRect(0,0,R,a),k.restore(),r.save(),r.transform(...b),r.scale(1,-1),_(r,A.canvas,0,0,R,a,0,-1,1,1),r.restore()}this.compose()}paintImageXObject(p){if(!this.contentVisible)return;const r=this.getObject(p);if(!r){(0,u.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(r)}paintImageXObjectRepeat(p,r,v,T){if(!this.contentVisible)return;const P=this.getObject(p);if(!P){(0,u.warn)("Dependent image isn't ready yet");return}const D=P.width,R=P.height,a=[];for(let b=0,A=T.length;b<A;b+=2)a.push({transform:[r,0,0,v,T[b],T[b+1]],x:0,y:0,w:D,h:R});this.paintInlineImageXObjectGroup(P,a)}applyTransferMapsToCanvas(p){return this.current.transferMaps!=="none"&&(p.filter=this.current.transferMaps,p.drawImage(p.canvas,0,0),p.filter="none"),p.canvas}applyTransferMapsToBitmap(p){if(this.current.transferMaps==="none")return p.bitmap;const{bitmap:r,width:v,height:T}=p,P=this.cachedCanvases.getCanvas("inlineImage",v,T),D=P.context;return D.filter=this.current.transferMaps,D.drawImage(r,0,0),D.filter="none",P.canvas}paintInlineImageXObject(p){if(!this.contentVisible)return;const r=p.width,v=p.height,T=this.ctx;if(this.save(),!u.isNodeJS){const{filter:R}=T;R!=="none"&&R!==""&&(T.filter="none")}T.scale(1/r,-1/v);let P;if(p.bitmap)P=this.applyTransferMapsToBitmap(p);else if(typeof HTMLElement=="function"&&p instanceof HTMLElement||!p.data)P=p;else{const a=this.cachedCanvases.getCanvas("inlineImage",r,v).context;L(a,p),P=this.applyTransferMapsToCanvas(a)}const D=this._scaleImage(P,(0,y.getCurrentTransformInverse)(T));T.imageSmoothingEnabled=bt((0,y.getCurrentTransform)(T),p.interpolate),_(T,D.img,0,0,D.paintWidth,D.paintHeight,0,-v,r,v),this.compose(),this.restore()}paintInlineImageXObjectGroup(p,r){if(!this.contentVisible)return;const v=this.ctx;let T;if(p.bitmap)T=p.bitmap;else{const P=p.width,D=p.height,a=this.cachedCanvases.getCanvas("inlineImage",P,D).context;L(a,p),T=this.applyTransferMapsToCanvas(a)}for(const P of r)v.save(),v.transform(...P.transform),v.scale(1,-1),_(v,T,P.x,P.y,P.w,P.h,0,-1,1,1),v.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(p){}markPointProps(p,r){}beginMarkedContent(p){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(p,r){p==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(p){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(p);const v=this.ctx;this.pendingClip&&(r||(this.pendingClip===ot?v.clip("evenodd"):v.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),v.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const p=(0,y.getCurrentTransform)(this.ctx);if(p[1]===0&&p[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(p[0]),Math.abs(p[3]));else{const r=Math.abs(p[0]*p[3]-p[2]*p[1]),v=Math.hypot(p[0],p[2]),T=Math.hypot(p[1],p[3]);this._cachedGetSinglePixelWidth=Math.max(v,T)/r}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:p}=this.current,{a:r,b:v,c:T,d:P}=this.ctx.getTransform();let D,R;if(v===0&&T===0){const a=Math.abs(r),b=Math.abs(P);if(a===b)if(p===0)D=R=1/a;else{const A=a*p;D=R=A<1?1/A:1}else if(p===0)D=1/a,R=1/b;else{const A=a*p,k=b*p;D=A<1?1/A:1,R=k<1?1/k:1}}else{const a=Math.abs(r*P-v*T),b=Math.hypot(r,v),A=Math.hypot(T,P);if(p===0)D=A/a,R=b/a;else{const k=p*a;D=A>k?A/k:1,R=b>k?b/k:1}}this._cachedScaleForStroking[0]=D,this._cachedScaleForStroking[1]=R}return this._cachedScaleForStroking}rescaleAndStroke(p){const{ctx:r}=this,{lineWidth:v}=this.current,[T,P]=this.getScaleForStroking();if(r.lineWidth=v||1,T===1&&P===1){r.stroke();return}const D=r.getLineDash();if(p&&r.save(),r.scale(T,P),D.length>0){const R=Math.max(T,P);r.setLineDash(D.map(a=>a/R)),r.lineDashOffset/=R}r.stroke(),p&&r.restore()}isContentVisible(){for(let p=this.markedContentStack.length-1;p>=0;p--)if(!this.markedContentStack[p].visible)return!1;return!0}}o.CanvasGraphics=N;for(const E in u.OPS)N.prototype[E]!==void 0&&(N.prototype[u.OPS[E]]=N.prototype[E])}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TilingPattern=o.PathType=void 0,o.getShadingPattern=h;var u=I(1),y=I(6);const n={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};o.PathType=n;function x(_,c){if(!c)return;const w=c[2]-c[0],L=c[3]-c[1],M=new Path2D;M.rect(c[0],c[1],w,L),_.clip(M)}class V{constructor(){this.constructor===V&&(0,u.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,u.unreachable)("Abstract method `getPattern` called.")}}class q extends V{constructor(c){super(),this._type=c[1],this._bbox=c[2],this._colorStops=c[3],this._p0=c[4],this._p1=c[5],this._r0=c[6],this._r1=c[7],this.matrix=null}_createGradient(c){let w;this._type==="axial"?w=c.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(w=c.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const L of this._colorStops)w.addColorStop(L[0],L[1]);return w}getPattern(c,w,L,M){let m;if(M===n.STROKE||M===n.FILL){const C=w.current.getClippedPathBoundingBox(M,(0,y.getCurrentTransform)(c))||[0,0,0,0],z=Math.ceil(C[2]-C[0])||1,$=Math.ceil(C[3]-C[1])||1,j=w.cachedCanvases.getCanvas("pattern",z,$,!0),tt=j.context;tt.clearRect(0,0,tt.canvas.width,tt.canvas.height),tt.beginPath(),tt.rect(0,0,tt.canvas.width,tt.canvas.height),tt.translate(-C[0],-C[1]),L=u.Util.transform(L,[1,0,0,1,C[0],C[1]]),tt.transform(...w.baseTransform),this.matrix&&tt.transform(...this.matrix),x(tt,this._bbox),tt.fillStyle=this._createGradient(tt),tt.fill(),m=c.createPattern(j.canvas,"no-repeat");const nt=new DOMMatrix(L);m.setTransform(nt)}else x(c,this._bbox),m=this._createGradient(c);return m}}function s(_,c,w,L,M,m,C,z){const $=c.coords,j=c.colors,tt=_.data,nt=_.width*4;let bt;$[w+1]>$[L+1]&&(bt=w,w=L,L=bt,bt=m,m=C,C=bt),$[L+1]>$[M+1]&&(bt=L,L=M,M=bt,bt=C,C=z,z=bt),$[w+1]>$[L+1]&&(bt=w,w=L,L=bt,bt=m,m=C,C=bt);const dt=($[w]+c.offsetX)*c.scaleX,mt=($[w+1]+c.offsetY)*c.scaleY,At=($[L]+c.offsetX)*c.scaleX,ot=($[L+1]+c.offsetY)*c.scaleY,N=($[M]+c.offsetX)*c.scaleX,E=($[M+1]+c.offsetY)*c.scaleY;if(mt>=E)return;const p=j[m],r=j[m+1],v=j[m+2],T=j[C],P=j[C+1],D=j[C+2],R=j[z],a=j[z+1],b=j[z+2],A=Math.round(mt),k=Math.round(E);let F,U,X,it,St,rt,st,ut;for(let ht=A;ht<=k;ht++){if(ht<ot){const Xt=ht<mt?0:(mt-ht)/(mt-ot);F=dt-(dt-At)*Xt,U=p-(p-T)*Xt,X=r-(r-P)*Xt,it=v-(v-D)*Xt}else{let Xt;ht>E?Xt=1:ot===E?Xt=0:Xt=(ot-ht)/(ot-E),F=At-(At-N)*Xt,U=T-(T-R)*Xt,X=P-(P-a)*Xt,it=D-(D-b)*Xt}let gt;ht<mt?gt=0:ht>E?gt=1:gt=(mt-ht)/(mt-E),St=dt-(dt-N)*gt,rt=p-(p-R)*gt,st=r-(r-a)*gt,ut=v-(v-b)*gt;const Ct=Math.round(Math.min(F,St)),Lt=Math.round(Math.max(F,St));let Bt=nt*ht+Ct*4;for(let Xt=Ct;Xt<=Lt;Xt++)gt=(F-Xt)/(F-St),gt<0?gt=0:gt>1&&(gt=1),tt[Bt++]=U-(U-rt)*gt|0,tt[Bt++]=X-(X-st)*gt|0,tt[Bt++]=it-(it-ut)*gt|0,tt[Bt++]=255}}function t(_,c,w){const L=c.coords,M=c.colors;let m,C;switch(c.type){case"lattice":const z=c.verticesPerRow,$=Math.floor(L.length/z)-1,j=z-1;for(m=0;m<$;m++){let tt=m*z;for(let nt=0;nt<j;nt++,tt++)s(_,w,L[tt],L[tt+1],L[tt+z],M[tt],M[tt+1],M[tt+z]),s(_,w,L[tt+z+1],L[tt+1],L[tt+z],M[tt+z+1],M[tt+1],M[tt+z])}break;case"triangles":for(m=0,C=L.length;m<C;m+=3)s(_,w,L[m],L[m+1],L[m+2],M[m],M[m+1],M[m+2]);break;default:throw new Error("illegal figure")}}class i extends V{constructor(c){super(),this._coords=c[2],this._colors=c[3],this._figures=c[4],this._bounds=c[5],this._bbox=c[7],this._background=c[8],this.matrix=null}_createMeshCanvas(c,w,L){const z=Math.floor(this._bounds[0]),$=Math.floor(this._bounds[1]),j=Math.ceil(this._bounds[2])-z,tt=Math.ceil(this._bounds[3])-$,nt=Math.min(Math.ceil(Math.abs(j*c[0]*1.1)),3e3),bt=Math.min(Math.ceil(Math.abs(tt*c[1]*1.1)),3e3),dt=j/nt,mt=tt/bt,At={coords:this._coords,colors:this._colors,offsetX:-z,offsetY:-$,scaleX:1/dt,scaleY:1/mt},ot=nt+4,N=bt+4,E=L.getCanvas("mesh",ot,N,!1),p=E.context,r=p.createImageData(nt,bt);if(w){const T=r.data;for(let P=0,D=T.length;P<D;P+=4)T[P]=w[0],T[P+1]=w[1],T[P+2]=w[2],T[P+3]=255}for(const T of this._figures)t(r,T,At);return p.putImageData(r,2,2),{canvas:E.canvas,offsetX:z-2*dt,offsetY:$-2*mt,scaleX:dt,scaleY:mt}}getPattern(c,w,L,M){x(c,this._bbox);let m;if(M===n.SHADING)m=u.Util.singularValueDecompose2dScale((0,y.getCurrentTransform)(c));else if(m=u.Util.singularValueDecompose2dScale(w.baseTransform),this.matrix){const z=u.Util.singularValueDecompose2dScale(this.matrix);m=[m[0]*z[0],m[1]*z[1]]}const C=this._createMeshCanvas(m,M===n.SHADING?null:this._background,w.cachedCanvases);return M!==n.SHADING&&(c.setTransform(...w.baseTransform),this.matrix&&c.transform(...this.matrix)),c.translate(C.offsetX,C.offsetY),c.scale(C.scaleX,C.scaleY),c.createPattern(C.canvas,"no-repeat")}}class f extends V{getPattern(){return"hotpink"}}function h(_){switch(_[0]){case"RadialAxial":return new q(_);case"Mesh":return new i(_);case"Dummy":return new f}throw new Error(`Unknown IR type: ${_[0]}`)}const e={COLORED:1,UNCOLORED:2};class g{static MAX_PATTERN_SIZE=3e3;constructor(c,w,L,M,m){this.operatorList=c[2],this.matrix=c[3]||[1,0,0,1,0,0],this.bbox=c[4],this.xstep=c[5],this.ystep=c[6],this.paintType=c[7],this.tilingType=c[8],this.color=w,this.ctx=L,this.canvasGraphicsFactory=M,this.baseTransform=m}createPatternCanvas(c){const w=this.operatorList,L=this.bbox,M=this.xstep,m=this.ystep,C=this.paintType,z=this.tilingType,$=this.color,j=this.canvasGraphicsFactory;(0,u.info)("TilingType: "+z);const tt=L[0],nt=L[1],bt=L[2],dt=L[3],mt=u.Util.singularValueDecompose2dScale(this.matrix),At=u.Util.singularValueDecompose2dScale(this.baseTransform),ot=[mt[0]*At[0],mt[1]*At[1]],N=this.getSizeAndScale(M,this.ctx.canvas.width,ot[0]),E=this.getSizeAndScale(m,this.ctx.canvas.height,ot[1]),p=c.cachedCanvases.getCanvas("pattern",N.size,E.size,!0),r=p.context,v=j.createCanvasGraphics(r);v.groupLevel=c.groupLevel,this.setFillAndStrokeStyleToContext(v,C,$);let T=tt,P=nt,D=bt,R=dt;return tt<0&&(T=0,D+=Math.abs(tt)),nt<0&&(P=0,R+=Math.abs(nt)),r.translate(-(N.scale*T),-(E.scale*P)),v.transform(N.scale,0,0,E.scale,0,0),r.save(),this.clipBbox(v,T,P,D,R),v.baseTransform=(0,y.getCurrentTransform)(v.ctx),v.executeOperatorList(w),v.endDrawing(),{canvas:p.canvas,scaleX:N.scale,scaleY:E.scale,offsetX:T,offsetY:P}}getSizeAndScale(c,w,L){c=Math.abs(c);const M=Math.max(g.MAX_PATTERN_SIZE,w);let m=Math.ceil(c*L);return m>=M?m=M:L=m/c,{scale:L,size:m}}clipBbox(c,w,L,M,m){const C=M-w,z=m-L;c.ctx.rect(w,L,C,z),c.current.updateRectMinMax((0,y.getCurrentTransform)(c.ctx),[w,L,M,m]),c.clip(),c.endPath()}setFillAndStrokeStyleToContext(c,w,L){const M=c.ctx,m=c.current;switch(w){case e.COLORED:const C=this.ctx;M.fillStyle=C.fillStyle,M.strokeStyle=C.strokeStyle,m.fillColor=C.fillStyle,m.strokeColor=C.strokeStyle;break;case e.UNCOLORED:const z=u.Util.makeHexColor(L[0],L[1],L[2]);M.fillStyle=z,M.strokeStyle=z,m.fillColor=z,m.strokeColor=z;break;default:throw new u.FormatError(`Unsupported paint type: ${w}`)}}getPattern(c,w,L,M){let m=L;M!==n.SHADING&&(m=u.Util.transform(m,w.baseTransform),this.matrix&&(m=u.Util.transform(m,this.matrix)));const C=this.createPatternCanvas(w);let z=new DOMMatrix(m);z=z.translate(C.offsetX,C.offsetY),z=z.scale(1/C.scaleX,1/C.scaleY);const $=c.createPattern(C.canvas,"repeat");return $.setTransform(z),$}}o.TilingPattern=g}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.convertBlackAndWhiteToRGBA=n,o.convertToRGBA=y,o.grayToRGBA=V;var u=I(1);function y(q){switch(q.kind){case u.ImageKind.GRAYSCALE_1BPP:return n(q);case u.ImageKind.RGB_24BPP:return x(q)}return null}function n({src:q,srcPos:s=0,dest:t,width:i,height:f,nonBlackColor:h=4294967295,inverseDecode:e=!1}){const g=u.FeatureTest.isLittleEndian?4278190080:255,[_,c]=e?[h,g]:[g,h],w=i>>3,L=i&7,M=q.length;t=new Uint32Array(t.buffer);let m=0;for(let C=0;C<f;C++){for(const $=s+w;s<$;s++){const j=s<M?q[s]:255;t[m++]=j&128?c:_,t[m++]=j&64?c:_,t[m++]=j&32?c:_,t[m++]=j&16?c:_,t[m++]=j&8?c:_,t[m++]=j&4?c:_,t[m++]=j&2?c:_,t[m++]=j&1?c:_}if(L===0)continue;const z=s<M?q[s++]:255;for(let $=0;$<L;$++)t[m++]=z&1<<7-$?c:_}return{srcPos:s,destPos:m}}function x({src:q,srcPos:s=0,dest:t,destPos:i=0,width:f,height:h}){let e=0;const g=q.length>>2,_=new Uint32Array(q.buffer,s,g);if(u.FeatureTest.isLittleEndian){for(;e<g-2;e+=3,i+=4){const c=_[e],w=_[e+1],L=_[e+2];t[i]=c|4278190080,t[i+1]=c>>>24|w<<8|4278190080,t[i+2]=w>>>16|L<<16|4278190080,t[i+3]=L>>>8|4278190080}for(let c=e*4,w=q.length;c<w;c+=3)t[i++]=q[c]|q[c+1]<<8|q[c+2]<<16|4278190080}else{for(;e<g-2;e+=3,i+=4){const c=_[e],w=_[e+1],L=_[e+2];t[i]=c|255,t[i+1]=c<<24|w>>>8|255,t[i+2]=w<<16|L>>>16|255,t[i+3]=L<<8|255}for(let c=e*4,w=q.length;c<w;c+=3)t[i++]=q[c]<<24|q[c+1]<<16|q[c+2]<<8|255}return{srcPos:s,destPos:i}}function V(q,s){if(u.FeatureTest.isLittleEndian)for(let t=0,i=q.length;t<i;t++)s[t]=q[t]*65793|4278190080;else for(let t=0,i=q.length;t<i;t++)s[t]=q[t]*16843008|255}}),((d,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.GlobalWorkerOptions=void 0;const I=Object.create(null);o.GlobalWorkerOptions=I,I.workerPort=null,I.workerSrc=""}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.MessageHandler=void 0;var u=I(1);const y={DATA:1,ERROR:2},n={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x(q){switch(q instanceof Error||typeof q=="object"&&q!==null||(0,u.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),q.name){case"AbortException":return new u.AbortException(q.message);case"MissingPDFException":return new u.MissingPDFException(q.message);case"PasswordException":return new u.PasswordException(q.message,q.code);case"UnexpectedResponseException":return new u.UnexpectedResponseException(q.message,q.status);case"UnknownErrorException":return new u.UnknownErrorException(q.message,q.details);default:return new u.UnknownErrorException(q.message,q.toString())}}class V{constructor(s,t,i){this.sourceName=s,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{const h=f.data;if(h.targetName!==this.sourceName)return;if(h.stream){this.#e(h);return}if(h.callback){const g=h.callbackId,_=this.callbackCapabilities[g];if(!_)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],h.callback===y.DATA)_.resolve(h.data);else if(h.callback===y.ERROR)_.reject(x(h.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[h.action];if(!e)throw new Error(`Unknown action from worker: ${h.action}`);if(h.callbackId){const g=this.sourceName,_=h.sourceName;new Promise(function(c){c(e(h.data))}).then(function(c){i.postMessage({sourceName:g,targetName:_,callback:y.DATA,callbackId:h.callbackId,data:c})},function(c){i.postMessage({sourceName:g,targetName:_,callback:y.ERROR,callbackId:h.callbackId,reason:x(c)})});return}if(h.streamId){this.#t(h);return}e(h.data)},i.addEventListener("message",this._onComObjOnMessage)}on(s,t){const i=this.actionHandler;if(i[s])throw new Error(`There is already an actionName called "${s}"`);i[s]=t}send(s,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,data:t},i)}sendWithPromise(s,t,i){const f=this.callbackId++,h=new u.PromiseCapability;this.callbackCapabilities[f]=h;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:s,callbackId:f,data:t},i)}catch(e){h.reject(e)}return h.promise}sendWithStream(s,t,i,f){const h=this.streamId++,e=this.sourceName,g=this.targetName,_=this.comObj;return new ReadableStream({start:c=>{const w=new u.PromiseCapability;return this.streamControllers[h]={controller:c,startCall:w,pullCall:null,cancelCall:null,isClosed:!1},_.postMessage({sourceName:e,targetName:g,action:s,streamId:h,data:t,desiredSize:c.desiredSize},f),w.promise},pull:c=>{const w=new u.PromiseCapability;return this.streamControllers[h].pullCall=w,_.postMessage({sourceName:e,targetName:g,stream:n.PULL,streamId:h,desiredSize:c.desiredSize}),w.promise},cancel:c=>{(0,u.assert)(c instanceof Error,"cancel must have a valid reason");const w=new u.PromiseCapability;return this.streamControllers[h].cancelCall=w,this.streamControllers[h].isClosed=!0,_.postMessage({sourceName:e,targetName:g,stream:n.CANCEL,streamId:h,reason:x(c)}),w.promise}},i)}#t(s){const t=s.streamId,i=this.sourceName,f=s.sourceName,h=this.comObj,e=this,g=this.actionHandler[s.action],_={enqueue(c,w=1,L){if(this.isCancelled)return;const M=this.desiredSize;this.desiredSize-=w,M>0&&this.desiredSize<=0&&(this.sinkCapability=new u.PromiseCapability,this.ready=this.sinkCapability.promise),h.postMessage({sourceName:i,targetName:f,stream:n.ENQUEUE,streamId:t,chunk:c},L)},close(){this.isCancelled||(this.isCancelled=!0,h.postMessage({sourceName:i,targetName:f,stream:n.CLOSE,streamId:t}),delete e.streamSinks[t])},error(c){(0,u.assert)(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,h.postMessage({sourceName:i,targetName:f,stream:n.ERROR,streamId:t,reason:x(c)}))},sinkCapability:new u.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:s.desiredSize,ready:null};_.sinkCapability.resolve(),_.ready=_.sinkCapability.promise,this.streamSinks[t]=_,new Promise(function(c){c(g(s.data,_))}).then(function(){h.postMessage({sourceName:i,targetName:f,stream:n.START_COMPLETE,streamId:t,success:!0})},function(c){h.postMessage({sourceName:i,targetName:f,stream:n.START_COMPLETE,streamId:t,reason:x(c)})})}#e(s){const t=s.streamId,i=this.sourceName,f=s.sourceName,h=this.comObj,e=this.streamControllers[t],g=this.streamSinks[t];switch(s.stream){case n.START_COMPLETE:s.success?e.startCall.resolve():e.startCall.reject(x(s.reason));break;case n.PULL_COMPLETE:s.success?e.pullCall.resolve():e.pullCall.reject(x(s.reason));break;case n.PULL:if(!g){h.postMessage({sourceName:i,targetName:f,stream:n.PULL_COMPLETE,streamId:t,success:!0});break}g.desiredSize<=0&&s.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=s.desiredSize,new Promise(function(_){_(g.onPull?.())}).then(function(){h.postMessage({sourceName:i,targetName:f,stream:n.PULL_COMPLETE,streamId:t,success:!0})},function(_){h.postMessage({sourceName:i,targetName:f,stream:n.PULL_COMPLETE,streamId:t,reason:x(_)})});break;case n.ENQUEUE:if((0,u.assert)(e,"enqueue should have stream controller"),e.isClosed)break;e.controller.enqueue(s.chunk);break;case n.CLOSE:if((0,u.assert)(e,"close should have stream controller"),e.isClosed)break;e.isClosed=!0,e.controller.close(),this.#n(e,t);break;case n.ERROR:(0,u.assert)(e,"error should have stream controller"),e.controller.error(x(s.reason)),this.#n(e,t);break;case n.CANCEL_COMPLETE:s.success?e.cancelCall.resolve():e.cancelCall.reject(x(s.reason)),this.#n(e,t);break;case n.CANCEL:if(!g)break;new Promise(function(_){_(g.onCancel?.(x(s.reason)))}).then(function(){h.postMessage({sourceName:i,targetName:f,stream:n.CANCEL_COMPLETE,streamId:t,success:!0})},function(_){h.postMessage({sourceName:i,targetName:f,stream:n.CANCEL_COMPLETE,streamId:t,reason:x(_)})}),g.sinkCapability.reject(x(s.reason)),g.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#n(s,t){await Promise.allSettled([s.startCall?.promise,s.pullCall?.promise,s.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}o.MessageHandler=V}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Metadata=void 0;var u=I(1);class y{#t;#e;constructor({parsedData:x,rawData:V}){this.#t=x,this.#e=V}getRaw(){return this.#e}get(x){return this.#t.get(x)??null}getAll(){return(0,u.objectFromMap)(this.#t)}has(x){return this.#t.has(x)}}o.Metadata=y}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OptionalContentConfig=void 0;var u=I(1),y=I(8);const n=Symbol("INTERNAL");class x{#t=!0;constructor(s,t){this.name=s,this.intent=t}get visible(){return this.#t}_setVisible(s,t){s!==n&&(0,u.unreachable)("Internal method `_setVisible` called."),this.#t=t}}class V{#t=null;#e=new Map;#n=null;#i=null;constructor(s){if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,this.#i=s.order;for(const t of s.groups)this.#e.set(t.id,new x(t.name,t.intent));if(s.baseState==="OFF")for(const t of this.#e.values())t._setVisible(n,!1);for(const t of s.on)this.#e.get(t)._setVisible(n,!0);for(const t of s.off)this.#e.get(t)._setVisible(n,!1);this.#n=this.getHash()}}#o(s){const t=s.length;if(t<2)return!0;const i=s[0];for(let f=1;f<t;f++){const h=s[f];let e;if(Array.isArray(h))e=this.#o(h);else if(this.#e.has(h))e=this.#e.get(h).visible;else return(0,u.warn)(`Optional content group not found: ${h}`),!0;switch(i){case"And":if(!e)return!1;break;case"Or":if(e)return!0;break;case"Not":return!e;default:return!0}}return i==="And"}isVisible(s){if(this.#e.size===0)return!0;if(!s)return(0,u.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return this.#e.has(s.id)?this.#e.get(s.id).visible:((0,u.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return this.#o(s.expression);if(!s.policy||s.policy==="AnyOn"){for(const t of s.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const t of s.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const t of s.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const t of s.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!1}return!0}return(0,u.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,u.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,t=!0){if(!this.#e.has(s)){(0,u.warn)(`Optional content group not found: ${s}`);return}this.#e.get(s)._setVisible(n,!!t),this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,u.objectFromMap)(this.#e):null}getGroup(s){return this.#e.get(s)||null}getHash(){if(this.#t!==null)return this.#t;const s=new y.MurmurHash3_64;for(const[t,i]of this.#e)s.update(`${t}:${i.visible}`);return this.#t=s.hexdigest()}}o.OptionalContentConfig=V}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFDataTransportStream=void 0;var u=I(1),y=I(6);class n{constructor({length:s,initialData:t,progressiveDone:i=!1,contentDispositionFilename:f=null,disableRange:h=!1,disableStream:e=!1},g){if((0,u.assert)(g,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=i,this._contentDispositionFilename=f,t?.length>0){const _=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(_)}this._pdfDataRangeTransport=g,this._isStreamingSupported=!e,this._isRangeSupported=!h,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((_,c)=>{this._onReceiveData({begin:_,chunk:c})}),this._pdfDataRangeTransport.addProgressListener((_,c)=>{this._onProgress({loaded:_,total:c})}),this._pdfDataRangeTransport.addProgressiveReadListener(_=>{this._onReceiveData({chunk:_})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:s,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(s===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const f=this._rangeReaders.some(function(h){return h._begin!==s?!1:(h._enqueue(i),!0)});(0,u.assert)(f,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(s){s.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:s.loaded}):this._fullRequestReader?.onProgress?.({loaded:s.loaded,total:s.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(s){const t=this._rangeReaders.indexOf(s);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,u.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const s=this._queuedChunks;return this._queuedChunks=null,new x(this,s,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(s,t){if(t<=this._progressiveDataLength)return null;const i=new V(this,s,t);return this._pdfDataRangeTransport.requestDataRange(s,t),this._rangeReaders.push(i),i}cancelAllRequests(s){this._fullRequestReader?.cancel(s);for(const t of this._rangeReaders.slice(0))t.cancel(s);this._pdfDataRangeTransport.abort()}}o.PDFDataTransportStream=n;class x{constructor(s,t,i=!1,f=null){this._stream=s,this._done=i||!1,this._filename=(0,y.isPdfFile)(f)?f:null,this._queuedChunks=t||[],this._loaded=0;for(const h of this._queuedChunks)this._loaded+=h.byteLength;this._requests=[],this._headersReady=Promise.resolve(),s._fullRequestReader=this,this.onProgress=null}_enqueue(s){this._done||(this._requests.length>0?this._requests.shift().resolve({value:s,done:!1}):this._queuedChunks.push(s),this._loaded+=s.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const s=new u.PromiseCapability;return this._requests.push(s),s.promise}cancel(s){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class V{constructor(s,t,i){this._stream=s,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(s){if(!this._done){if(this._requests.length===0)this._queuedChunk=s;else{this._requests.shift().resolve({value:s,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const s=new u.PromiseCapability;return this._requests.push(s),s.promise}cancel(s){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFFetchStream=void 0;var u=I(1),y=I(20);function n(i,f,h){return{method:"GET",headers:i,signal:h.signal,mode:"cors",credentials:f?"include":"same-origin",redirect:"follow"}}function x(i){const f=new Headers;for(const h in i){const e=i[h];e!==void 0&&f.append(h,e)}return f}function V(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:((0,u.warn)(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class q{constructor(f){this.source=f,this.isHttp=/^https?:/i.test(f.url),this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new s(this),this._fullRequestReader}getRangeReader(f,h){if(h<=this._progressiveDataLength)return null;const e=new t(this,f,h);return this._rangeRequestReaders.push(e),e}cancelAllRequests(f){this._fullRequestReader?.cancel(f);for(const h of this._rangeRequestReaders.slice(0))h.cancel(f)}}o.PDFFetchStream=q;class s{constructor(f){this._stream=f,this._reader=null,this._loaded=0,this._filename=null;const h=f.source;this._withCredentials=h.withCredentials||!1,this._contentLength=h.length,this._headersCapability=new u.PromiseCapability,this._disableRange=h.disableRange||!1,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._headers=x(this._stream.httpHeaders);const e=h.url;fetch(e,n(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,y.validateResponseStatus)(g.status))throw(0,y.createResponseStatusError)(g.status,e);this._reader=g.body.getReader(),this._headersCapability.resolve();const _=L=>g.headers.get(L),{allowRangeRequests:c,suggestedLength:w}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=w||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(_),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new u.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:f,done:h}=await this._reader.read();return h?{value:f,done:h}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:V(f),done:!1})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}class t{constructor(f,h,e){this._stream=f,this._reader=null,this._loaded=0;const g=f.source;this._withCredentials=g.withCredentials||!1,this._readCapability=new u.PromiseCapability,this._isStreamingSupported=!g.disableStream,this._abortController=new AbortController,this._headers=x(this._stream.httpHeaders),this._headers.append("Range",`bytes=${h}-${e-1}`);const _=g.url;fetch(_,n(this._headers,this._withCredentials,this._abortController)).then(c=>{if(!(0,y.validateResponseStatus)(c.status))throw(0,y.createResponseStatusError)(c.status,_);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:f,done:h}=await this._reader.read();return h?{value:f,done:h}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded}),{value:V(f),done:!1})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createResponseStatusError=q,o.extractFilenameFromHeader=V,o.validateRangeRequestCapabilities=x,o.validateResponseStatus=s;var u=I(1),y=I(21),n=I(6);function x({getResponseHeader:t,isHttp:i,rangeChunkSize:f,disableRange:h}){const e={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(t("Content-Length"),10);return!Number.isInteger(g)||(e.suggestedLength=g,g<=2*f)||h||!i||t("Accept-Ranges")!=="bytes"||(t("Content-Encoding")||"identity")!=="identity"||(e.allowRangeRequests=!0),e}function V(t){const i=t("Content-Disposition");if(i){let f=(0,y.getFilenameFromContentDispositionHeader)(i);if(f.includes("%"))try{f=decodeURIComponent(f)}catch{}if((0,n.isPdfFile)(f))return f}return null}function q(t,i){return t===404||t===0&&i.startsWith("file:")?new u.MissingPDFException('Missing PDF "'+i+'".'):new u.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${i}".`,t)}function s(t){return t===200||t===206}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getFilenameFromContentDispositionHeader=y;var u=I(1);function y(n){let x=!0,V=q("filename\\*","i").exec(n);if(V){V=V[1];let g=f(V);return g=unescape(g),g=h(g),g=e(g),t(g)}if(V=i(n),V){const g=e(V);return t(g)}if(V=q("filename","i").exec(n),V){V=V[1];let g=f(V);return g=e(g),t(g)}function q(g,_){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',_)}function s(g,_){if(g){if(!/^[\x00-\xFF]+$/.test(_))return _;try{const c=new TextDecoder(g,{fatal:!0}),w=(0,u.stringToBytes)(_);_=c.decode(w),x=!1}catch{}}return _}function t(g){return x&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),x&&(g=s("iso-8859-1",g))),g}function i(g){const _=[];let c;const w=q("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(c=w.exec(g))!==null;){let[,M,m,C]=c;if(M=parseInt(M,10),M in _){if(M===0)break;continue}_[M]=[m,C]}const L=[];for(let M=0;M<_.length&&M in _;++M){let[m,C]=_[M];C=f(C),m&&(C=unescape(C),M===0&&(C=h(C))),L.push(C)}return L.join("")}function f(g){if(g.startsWith('"')){const _=g.slice(1).split('\\"');for(let c=0;c<_.length;++c){const w=_[c].indexOf('"');w!==-1&&(_[c]=_[c].slice(0,w),_.length=c+1),_[c]=_[c].replaceAll(/\\(.)/g,"$1")}g=_.join('"')}return g}function h(g){const _=g.indexOf("'");if(_===-1)return g;const c=g.slice(0,_),L=g.slice(_+1).replace(/^[^']*'/,"");return s(c,L)}function e(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(_,c,w,L){if(w==="q"||w==="Q")return L=L.replaceAll("_"," "),L=L.replaceAll(/=([0-9a-fA-F]{2})/g,function(M,m){return String.fromCharCode(parseInt(m,16))}),s(c,L);try{L=atob(L)}catch{}return s(c,L)})}return""}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFNetworkStream=void 0;var u=I(1),y=I(20);const n=200,x=206;function V(f){const h=f.response;return typeof h!="string"?h:(0,u.stringToBytes)(h).buffer}class q{constructor(h,e={}){this.url=h,this.isHttp=/^https?:/i.test(h),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(h,e,g){const _={begin:h,end:e};for(const c in g)_[c]=g[c];return this.request(_)}requestFull(h){return this.request(h)}request(h){const e=new XMLHttpRequest,g=this.currXhrId++,_=this.pendingRequests[g]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const c in this.httpHeaders){const w=this.httpHeaders[c];w!==void 0&&e.setRequestHeader(c,w)}return this.isHttp&&"begin"in h&&"end"in h?(e.setRequestHeader("Range",`bytes=${h.begin}-${h.end-1}`),_.expectedStatus=x):_.expectedStatus=n,e.responseType="arraybuffer",h.onError&&(e.onerror=function(c){h.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,g),e.onprogress=this.onProgress.bind(this,g),_.onHeadersReceived=h.onHeadersReceived,_.onDone=h.onDone,_.onError=h.onError,_.onProgress=h.onProgress,e.send(null),g}onProgress(h,e){const g=this.pendingRequests[h];g&&g.onProgress?.(e)}onStateChange(h,e){const g=this.pendingRequests[h];if(!g)return;const _=g.xhr;if(_.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),_.readyState!==4||!(h in this.pendingRequests))return;if(delete this.pendingRequests[h],_.status===0&&this.isHttp){g.onError?.(_.status);return}const c=_.status||n;if(!(c===n&&g.expectedStatus===x)&&c!==g.expectedStatus){g.onError?.(_.status);return}const L=V(_);if(c===x){const M=_.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(M);g.onDone({begin:parseInt(m[1],10),chunk:L})}else L?g.onDone({begin:0,chunk:L}):g.onError?.(_.status)}getRequestXhr(h){return this.pendingRequests[h].xhr}isPendingRequest(h){return h in this.pendingRequests}abortRequest(h){const e=this.pendingRequests[h].xhr;delete this.pendingRequests[h],e.abort()}}class s{constructor(h){this._source=h,this._manager=new q(h.url,{httpHeaders:h.httpHeaders,withCredentials:h.withCredentials}),this._rangeChunkSize=h.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(h){const e=this._rangeRequestReaders.indexOf(h);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new t(this._manager,this._source),this._fullRequestReader}getRangeReader(h,e){const g=new i(this._manager,h,e);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(h){this._fullRequestReader?.cancel(h);for(const e of this._rangeRequestReaders.slice(0))e.cancel(h)}}o.PDFNetworkStream=s;class t{constructor(h,e){this._manager=h;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=h.requestFull(g),this._headersReceivedCapability=new u.PromiseCapability,this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const h=this._fullRequestId,e=this._manager.getRequestXhr(h),g=w=>e.getResponseHeader(w),{allowRangeRequests:_,suggestedLength:c}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});_&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(h),this._headersReceivedCapability.resolve()}_onDone(h){if(h&&(this._requests.length>0?this._requests.shift().resolve({value:h.chunk,done:!1}):this._cachedChunks.push(h.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(h){this._storedError=(0,y.createResponseStatusError)(h,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(h){this.onProgress?.({loaded:h.loaded,total:h.lengthComputable?h.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=new u.PromiseCapability;return this._requests.push(h),h.promise}cancel(h){this._done=!0,this._headersReceivedCapability.reject(h);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class i{constructor(h,e,g){this._manager=h;const _={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._requestId=h.requestRange(e,g,_),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(h){const e=h.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(h){this._storedError=(0,y.createResponseStatusError)(h,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(h){this.isStreamingSupported||this.onProgress?.({loaded:h.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const h=new u.PromiseCapability;return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFNodeStream=void 0;var u=I(1),y=I(20);const n=/^file:\/\/\/[a-zA-Z]:\//;function x(g){const _=require$$5,c=_.parse(g);return c.protocol==="file:"||c.host?c:/^[a-z]:[/\\]/i.test(g)?_.parse(`file:///${g}`):(c.host||(c.protocol="file:"),c)}class V{constructor(_){this.source=_,this.url=x(_.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&_.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new h(this):new i(this),this._fullRequestReader}getRangeReader(_,c){if(c<=this._progressiveDataLength)return null;const w=this.isFsUrl?new e(this,_,c):new f(this,_,c);return this._rangeRequestReaders.push(w),w}cancelAllRequests(_){this._fullRequestReader?.cancel(_);for(const c of this._rangeRequestReaders.slice(0))c.cancel(_)}}o.PDFNodeStream=V;class q{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null;const c=_.source;this._contentLength=c.length,this._loaded=0,this._filename=null,this._disableRange=c.disableRange||!1,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!c.disableStream,this._isRangeSupported=!c.disableRange,this._readableStream=null,this._readCapability=new u.PromiseCapability,this._headersCapability=new u.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const _=this._readableStream.read();return _===null?(this._readCapability=new u.PromiseCapability,this.read()):(this._loaded+=_.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(_).buffer,done:!1})}cancel(_){if(!this._readableStream){this._error(_);return}this._readableStream.destroy(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",c=>{this._error(c)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new u.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class s{constructor(_){this._url=_.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new u.PromiseCapability;const c=_.source;this._isStreamingSupported=!c.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const _=this._readableStream.read();return _===null?(this._readCapability=new u.PromiseCapability,this.read()):(this._loaded+=_.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(_).buffer,done:!1})}cancel(_){if(!this._readableStream){this._error(_);return}this._readableStream.destroy(_)}_error(_){this._storedError=_,this._readCapability.resolve()}_setReadableStream(_){this._readableStream=_,_.on("readable",()=>{this._readCapability.resolve()}),_.on("end",()=>{_.destroy(),this._done=!0,this._readCapability.resolve()}),_.on("error",c=>{this._error(c)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function t(g,_){return{protocol:g.protocol,auth:g.auth,host:g.hostname,port:g.port,path:g.path,method:"GET",headers:_}}class i extends q{constructor(_){super(_);const c=w=>{if(w.statusCode===404){const C=new u.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=C,this._headersCapability.reject(C);return}this._headersCapability.resolve(),this._setReadableStream(w);const L=C=>this._readableStream.headers[C.toLowerCase()],{allowRangeRequests:M,suggestedLength:m}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:L,isHttp:_.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=M,this._contentLength=m||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(L)};if(this._request=null,this._url.protocol==="http:"){const w=require$$5;this._request=w.request(t(this._url,_.httpHeaders),c)}else{const w=require$$5;this._request=w.request(t(this._url,_.httpHeaders),c)}this._request.on("error",w=>{this._storedError=w,this._headersCapability.reject(w)}),this._request.end()}}class f extends s{constructor(_,c,w){super(_),this._httpHeaders={};for(const M in _.httpHeaders){const m=_.httpHeaders[M];m!==void 0&&(this._httpHeaders[M]=m)}this._httpHeaders.Range=`bytes=${c}-${w-1}`;const L=M=>{if(M.statusCode===404){const m=new u.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=m;return}this._setReadableStream(M)};if(this._request=null,this._url.protocol==="http:"){const M=require$$5;this._request=M.request(t(this._url,this._httpHeaders),L)}else{const M=require$$5;this._request=M.request(t(this._url,this._httpHeaders),L)}this._request.on("error",M=>{this._storedError=M}),this._request.end()}}class h extends q{constructor(_){super(_);let c=decodeURIComponent(this._url.path);n.test(this._url.href)&&(c=c.replace(/^\//,""));const w=require$$5;w.lstat(c,(L,M)=>{if(L){L.code==="ENOENT"&&(L=new u.MissingPDFException(`Missing PDF "${c}".`)),this._storedError=L,this._headersCapability.reject(L);return}this._contentLength=M.size,this._setReadableStream(w.createReadStream(c)),this._headersCapability.resolve()})}}class e extends s{constructor(_,c,w){super(_);let L=decodeURIComponent(this._url.path);n.test(this._url.href)&&(L=L.replace(/^\//,""));const M=require$$5;this._setReadableStream(M.createReadStream(L,{start:c,end:w-1}))}}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SVGGraphics=void 0;var u=I(6),y=I(1);const n={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},x="http://www.w3.org/XML/1998/namespace",V="http://www.w3.org/1999/xlink",q=["butt","round","square"],s=["miter","round","bevel"],t=function(M,m="",C=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!C)return URL.createObjectURL(new Blob([M],{type:m}));const z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let $=`data:${m};base64,`;for(let j=0,tt=M.length;j<tt;j+=3){const nt=M[j]&255,bt=M[j+1]&255,dt=M[j+2]&255,mt=nt>>2,At=(nt&3)<<4|bt>>4,ot=j+1<tt?(bt&15)<<2|dt>>6:64,N=j+2<tt?dt&63:64;$+=z[mt]+z[At]+z[ot]+z[N]}return $},i=(function(){const M=new Uint8Array([137,80,78,71,13,10,26,10]),m=12,C=new Int32Array(256);for(let dt=0;dt<256;dt++){let mt=dt;for(let At=0;At<8;At++)mt=mt&1?3988292384^mt>>1&2147483647:mt>>1&2147483647;C[dt]=mt}function z(dt,mt,At){let ot=-1;for(let N=mt;N<At;N++){const E=(ot^dt[N])&255,p=C[E];ot=ot>>>8^p}return ot^-1}function $(dt,mt,At,ot){let N=ot;const E=mt.length;At[N]=E>>24&255,At[N+1]=E>>16&255,At[N+2]=E>>8&255,At[N+3]=E&255,N+=4,At[N]=dt.charCodeAt(0)&255,At[N+1]=dt.charCodeAt(1)&255,At[N+2]=dt.charCodeAt(2)&255,At[N+3]=dt.charCodeAt(3)&255,N+=4,At.set(mt,N),N+=mt.length;const p=z(At,ot+4,N);At[N]=p>>24&255,At[N+1]=p>>16&255,At[N+2]=p>>8&255,At[N+3]=p&255}function j(dt,mt,At){let ot=1,N=0;for(let E=mt;E<At;++E)ot=(ot+(dt[E]&255))%65521,N=(N+ot)%65521;return N<<16|ot}function tt(dt){if(!y.isNodeJS)return nt(dt);try{const mt=parseInt(process.versions.node)>=8?dt:Buffer.from(dt),At=require$$5.deflateSync(mt,{level:9});return At instanceof Uint8Array?At:new Uint8Array(At)}catch(mt){(0,y.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+mt)}return nt(dt)}function nt(dt){let mt=dt.length;const At=65535,ot=Math.ceil(mt/At),N=new Uint8Array(2+mt+ot*5+4);let E=0;N[E++]=120,N[E++]=156;let p=0;for(;mt>At;)N[E++]=0,N[E++]=255,N[E++]=255,N[E++]=0,N[E++]=0,N.set(dt.subarray(p,p+At),E),E+=At,p+=At,mt-=At;N[E++]=1,N[E++]=mt&255,N[E++]=mt>>8&255,N[E++]=~mt&65535&255,N[E++]=(~mt&65535)>>8&255,N.set(dt.subarray(p),E),E+=dt.length-p;const r=j(dt,0,dt.length);return N[E++]=r>>24&255,N[E++]=r>>16&255,N[E++]=r>>8&255,N[E++]=r&255,N}function bt(dt,mt,At,ot){const N=dt.width,E=dt.height;let p,r,v;const T=dt.data;switch(mt){case y.ImageKind.GRAYSCALE_1BPP:r=0,p=1,v=N+7>>3;break;case y.ImageKind.RGB_24BPP:r=2,p=8,v=N*3;break;case y.ImageKind.RGBA_32BPP:r=6,p=8,v=N*4;break;default:throw new Error("invalid format")}const P=new Uint8Array((1+v)*E);let D=0,R=0;for(let U=0;U<E;++U)P[D++]=0,P.set(T.subarray(R,R+v),D),R+=v,D+=v;if(mt===y.ImageKind.GRAYSCALE_1BPP&&ot){D=0;for(let U=0;U<E;U++){D++;for(let X=0;X<v;X++)P[D++]^=255}}const a=new Uint8Array([N>>24&255,N>>16&255,N>>8&255,N&255,E>>24&255,E>>16&255,E>>8&255,E&255,p,r,0,0,0]),b=tt(P),A=M.length+m*3+a.length+b.length,k=new Uint8Array(A);let F=0;return k.set(M,F),F+=M.length,$("IHDR",a,k,F),F+=m+a.length,$("IDATA",b,k,F),F+=m+b.length,$("IEND",new Uint8Array(0),k,F),t(k,"image/png",At)}return function(mt,At,ot){const N=mt.kind===void 0?y.ImageKind.GRAYSCALE_1BPP:mt.kind;return bt(mt,N,At,ot)}})();class f{constructor(){this.fontSizeScale=1,this.fontWeight=n.fontWeight,this.fontSize=0,this.textMatrix=y.IDENTITY_MATRIX,this.fontMatrix=y.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=y.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=n.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(m,C){this.x=m,this.y=C}}function h(M){let m=[];const C=[];for(const z of M){if(z.fn==="save"){m.push({fnId:92,fn:"group",items:[]}),C.push(m),m=m.at(-1).items;continue}z.fn==="restore"?m=C.pop():m.push(z)}return m}function e(M){if(Number.isInteger(M))return M.toString();const m=M.toFixed(10);let C=m.length-1;if(m[C]!=="0")return m;do C--;while(m[C]==="0");return m.substring(0,m[C]==="."?C:C+1)}function g(M){if(M[4]===0&&M[5]===0){if(M[1]===0&&M[2]===0)return M[0]===1&&M[3]===1?"":`scale(${e(M[0])} ${e(M[3])})`;if(M[0]===M[3]&&M[1]===-M[2]){const m=Math.acos(M[0])*180/Math.PI;return`rotate(${e(m)})`}}else if(M[0]===1&&M[1]===0&&M[2]===0&&M[3]===1)return`translate(${e(M[4])} ${e(M[5])})`;return`matrix(${e(M[0])} ${e(M[1])} ${e(M[2])} ${e(M[3])} ${e(M[4])} ${e(M[5])})`}let _=0,c=0,w=0;class L{constructor(m,C,z=!1){(0,u.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new u.DOMSVGFactory,this.current=new f,this.transformMatrix=y.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=m,this.objs=C,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!z,this._operatorIdMapping=[];for(const $ in y.OPS)this._operatorIdMapping[y.OPS[$]]=$}getObject(m,C=null){return typeof m=="string"?m.startsWith("g_")?this.commonObjs.get(m):this.objs.get(m):C}save(){this.transformStack.push(this.transformMatrix);const m=this.current;this.extraStack.push(m),this.current=m.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(m){this.save(),this.executeOpTree(m),this.restore()}loadDependencies(m){const C=m.fnArray,z=m.argsArray;for(let $=0,j=C.length;$<j;$++)if(C[$]===y.OPS.dependency)for(const tt of z[$]){const nt=tt.startsWith("g_")?this.commonObjs:this.objs,bt=new Promise(dt=>{nt.get(tt,dt)});this.current.dependencies.push(bt)}return Promise.all(this.current.dependencies)}transform(m,C,z,$,j,tt){const nt=[m,C,z,$,j,tt];this.transformMatrix=y.Util.transform(this.transformMatrix,nt),this.tgrp=null}getSVG(m,C){this.viewport=C;const z=this._initialize(C);return this.loadDependencies(m).then(()=>(this.transformMatrix=y.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(m)),z))}convertOpList(m){const C=this._operatorIdMapping,z=m.argsArray,$=m.fnArray,j=[];for(let tt=0,nt=$.length;tt<nt;tt++){const bt=$[tt];j.push({fnId:bt,fn:C[bt],args:z[tt]})}return h(j)}executeOpTree(m){for(const C of m){const z=C.fn,$=C.fnId,j=C.args;switch($|0){case y.OPS.beginText:this.beginText();break;case y.OPS.dependency:break;case y.OPS.setLeading:this.setLeading(j);break;case y.OPS.setLeadingMoveText:this.setLeadingMoveText(j[0],j[1]);break;case y.OPS.setFont:this.setFont(j);break;case y.OPS.showText:this.showText(j[0]);break;case y.OPS.showSpacedText:this.showText(j[0]);break;case y.OPS.endText:this.endText();break;case y.OPS.moveText:this.moveText(j[0],j[1]);break;case y.OPS.setCharSpacing:this.setCharSpacing(j[0]);break;case y.OPS.setWordSpacing:this.setWordSpacing(j[0]);break;case y.OPS.setHScale:this.setHScale(j[0]);break;case y.OPS.setTextMatrix:this.setTextMatrix(j[0],j[1],j[2],j[3],j[4],j[5]);break;case y.OPS.setTextRise:this.setTextRise(j[0]);break;case y.OPS.setTextRenderingMode:this.setTextRenderingMode(j[0]);break;case y.OPS.setLineWidth:this.setLineWidth(j[0]);break;case y.OPS.setLineJoin:this.setLineJoin(j[0]);break;case y.OPS.setLineCap:this.setLineCap(j[0]);break;case y.OPS.setMiterLimit:this.setMiterLimit(j[0]);break;case y.OPS.setFillRGBColor:this.setFillRGBColor(j[0],j[1],j[2]);break;case y.OPS.setStrokeRGBColor:this.setStrokeRGBColor(j[0],j[1],j[2]);break;case y.OPS.setStrokeColorN:this.setStrokeColorN(j);break;case y.OPS.setFillColorN:this.setFillColorN(j);break;case y.OPS.shadingFill:this.shadingFill(j[0]);break;case y.OPS.setDash:this.setDash(j[0],j[1]);break;case y.OPS.setRenderingIntent:this.setRenderingIntent(j[0]);break;case y.OPS.setFlatness:this.setFlatness(j[0]);break;case y.OPS.setGState:this.setGState(j[0]);break;case y.OPS.fill:this.fill();break;case y.OPS.eoFill:this.eoFill();break;case y.OPS.stroke:this.stroke();break;case y.OPS.fillStroke:this.fillStroke();break;case y.OPS.eoFillStroke:this.eoFillStroke();break;case y.OPS.clip:this.clip("nonzero");break;case y.OPS.eoClip:this.clip("evenodd");break;case y.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case y.OPS.paintImageXObject:this.paintImageXObject(j[0]);break;case y.OPS.paintInlineImageXObject:this.paintInlineImageXObject(j[0]);break;case y.OPS.paintImageMaskXObject:this.paintImageMaskXObject(j[0]);break;case y.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(j[0],j[1]);break;case y.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case y.OPS.closePath:this.closePath();break;case y.OPS.closeStroke:this.closeStroke();break;case y.OPS.closeFillStroke:this.closeFillStroke();break;case y.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case y.OPS.nextLine:this.nextLine();break;case y.OPS.transform:this.transform(j[0],j[1],j[2],j[3],j[4],j[5]);break;case y.OPS.constructPath:this.constructPath(j[0],j[1]);break;case y.OPS.endPath:this.endPath();break;case 92:this.group(C.items);break;default:(0,y.warn)(`Unimplemented operator ${z}`);break}}}setWordSpacing(m){this.current.wordSpacing=m}setCharSpacing(m){this.current.charSpacing=m}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(m,C,z,$,j,tt){const nt=this.current;nt.textMatrix=nt.lineMatrix=[m,C,z,$,j,tt],nt.textMatrixScale=Math.hypot(m,C),nt.x=nt.lineX=0,nt.y=nt.lineY=0,nt.xcoords=[],nt.ycoords=[],nt.tspan=this.svgFactory.createElement("svg:tspan"),nt.tspan.setAttributeNS(null,"font-family",nt.fontFamily),nt.tspan.setAttributeNS(null,"font-size",`${e(nt.fontSize)}px`),nt.tspan.setAttributeNS(null,"y",e(-nt.y)),nt.txtElement=this.svgFactory.createElement("svg:text"),nt.txtElement.append(nt.tspan)}beginText(){const m=this.current;m.x=m.lineX=0,m.y=m.lineY=0,m.textMatrix=y.IDENTITY_MATRIX,m.lineMatrix=y.IDENTITY_MATRIX,m.textMatrixScale=1,m.tspan=this.svgFactory.createElement("svg:tspan"),m.txtElement=this.svgFactory.createElement("svg:text"),m.txtgrp=this.svgFactory.createElement("svg:g"),m.xcoords=[],m.ycoords=[]}moveText(m,C){const z=this.current;z.x=z.lineX+=m,z.y=z.lineY+=C,z.xcoords=[],z.ycoords=[],z.tspan=this.svgFactory.createElement("svg:tspan"),z.tspan.setAttributeNS(null,"font-family",z.fontFamily),z.tspan.setAttributeNS(null,"font-size",`${e(z.fontSize)}px`),z.tspan.setAttributeNS(null,"y",e(-z.y))}showText(m){const C=this.current,z=C.font,$=C.fontSize;if($===0)return;const j=C.fontSizeScale,tt=C.charSpacing,nt=C.wordSpacing,bt=C.fontDirection,dt=C.textHScale*bt,mt=z.vertical,At=mt?1:-1,ot=z.defaultVMetrics,N=$*C.fontMatrix[0];let E=0;for(const v of m){if(v===null){E+=bt*nt;continue}else if(typeof v=="number"){E+=At*v*$/1e3;continue}const T=(v.isSpace?nt:0)+tt,P=v.fontChar;let D,R,a=v.width;if(mt){let A;const k=v.vmetric||ot;A=v.vmetric?k[1]:a*.5,A=-A*N;const F=k[2]*N;a=k?-k[0]:a,D=A/j,R=(E+F)/j}else D=E/j,R=0;(v.isInFont||z.missingFile)&&(C.xcoords.push(C.x+D),mt&&C.ycoords.push(-C.y+R),C.tspan.textContent+=P);const b=mt?a*N-T*bt:a*N+T*bt;E+=b}C.tspan.setAttributeNS(null,"x",C.xcoords.map(e).join(" ")),mt?C.tspan.setAttributeNS(null,"y",C.ycoords.map(e).join(" ")):C.tspan.setAttributeNS(null,"y",e(-C.y)),mt?C.y-=E:C.x+=E*dt,C.tspan.setAttributeNS(null,"font-family",C.fontFamily),C.tspan.setAttributeNS(null,"font-size",`${e(C.fontSize)}px`),C.fontStyle!==n.fontStyle&&C.tspan.setAttributeNS(null,"font-style",C.fontStyle),C.fontWeight!==n.fontWeight&&C.tspan.setAttributeNS(null,"font-weight",C.fontWeight);const p=C.textRenderingMode&y.TextRenderingMode.FILL_STROKE_MASK;if(p===y.TextRenderingMode.FILL||p===y.TextRenderingMode.FILL_STROKE?(C.fillColor!==n.fillColor&&C.tspan.setAttributeNS(null,"fill",C.fillColor),C.fillAlpha<1&&C.tspan.setAttributeNS(null,"fill-opacity",C.fillAlpha)):C.textRenderingMode===y.TextRenderingMode.ADD_TO_PATH?C.tspan.setAttributeNS(null,"fill","transparent"):C.tspan.setAttributeNS(null,"fill","none"),p===y.TextRenderingMode.STROKE||p===y.TextRenderingMode.FILL_STROKE){const v=1/(C.textMatrixScale||1);this._setStrokeAttributes(C.tspan,v)}let r=C.textMatrix;C.textRise!==0&&(r=r.slice(),r[5]+=C.textRise),C.txtElement.setAttributeNS(null,"transform",`${g(r)} scale(${e(dt)}, -1)`),C.txtElement.setAttributeNS(x,"xml:space","preserve"),C.txtElement.append(C.tspan),C.txtgrp.append(C.txtElement),this._ensureTransformGroup().append(C.txtElement)}setLeadingMoveText(m,C){this.setLeading(-C),this.moveText(m,C)}addFontStyle(m){if(!m.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const C=t(m.data,m.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${m.loadedName}"; src: url(${C}); }
`}setFont(m){const C=this.current,z=this.commonObjs.get(m[0]);let $=m[1];C.font=z,this.embedFonts&&!z.missingFile&&!this.embeddedFonts[z.loadedName]&&(this.addFontStyle(z),this.embeddedFonts[z.loadedName]=z),C.fontMatrix=z.fontMatrix||y.FONT_IDENTITY_MATRIX;let j="normal";z.black?j="900":z.bold&&(j="bold");const tt=z.italic?"italic":"normal";$<0?($=-$,C.fontDirection=-1):C.fontDirection=1,C.fontSize=$,C.fontFamily=z.loadedName,C.fontWeight=j,C.fontStyle=tt,C.tspan=this.svgFactory.createElement("svg:tspan"),C.tspan.setAttributeNS(null,"y",e(-C.y)),C.xcoords=[],C.ycoords=[]}endText(){const m=this.current;m.textRenderingMode&y.TextRenderingMode.ADD_TO_PATH_FLAG&&m.txtElement?.hasChildNodes()&&(m.element=m.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(m){m>0&&(this.current.lineWidth=m)}setLineCap(m){this.current.lineCap=q[m]}setLineJoin(m){this.current.lineJoin=s[m]}setMiterLimit(m){this.current.miterLimit=m}setStrokeAlpha(m){this.current.strokeAlpha=m}setStrokeRGBColor(m,C,z){this.current.strokeColor=y.Util.makeHexColor(m,C,z)}setFillAlpha(m){this.current.fillAlpha=m}setFillRGBColor(m,C,z){this.current.fillColor=y.Util.makeHexColor(m,C,z),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(m){this.current.strokeColor=this._makeColorN_Pattern(m)}setFillColorN(m){this.current.fillColor=this._makeColorN_Pattern(m)}shadingFill(m){const{width:C,height:z}=this.viewport,$=y.Util.inverseTransform(this.transformMatrix),[j,tt,nt,bt]=y.Util.getAxialAlignedBoundingBox([0,0,C,z],$),dt=this.svgFactory.createElement("svg:rect");dt.setAttributeNS(null,"x",j),dt.setAttributeNS(null,"y",tt),dt.setAttributeNS(null,"width",nt-j),dt.setAttributeNS(null,"height",bt-tt),dt.setAttributeNS(null,"fill",this._makeShadingPattern(m)),this.current.fillAlpha<1&&dt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(dt)}_makeColorN_Pattern(m){return m[0]==="TilingPattern"?this._makeTilingPattern(m):this._makeShadingPattern(m)}_makeTilingPattern(m){const C=m[1],z=m[2],$=m[3]||y.IDENTITY_MATRIX,[j,tt,nt,bt]=m[4],dt=m[5],mt=m[6],At=m[7],ot=`shading${w++}`,[N,E,p,r]=y.Util.normalizeRect([...y.Util.applyTransform([j,tt],$),...y.Util.applyTransform([nt,bt],$)]),[v,T]=y.Util.singularValueDecompose2dScale($),P=dt*v,D=mt*T,R=this.svgFactory.createElement("svg:pattern");R.setAttributeNS(null,"id",ot),R.setAttributeNS(null,"patternUnits","userSpaceOnUse"),R.setAttributeNS(null,"width",P),R.setAttributeNS(null,"height",D),R.setAttributeNS(null,"x",`${N}`),R.setAttributeNS(null,"y",`${E}`);const a=this.svg,b=this.transformMatrix,A=this.current.fillColor,k=this.current.strokeColor,F=this.svgFactory.create(p-N,r-E);if(this.svg=F,this.transformMatrix=$,At===2){const U=y.Util.makeHexColor(...C);this.current.fillColor=U,this.current.strokeColor=U}return this.executeOpTree(this.convertOpList(z)),this.svg=a,this.transformMatrix=b,this.current.fillColor=A,this.current.strokeColor=k,R.append(F.childNodes[0]),this.defs.append(R),`url(#${ot})`}_makeShadingPattern(m){switch(typeof m=="string"&&(m=this.objs.get(m)),m[0]){case"RadialAxial":const C=`shading${w++}`,z=m[3];let $;switch(m[1]){case"axial":const j=m[4],tt=m[5];$=this.svgFactory.createElement("svg:linearGradient"),$.setAttributeNS(null,"id",C),$.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),$.setAttributeNS(null,"x1",j[0]),$.setAttributeNS(null,"y1",j[1]),$.setAttributeNS(null,"x2",tt[0]),$.setAttributeNS(null,"y2",tt[1]);break;case"radial":const nt=m[4],bt=m[5],dt=m[6],mt=m[7];$=this.svgFactory.createElement("svg:radialGradient"),$.setAttributeNS(null,"id",C),$.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),$.setAttributeNS(null,"cx",bt[0]),$.setAttributeNS(null,"cy",bt[1]),$.setAttributeNS(null,"r",mt),$.setAttributeNS(null,"fx",nt[0]),$.setAttributeNS(null,"fy",nt[1]),$.setAttributeNS(null,"fr",dt);break;default:throw new Error(`Unknown RadialAxial type: ${m[1]}`)}for(const j of z){const tt=this.svgFactory.createElement("svg:stop");tt.setAttributeNS(null,"offset",j[0]),tt.setAttributeNS(null,"stop-color",j[1]),$.append(tt)}return this.defs.append($),`url(#${C})`;case"Mesh":return(0,y.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${m[0]}`)}}setDash(m,C){this.current.dashArray=m,this.current.dashPhase=C}constructPath(m,C){const z=this.current;let $=z.x,j=z.y,tt=[],nt=0;for(const bt of m)switch(bt|0){case y.OPS.rectangle:$=C[nt++],j=C[nt++];const dt=C[nt++],mt=C[nt++],At=$+dt,ot=j+mt;tt.push("M",e($),e(j),"L",e(At),e(j),"L",e(At),e(ot),"L",e($),e(ot),"Z");break;case y.OPS.moveTo:$=C[nt++],j=C[nt++],tt.push("M",e($),e(j));break;case y.OPS.lineTo:$=C[nt++],j=C[nt++],tt.push("L",e($),e(j));break;case y.OPS.curveTo:$=C[nt+4],j=C[nt+5],tt.push("C",e(C[nt]),e(C[nt+1]),e(C[nt+2]),e(C[nt+3]),e($),e(j)),nt+=6;break;case y.OPS.curveTo2:tt.push("C",e($),e(j),e(C[nt]),e(C[nt+1]),e(C[nt+2]),e(C[nt+3])),$=C[nt+2],j=C[nt+3],nt+=4;break;case y.OPS.curveTo3:$=C[nt+2],j=C[nt+3],tt.push("C",e(C[nt]),e(C[nt+1]),e($),e(j),e($),e(j)),nt+=4;break;case y.OPS.closePath:tt.push("Z");break}tt=tt.join(" "),z.path&&m.length>0&&m[0]!==y.OPS.rectangle&&m[0]!==y.OPS.moveTo?tt=z.path.getAttributeNS(null,"d")+tt:(z.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(z.path)),z.path.setAttributeNS(null,"d",tt),z.path.setAttributeNS(null,"fill","none"),z.element=z.path,z.setCurrentPoint($,j)}endPath(){const m=this.current;if(m.path=null,!this.pendingClip)return;if(!m.element){this.pendingClip=null;return}const C=`clippath${_++}`,z=this.svgFactory.createElement("svg:clipPath");z.setAttributeNS(null,"id",C),z.setAttributeNS(null,"transform",g(this.transformMatrix));const $=m.element.cloneNode(!0);if(this.pendingClip==="evenodd"?$.setAttributeNS(null,"clip-rule","evenodd"):$.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,z.append($),this.defs.append(z),m.activeClipUrl){m.clipGroup=null;for(const j of this.extraStack)j.clipGroup=null;z.setAttributeNS(null,"clip-path",m.activeClipUrl)}m.activeClipUrl=`url(#${C})`,this.tgrp=null}clip(m){this.pendingClip=m}closePath(){const m=this.current;if(m.path){const C=`${m.path.getAttributeNS(null,"d")}Z`;m.path.setAttributeNS(null,"d",C)}}setLeading(m){this.current.leading=-m}setTextRise(m){this.current.textRise=m}setTextRenderingMode(m){this.current.textRenderingMode=m}setHScale(m){this.current.textHScale=m/100}setRenderingIntent(m){}setFlatness(m){}setGState(m){for(const[C,z]of m)switch(C){case"LW":this.setLineWidth(z);break;case"LC":this.setLineCap(z);break;case"LJ":this.setLineJoin(z);break;case"ML":this.setMiterLimit(z);break;case"D":this.setDash(z[0],z[1]);break;case"RI":this.setRenderingIntent(z);break;case"FL":this.setFlatness(z);break;case"Font":this.setFont(z);break;case"CA":this.setStrokeAlpha(z);break;case"ca":this.setFillAlpha(z);break;default:(0,y.warn)(`Unimplemented graphic state operator ${C}`);break}}fill(){const m=this.current;m.element&&(m.element.setAttributeNS(null,"fill",m.fillColor),m.element.setAttributeNS(null,"fill-opacity",m.fillAlpha),this.endPath())}stroke(){const m=this.current;m.element&&(this._setStrokeAttributes(m.element),m.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(m,C=1){const z=this.current;let $=z.dashArray;C!==1&&$.length>0&&($=$.map(function(j){return C*j})),m.setAttributeNS(null,"stroke",z.strokeColor),m.setAttributeNS(null,"stroke-opacity",z.strokeAlpha),m.setAttributeNS(null,"stroke-miterlimit",e(z.miterLimit)),m.setAttributeNS(null,"stroke-linecap",z.lineCap),m.setAttributeNS(null,"stroke-linejoin",z.lineJoin),m.setAttributeNS(null,"stroke-width",e(C*z.lineWidth)+"px"),m.setAttributeNS(null,"stroke-dasharray",$.map(e).join(" ")),m.setAttributeNS(null,"stroke-dashoffset",e(C*z.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const m=this.svgFactory.createElement("svg:rect");m.setAttributeNS(null,"x","0"),m.setAttributeNS(null,"y","0"),m.setAttributeNS(null,"width","1px"),m.setAttributeNS(null,"height","1px"),m.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(m)}paintImageXObject(m){const C=this.getObject(m);if(!C){(0,y.warn)(`Dependent image with object ID ${m} is not ready yet`);return}this.paintInlineImageXObject(C)}paintInlineImageXObject(m,C){const z=m.width,$=m.height,j=i(m,this.forceDataSchema,!!C),tt=this.svgFactory.createElement("svg:rect");tt.setAttributeNS(null,"x","0"),tt.setAttributeNS(null,"y","0"),tt.setAttributeNS(null,"width",e(z)),tt.setAttributeNS(null,"height",e($)),this.current.element=tt,this.clip("nonzero");const nt=this.svgFactory.createElement("svg:image");nt.setAttributeNS(V,"xlink:href",j),nt.setAttributeNS(null,"x","0"),nt.setAttributeNS(null,"y",e(-$)),nt.setAttributeNS(null,"width",e(z)+"px"),nt.setAttributeNS(null,"height",e($)+"px"),nt.setAttributeNS(null,"transform",`scale(${e(1/z)} ${e(-1/$)})`),C?C.append(nt):this._ensureTransformGroup().append(nt)}paintImageMaskXObject(m){const C=this.getObject(m.data,m);if(C.bitmap){(0,y.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const z=this.current,$=C.width,j=C.height,tt=z.fillColor;z.maskId=`mask${c++}`;const nt=this.svgFactory.createElement("svg:mask");nt.setAttributeNS(null,"id",z.maskId);const bt=this.svgFactory.createElement("svg:rect");bt.setAttributeNS(null,"x","0"),bt.setAttributeNS(null,"y","0"),bt.setAttributeNS(null,"width",e($)),bt.setAttributeNS(null,"height",e(j)),bt.setAttributeNS(null,"fill",tt),bt.setAttributeNS(null,"mask",`url(#${z.maskId})`),this.defs.append(nt),this._ensureTransformGroup().append(bt),this.paintInlineImageXObject(C,nt)}paintFormXObjectBegin(m,C){if(Array.isArray(m)&&m.length===6&&this.transform(m[0],m[1],m[2],m[3],m[4],m[5]),C){const z=C[2]-C[0],$=C[3]-C[1],j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x",C[0]),j.setAttributeNS(null,"y",C[1]),j.setAttributeNS(null,"width",e(z)),j.setAttributeNS(null,"height",e($)),this.current.element=j,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(m){const C=this.svgFactory.create(m.width,m.height),z=this.svgFactory.createElement("svg:defs");C.append(z),this.defs=z;const $=this.svgFactory.createElement("svg:g");return $.setAttributeNS(null,"transform",g(m.transform)),C.append($),this.svg=$,C}_ensureClipGroup(){if(!this.current.clipGroup){const m=this.svgFactory.createElement("svg:g");m.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(m),this.current.clipGroup=m}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",g(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}o.SVGGraphics=L}),((d,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.XfaText=void 0;class I{static textContent(y){const n=[],x={items:n,styles:Object.create(null)};function V(q){if(!q)return;let s=null;const t=q.name;if(t==="#text")s=q.value;else if(I.shouldBuildText(t))q?.attributes?.textContent?s=q.attributes.textContent:q.value&&(s=q.value);else return;if(s!==null&&n.push({str:s}),!!q.children)for(const i of q.children)V(i)}return V(y),x}static shouldBuildText(y){return!(y==="textarea"||y==="input"||y==="option"||y==="select")}}o.XfaText=I}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TextLayerRenderTask=void 0,o.renderTextLayer=g,o.updateTextLayer=_;var u=I(1),y=I(6);const n=1e5,x=30,V=.8,q=new Map;function s(c,w){let L;if(w&&u.FeatureTest.isOffscreenCanvasSupported)L=new OffscreenCanvas(c,c).getContext("2d",{alpha:!1});else{const M=document.createElement("canvas");M.width=M.height=c,L=M.getContext("2d",{alpha:!1})}return L}function t(c,w){const L=q.get(c);if(L)return L;const M=s(x,w);M.font=`${x}px ${c}`;const m=M.measureText("");let C=m.fontBoundingBoxAscent,z=Math.abs(m.fontBoundingBoxDescent);if(C){const j=C/(C+z);return q.set(c,j),M.canvas.width=M.canvas.height=0,j}M.strokeStyle="red",M.clearRect(0,0,x,x),M.strokeText("g",0,0);let $=M.getImageData(0,0,x,x).data;z=0;for(let j=$.length-1-3;j>=0;j-=4)if($[j]>0){z=Math.ceil(j/4/x);break}M.clearRect(0,0,x,x),M.strokeText("A",0,x),$=M.getImageData(0,0,x,x).data,C=0;for(let j=0,tt=$.length;j<tt;j+=4)if($[j]>0){C=x-Math.floor(j/4/x);break}if(M.canvas.width=M.canvas.height=0,C){const j=C/(C+z);return q.set(c,j),j}return q.set(c,V),V}function i(c,w,L){const M=document.createElement("span"),m={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};c._textDivs.push(M);const C=u.Util.transform(c._transform,w.transform);let z=Math.atan2(C[1],C[0]);const $=L[w.fontName];$.vertical&&(z+=Math.PI/2);const j=Math.hypot(C[2],C[3]),tt=j*t($.fontFamily,c._isOffscreenCanvasSupported);let nt,bt;z===0?(nt=C[4],bt=C[5]-tt):(nt=C[4]+tt*Math.sin(z),bt=C[5]-tt*Math.cos(z));const dt="calc(var(--scale-factor)*",mt=M.style;c._container===c._rootContainer?(mt.left=`${(100*nt/c._pageWidth).toFixed(2)}%`,mt.top=`${(100*bt/c._pageHeight).toFixed(2)}%`):(mt.left=`${dt}${nt.toFixed(2)}px)`,mt.top=`${dt}${bt.toFixed(2)}px)`),mt.fontSize=`${dt}${j.toFixed(2)}px)`,mt.fontFamily=$.fontFamily,m.fontSize=j,M.setAttribute("role","presentation"),M.textContent=w.str,M.dir=w.dir,c._fontInspectorEnabled&&(M.dataset.fontName=w.fontName),z!==0&&(m.angle=z*(180/Math.PI));let At=!1;if(w.str.length>1)At=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const ot=Math.abs(w.transform[0]),N=Math.abs(w.transform[3]);ot!==N&&Math.max(ot,N)/Math.min(ot,N)>1.5&&(At=!0)}At&&(m.canvasWidth=$.vertical?w.height:w.width),c._textDivProperties.set(M,m),c._isReadableStream&&c._layoutText(M)}function f(c){const{div:w,scale:L,properties:M,ctx:m,prevFontSize:C,prevFontFamily:z}=c,{style:$}=w;let j="";if(M.canvasWidth!==0&&M.hasText){const{fontFamily:tt}=$,{canvasWidth:nt,fontSize:bt}=M;(C!==bt||z!==tt)&&(m.font=`${bt*L}px ${tt}`,c.prevFontSize=bt,c.prevFontFamily=tt);const{width:dt}=m.measureText(w.textContent);dt>0&&(j=`scaleX(${nt*L/dt})`)}M.angle!==0&&(j=`rotate(${M.angle}deg) ${j}`),j.length>0&&($.transform=j)}function h(c){if(c._canceled)return;const w=c._textDivs,L=c._capability;if(w.length>n){L.resolve();return}if(!c._isReadableStream)for(const m of w)c._layoutText(m);L.resolve()}class e{constructor({textContentSource:w,container:L,viewport:M,textDivs:m,textDivProperties:C,textContentItemsStr:z,isOffscreenCanvasSupported:$}){this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=L,this._textDivs=m||[],this._textContentItemsStr=z||[],this._isOffscreenCanvasSupported=$,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=C||new WeakMap,this._canceled=!1,this._capability=new u.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:M.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:s(0,$)};const{pageWidth:j,pageHeight:tt,pageX:nt,pageY:bt}=M.rawDims;this._transform=[1,0,0,-1,-nt,bt+tt],this._pageWidth=j,this._pageHeight=tt,(0,y.setLayerDimensions)(L,M),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new u.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new u.AbortException("TextLayer task cancelled."))}_processItems(w,L){for(const M of w){if(M.str===void 0){if(M.type==="beginMarkedContentProps"||M.type==="beginMarkedContent"){const m=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),M.id!==null&&this._container.setAttribute("id",`${M.id}`),m.append(this._container)}else M.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(M.str),i(this,M,L)}}_layoutText(w){const L=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,f(this._layoutTextParams),L.hasText&&this._container.append(w),L.hasEOL){const M=document.createElement("br");M.setAttribute("role","presentation"),this._container.append(M)}}_render(){const w=new u.PromiseCapability;let L=Object.create(null);if(this._isReadableStream){const M=()=>{this._reader.read().then(({value:m,done:C})=>{if(C){w.resolve();return}Object.assign(L,m.styles),this._processItems(m.items,L),M()},w.reject)};this._reader=this._textContentSource.getReader(),M()}else if(this._textContentSource){const{items:M,styles:m}=this._textContentSource;this._processItems(M,m),w.resolve()}else throw new Error('No "textContentSource" parameter specified.');w.promise.then(()=>{L=null,h(this)},this._capability.reject)}}o.TextLayerRenderTask=e;function g(c){!c.textContentSource&&(c.textContent||c.textContentStream)&&((0,y.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),c.textContentSource=c.textContent||c.textContentStream);const{container:w,viewport:L}=c,M=getComputedStyle(w),m=M.getPropertyValue("visibility"),C=parseFloat(M.getPropertyValue("--scale-factor"));m==="visible"&&(!C||Math.abs(C-L.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const z=new e(c);return z._render(),z}function _({container:c,viewport:w,textDivs:L,textDivProperties:M,isOffscreenCanvasSupported:m,mustRotate:C=!0,mustRescale:z=!0}){if(C&&(0,y.setLayerDimensions)(c,{rotation:w.rotation}),z){const $=s(0,m),tt={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:$};for(const nt of L)tt.properties=M.get(nt),tt.div=nt,f(tt)}}}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationEditorLayer=void 0;var u=I(1),y=I(4),n=I(28),x=I(33),V=I(6),q=I(34);class s{#t;#e=!1;#n=null;#i=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#a=new Map;#s=!1;#l=!1;#c=!1;#r;static _initialized=!1;constructor({uiManager:i,pageIndex:f,div:h,accessibilityManager:e,annotationLayer:g,viewport:_,l10n:c}){const w=[n.FreeTextEditor,x.InkEditor,q.StampEditor];if(!s._initialized){s._initialized=!0;for(const L of w)L.initialize(c)}i.registerEditorTypes(w),this.#r=i,this.pageIndex=f,this.div=h,this.#t=e,this.#n=g,this.viewport=_,this.#r.addLayer(this)}get isEmpty(){return this.#a.size===0}updateToolbar(i){this.#r.updateToolbar(i)}updateMode(i=this.#r.getMode()){this.#p(),i===u.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),i!==u.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",i===u.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",i===u.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",i===u.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(i){if(!i&&this.#r.getMode()!==u.AnnotationEditorType.INK)return;if(!i){for(const h of this.#a.values())if(h.isEmpty()){h.setInBackground();return}}this.#h({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(i){this.#r.setEditingState(i)}addCommands(i){this.#r.addCommands(i)}enable(){this.div.style.pointerEvents="auto";const i=new Set;for(const h of this.#a.values())h.enableEditing(),h.annotationElementId&&i.add(h.annotationElementId);if(!this.#n)return;const f=this.#n.getEditableAnnotations();for(const h of f){if(h.hide(),this.#r.isDeletedAnnotationElement(h.data.id)||i.has(h.data.id))continue;const e=this.deserialize(h);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";const i=new Set;for(const f of this.#a.values()){if(f.disableEditing(),!f.annotationElementId||f.serialize()!==null){i.add(f.annotationElementId);continue}this.getEditableAnnotation(f.annotationElementId)?.show(),f.remove()}if(this.#n){const f=this.#n.getEditableAnnotations();for(const h of f){const{id:e}=h.data;i.has(e)||this.#r.isDeletedAnnotationElement(e)||h.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(i){return this.#n?.getEditableAnnotation(i)||null}setActiveEditor(i){this.#r.getActive()!==i&&this.#r.setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#i)}attach(i){this.#a.set(i.id,i);const{annotationElementId:f}=i;f&&this.#r.isDeletedAnnotationElement(f)&&this.#r.removeDeletedAnnotationElement(i)}detach(i){this.#a.delete(i.id),this.#t?.removePointerInTextLayer(i.contentDiv),!this.#c&&i.annotationElementId&&this.#r.addDeletedAnnotationElement(i)}remove(i){this.detach(i),this.#r.removeEditor(i),i.div.contains(document.activeElement)&&setTimeout(()=>{this.#r.focusMainContainer()},0),i.div.remove(),i.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(i){i.parent!==this&&(i.annotationElementId&&(this.#r.addDeletedAnnotationElement(i.annotationElementId),y.AnnotationEditor.deleteAnnotationElement(i),i.annotationElementId=null),this.attach(i),i.parent?.detach(i),i.setParent(this),i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))}add(i){if(this.changeParent(i),this.#r.addEditor(i),this.attach(i),!i.isAttachedToDOM){const f=i.render();this.div.append(f),i.isAttachedToDOM=!0}i.fixAndSetPosition(),i.onceAdded(),this.#r.addToAnnotationStorage(i)}moveEditorInDOM(i){if(!i.isAttachedToDOM)return;const{activeElement:f}=document;i.div.contains(f)&&(i._focusEventsAllowed=!1,setTimeout(()=>{i.div.contains(document.activeElement)?i._focusEventsAllowed=!0:(i.div.addEventListener("focusin",()=>{i._focusEventsAllowed=!0},{once:!0}),f.focus())},0)),i._structTreeParentId=this.#t?.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addUndoableEditor(i){const f=()=>i._uiManager.rebuild(i),h=()=>{i.remove()};this.addCommands({cmd:f,undo:h,mustExec:!1})}getNextId(){return this.#r.getId()}#f(i){switch(this.#r.getMode()){case u.AnnotationEditorType.FREETEXT:return new n.FreeTextEditor(i);case u.AnnotationEditorType.INK:return new x.InkEditor(i);case u.AnnotationEditorType.STAMP:return new q.StampEditor(i)}return null}pasteEditor(i,f){this.#r.updateToolbar(i),this.#r.updateMode(i);const{offsetX:h,offsetY:e}=this.#d(),g=this.getNextId(),_=this.#f({parent:this,id:g,x:h,y:e,uiManager:this.#r,isCentered:!0,...f});_&&this.add(_)}deserialize(i){switch(i.annotationType??i.annotationEditorType){case u.AnnotationEditorType.FREETEXT:return n.FreeTextEditor.deserialize(i,this,this.#r);case u.AnnotationEditorType.INK:return x.InkEditor.deserialize(i,this,this.#r);case u.AnnotationEditorType.STAMP:return q.StampEditor.deserialize(i,this,this.#r)}return null}#h(i,f){const h=this.getNextId(),e=this.#f({parent:this,id:h,x:i.offsetX,y:i.offsetY,uiManager:this.#r,isCentered:f});return e&&this.add(e),e}#d(){const{x:i,y:f,width:h,height:e}=this.div.getBoundingClientRect(),g=Math.max(0,i),_=Math.max(0,f),c=Math.min(window.innerWidth,i+h),w=Math.min(window.innerHeight,f+e),L=(g+c)/2-i,M=(_+w)/2-f,[m,C]=this.viewport.rotation%180===0?[L,M]:[M,L];return{offsetX:m,offsetY:C}}addNewEditor(){this.#h(this.#d(),!0)}setSelected(i){this.#r.setSelected(i)}toggleSelected(i){this.#r.toggleSelected(i)}isSelected(i){return this.#r.isSelected(i)}unselect(i){this.#r.unselect(i)}pointerup(i){const{isMac:f}=u.FeatureTest.platform;if(!(i.button!==0||i.ctrlKey&&f)&&i.target===this.div&&this.#s){if(this.#s=!1,!this.#e){this.#e=!0;return}if(this.#r.getMode()===u.AnnotationEditorType.STAMP){this.#r.unselectAll();return}this.#h(i,!1)}}pointerdown(i){if(this.#s){this.#s=!1;return}const{isMac:f}=u.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&f||i.target!==this.div)return;this.#s=!0;const h=this.#r.getActive();this.#e=!h||h.isEmpty()}findNewParent(i,f,h){const e=this.#r.findParent(f,h);return e===null||e===this?!1:(e.changeParent(i),!0)}destroy(){this.#r.getActive()?.parent===this&&(this.#r.commitOrRemove(),this.#r.setActiveEditor(null));for(const i of this.#a.values())this.#t?.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,this.#a.clear(),this.#r.removeLayer(this)}#p(){this.#l=!0;for(const i of this.#a.values())i.isEmpty()&&i.remove();this.#l=!1}render({viewport:i}){this.viewport=i,(0,V.setLayerDimensions)(this.div,i);for(const f of this.#r.getEditors(this.pageIndex))this.add(f);this.updateMode()}update({viewport:i}){this.#r.commitOrRemove(),this.viewport=i,(0,V.setLayerDimensions)(this.div,{rotation:i.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:i,pageHeight:f}=this.viewport.rawDims;return[i,f]}}o.AnnotationEditorLayer=s}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FreeTextEditor=void 0;var u=I(1),y=I(5),n=I(4),x=I(29);class V extends n.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#i=this.editorDivKeydown.bind(this);#o;#a="";#s=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const s=V.prototype,t=h=>h.isEmpty(),i=y.AnnotationEditorUIManager.TRANSLATE_SMALL,f=y.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,u.shadow)(this,"_keyboardManager",new y.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],s.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],s._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s._translateEmpty,{args:[-f,0],checker:t}],[["ArrowRight","mac+ArrowRight"],s._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s._translateEmpty,{args:[f,0],checker:t}],[["ArrowUp","mac+ArrowUp"],s._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s._translateEmpty,{args:[0,-f],checker:t}],[["ArrowDown","mac+ArrowDown"],s._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s._translateEmpty,{args:[0,f],checker:t}]]))}static _type="freetext";constructor(s){super({...s,name:"freeTextEditor"}),this.#o=s.color||V._defaultColor||n.AnnotationEditor._defaultLineColor,this.#l=s.fontSize||V._defaultFontSize}static initialize(s){n.AnnotationEditor.initialize(s,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(s,t){switch(s){case u.AnnotationEditorParamsType.FREETEXT_SIZE:V._defaultFontSize=t;break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:V._defaultColor=t;break}}updateParams(s,t){switch(s){case u.AnnotationEditorParamsType.FREETEXT_SIZE:this.#r(t);break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:this.#f(t);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,V._defaultFontSize],[u.AnnotationEditorParamsType.FREETEXT_COLOR,V._defaultColor||n.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[u.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#r(s){const t=f=>{this.editorDiv.style.fontSize=`calc(${f}px * var(--scale-factor))`,this.translate(0,-(f-this.#l)*this.parentScale),this.#l=f,this.#d()},i=this.#l;this.addCommands({cmd:()=>{t(s)},undo:()=>{t(i)},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#f(s){const t=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=s},undo:()=>{this.#o=this.editorDiv.style.color=t},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(s,t){this._uiManager.translateSelectedEditors(s,t,!0)}getInitialTranslation(){const s=this.parentScale;return[-V._internalPadding*s,-(V._internalPadding+this.#l)*s]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(u.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#i),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#n))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#i),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#n),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(s){this._focusEventsAllowed&&(super.focusin(s),s.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#h(){const s=this.editorDiv.getElementsByTagName("div");if(s.length===0)return this.editorDiv.innerText;const t=[];for(const i of s)t.push(i.innerText.replace(/\r\n?|\n/,""));return t.join(`
`)}#d(){const[s,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:f,div:h}=this,e=h.style.display;h.style.display="hidden",f.div.append(this.div),i=h.getBoundingClientRect(),h.remove(),h.style.display=e}this.rotation%180===this.parentRotation%180?(this.width=i.width/s,this.height=i.height/t):(this.width=i.height/s,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const s=this.#a,t=this.#a=this.#h().trimEnd();if(s===t)return;const i=f=>{if(this.#a=f,!f){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#d()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(s)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(s){this.enterInEditMode()}keydown(s){s.target===this.div&&s.key==="Enter"&&(this.enterInEditMode(),s.preventDefault())}editorDivKeydown(s){V._keyboardManager.exec(this,s)}editorDivFocus(s){this.isEditing=!0}editorDivBlur(s){this.isEditing=!1}editorDivInput(s){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let s,t;this.width&&(s=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.enableEditing(),n.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(f=>this.editorDiv?.setAttribute("aria-label",f)),n.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(f=>this.editorDiv?.setAttribute("default-content",f)),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#l}px * var(--scale-factor))`,i.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,y.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[f,h]=this.parentDimensions;if(this.annotationElementId){const{position:e}=this.#c;let[g,_]=this.getInitialTranslation();[g,_]=this.pageTranslationToScreen(g,_);const[c,w]=this.pageDimensions,[L,M]=this.pageTranslation;let m,C;switch(this.rotation){case 0:m=s+(e[0]-L)/c,C=t+this.height-(e[1]-M)/w;break;case 90:m=s+(e[0]-L)/c,C=t-(e[1]-M)/w,[g,_]=[_,-g];break;case 180:m=s-this.width+(e[0]-L)/c,C=t-(e[1]-M)/w,[g,_]=[-g,-_];break;case 270:m=s+(e[0]-L-this.height*w)/c,C=t+(e[1]-M-this.width*c)/w,[g,_]=[-_,g];break}this.setAt(m*f,C*h,g,_)}else this.setAt(s*f,t*h,this.width*f,this.height*h);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#a)for(const s of this.#a.split(`
`)){const t=document.createElement("div");t.append(s?document.createTextNode(s):document.createElement("br")),this.editorDiv.append(t)}}get contentDiv(){return this.editorDiv}static deserialize(s,t,i){let f=null;if(s instanceof x.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:e,fontColor:g},rect:_,rotation:c,id:w},textContent:L,textPosition:M,parent:{page:{pageNumber:m}}}=s;if(!L||L.length===0)return null;f=s={annotationType:u.AnnotationEditorType.FREETEXT,color:Array.from(g),fontSize:e,value:L.join(`
`),position:M,pageIndex:m-1,rect:_,rotation:c,id:w,deleted:!1}}const h=super.deserialize(s,t,i);return h.#l=s.fontSize,h.#o=u.Util.makeHexColor(...s.color),h.#a=s.value,h.annotationElementId=s.id||null,h.#c=f,h}serialize(s=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=V._internalPadding*this.parentScale,i=this.getRect(t,t),f=n.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),h={annotationType:u.AnnotationEditorType.FREETEXT,color:f,fontSize:this.#l,value:this.#a,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return s?h:this.annotationElementId&&!this.#v(h)?null:(h.id=this.annotationElementId,h)}#v(s){const{value:t,fontSize:i,color:f,rect:h,pageIndex:e}=this.#c;return s.value!==t||s.fontSize!==i||s.rect.some((g,_)=>Math.abs(g-h[_])>=1)||s.color.some((g,_)=>g!==f[_])||s.pageIndex!==e}#m(s=!1){if(!this.annotationElementId)return;if(this.#d(),!s&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}const t=V._internalPadding*this.parentScale;this.#c.rect=this.getRect(t,t)}}o.FreeTextEditor=V}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.StampAnnotationElement=o.InkAnnotationElement=o.FreeTextAnnotationElement=o.AnnotationLayer=void 0;var u=I(1),y=I(6),n=I(3),x=I(30),V=I(31),q=I(32);const s=1e3,t=9,i=new WeakSet;function f(R){return{width:R[2]-R[0],height:R[3]-R[1]}}class h{static create(a){switch(a.data.annotationType){case u.AnnotationType.LINK:return new g(a);case u.AnnotationType.TEXT:return new _(a);case u.AnnotationType.WIDGET:switch(a.data.fieldType){case"Tx":return new w(a);case"Btn":return a.data.radioButton?new m(a):a.data.checkBox?new M(a):new C(a);case"Ch":return new z(a);case"Sig":return new L(a)}return new c(a);case u.AnnotationType.POPUP:return new $(a);case u.AnnotationType.FREETEXT:return new tt(a);case u.AnnotationType.LINE:return new nt(a);case u.AnnotationType.SQUARE:return new bt(a);case u.AnnotationType.CIRCLE:return new dt(a);case u.AnnotationType.POLYLINE:return new mt(a);case u.AnnotationType.CARET:return new ot(a);case u.AnnotationType.INK:return new N(a);case u.AnnotationType.POLYGON:return new At(a);case u.AnnotationType.HIGHLIGHT:return new E(a);case u.AnnotationType.UNDERLINE:return new p(a);case u.AnnotationType.SQUIGGLY:return new r(a);case u.AnnotationType.STRIKEOUT:return new v(a);case u.AnnotationType.STAMP:return new T(a);case u.AnnotationType.FILEATTACHMENT:return new P(a);default:return new e(a)}}}class e{#t=!1;constructor(a,{isRenderable:b=!1,ignoreBorder:A=!1,createQuadrilaterals:k=!1}={}){this.isRenderable=b,this.data=a.data,this.layer=a.layer,this.linkService=a.linkService,this.downloadManager=a.downloadManager,this.imageResourcesPath=a.imageResourcesPath,this.renderForms=a.renderForms,this.svgFactory=a.svgFactory,this.annotationStorage=a.annotationStorage,this.enableScripting=a.enableScripting,this.hasJSActions=a.hasJSActions,this._fieldObjects=a.fieldObjects,this.parent=a.parent,b&&(this.container=this._createContainer(A)),k&&this._createQuadrilaterals()}static _hasPopupData({titleObj:a,contentsObj:b,richText:A}){return!!(a?.str||b?.str||A?.str)}get hasPopupData(){return e._hasPopupData(this.data)}_createContainer(a){const{data:b,parent:{page:A,viewport:k}}=this,F=document.createElement("section");F.setAttribute("data-annotation-id",b.id),this instanceof c||(F.tabIndex=s),F.style.zIndex=this.parent.zIndex++,this.data.popupRef&&F.setAttribute("aria-haspopup","dialog"),b.noRotate&&F.classList.add("norotate");const{pageWidth:U,pageHeight:X,pageX:it,pageY:St}=k.rawDims;if(!b.rect||this instanceof $){const{rotation:gt}=b;return!b.hasOwnCanvas&&gt!==0&&this.setRotation(gt,F),F}const{width:rt,height:st}=f(b.rect),ut=u.Util.normalizeRect([b.rect[0],A.view[3]-b.rect[1]+A.view[1],b.rect[2],A.view[3]-b.rect[3]+A.view[1]]);if(!a&&b.borderStyle.width>0){F.style.borderWidth=`${b.borderStyle.width}px`;const gt=b.borderStyle.horizontalCornerRadius,Ct=b.borderStyle.verticalCornerRadius;if(gt>0||Ct>0){const Bt=`calc(${gt}px * var(--scale-factor)) / calc(${Ct}px * var(--scale-factor))`;F.style.borderRadius=Bt}else if(this instanceof m){const Bt=`calc(${rt}px * var(--scale-factor)) / calc(${st}px * var(--scale-factor))`;F.style.borderRadius=Bt}switch(b.borderStyle.style){case u.AnnotationBorderStyleType.SOLID:F.style.borderStyle="solid";break;case u.AnnotationBorderStyleType.DASHED:F.style.borderStyle="dashed";break;case u.AnnotationBorderStyleType.BEVELED:(0,u.warn)("Unimplemented border style: beveled");break;case u.AnnotationBorderStyleType.INSET:(0,u.warn)("Unimplemented border style: inset");break;case u.AnnotationBorderStyleType.UNDERLINE:F.style.borderBottomStyle="solid";break}const Lt=b.borderColor||null;Lt?(this.#t=!0,F.style.borderColor=u.Util.makeHexColor(Lt[0]|0,Lt[1]|0,Lt[2]|0)):F.style.borderWidth=0}F.style.left=`${100*(ut[0]-it)/U}%`,F.style.top=`${100*(ut[1]-St)/X}%`;const{rotation:ht}=b;return b.hasOwnCanvas||ht===0?(F.style.width=`${100*rt/U}%`,F.style.height=`${100*st/X}%`):this.setRotation(ht,F),F}setRotation(a,b=this.container){if(!this.data.rect)return;const{pageWidth:A,pageHeight:k}=this.parent.viewport.rawDims,{width:F,height:U}=f(this.data.rect);let X,it;a%180===0?(X=100*F/A,it=100*U/k):(X=100*U/A,it=100*F/k),b.style.width=`${X}%`,b.style.height=`${it}%`,b.setAttribute("data-main-rotation",(360-a)%360)}get _commonActions(){const a=(b,A,k)=>{const F=k.detail[b],U=F[0],X=F.slice(1);k.target.style[A]=x.ColorConverters[`${U}_HTML`](X),this.annotationStorage.setValue(this.data.id,{[A]:x.ColorConverters[`${U}_rgb`](X)})};return(0,u.shadow)(this,"_commonActions",{display:b=>{const{display:A}=b.detail,k=A%2===1;this.container.style.visibility=k?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:k,noPrint:A===1||A===2})},print:b=>{this.annotationStorage.setValue(this.data.id,{noPrint:!b.detail.print})},hidden:b=>{const{hidden:A}=b.detail;this.container.style.visibility=A?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:A,noView:A})},focus:b=>{setTimeout(()=>b.target.focus({preventScroll:!1}),0)},userName:b=>{b.target.title=b.detail.userName},readonly:b=>{b.target.disabled=b.detail.readonly},required:b=>{this._setRequired(b.target,b.detail.required)},bgColor:b=>{a("bgColor","backgroundColor",b)},fillColor:b=>{a("fillColor","backgroundColor",b)},fgColor:b=>{a("fgColor","color",b)},textColor:b=>{a("textColor","color",b)},borderColor:b=>{a("borderColor","borderColor",b)},strokeColor:b=>{a("strokeColor","borderColor",b)},rotation:b=>{const A=b.detail.rotation;this.setRotation(A),this.annotationStorage.setValue(this.data.id,{rotation:A})}})}_dispatchEventFromSandbox(a,b){const A=this._commonActions;for(const k of Object.keys(b.detail))(a[k]||A[k])?.(b)}_setDefaultPropertiesFromJS(a){if(!this.enableScripting)return;const b=this.annotationStorage.getRawValue(this.data.id);if(!b)return;const A=this._commonActions;for(const[k,F]of Object.entries(b)){const U=A[k];if(U){const X={detail:{[k]:F},target:a};U(X),delete b[k]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:a}=this.data;if(!a)return;const[b,A,k,F]=this.data.rect;if(a.length===1){const[,{x:Ct,y:Lt},{x:Bt,y:Xt}]=a[0];if(k===Ct&&F===Lt&&b===Bt&&A===Xt)return}const{style:U}=this.container;let X;if(this.#t){const{borderColor:Ct,borderWidth:Lt}=U;U.borderWidth=0,X=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ct}" stroke-width="${Lt}">`],this.container.classList.add("hasBorder")}const it=k-b,St=F-A,{svgFactory:rt}=this,st=rt.createElement("svg");st.classList.add("quadrilateralsContainer"),st.setAttribute("width",0),st.setAttribute("height",0);const ut=rt.createElement("defs");st.append(ut);const ht=rt.createElement("clipPath"),gt=`clippath_${this.data.id}`;ht.setAttribute("id",gt),ht.setAttribute("clipPathUnits","objectBoundingBox"),ut.append(ht);for(const[,{x:Ct,y:Lt},{x:Bt,y:Xt}]of a){const $t=rt.createElement("rect"),ne=(Bt-b)/it,Me=(F-Lt)/St,Ae=(Ct-Bt)/it,je=(Lt-Xt)/St;$t.setAttribute("x",ne),$t.setAttribute("y",Me),$t.setAttribute("width",Ae),$t.setAttribute("height",je),ht.append($t),X?.push(`<rect vector-effect="non-scaling-stroke" x="${ne}" y="${Me}" width="${Ae}" height="${je}"/>`)}this.#t&&(X.push("</g></svg>')"),U.backgroundImage=X.join("")),this.container.append(st),this.container.style.clipPath=`url(#${gt})`}_createPopup(){const{container:a,data:b}=this;a.setAttribute("aria-haspopup","dialog");const A=new $({data:{color:b.color,titleObj:b.titleObj,modificationDate:b.modificationDate,contentsObj:b.contentsObj,richText:b.richText,parentRect:b.rect,borderStyle:0,id:`popup_${b.id}`,rotation:b.rotation},parent:this.parent,elements:[this]});this.parent.div.append(A.render())}render(){(0,u.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(a,b=null){const A=[];if(this._fieldObjects){const k=this._fieldObjects[a];if(k)for(const{page:F,id:U,exportValues:X}of k){if(F===-1||U===b)continue;const it=typeof X=="string"?X:null,St=document.querySelector(`[data-element-id="${U}"]`);if(St&&!i.has(St)){(0,u.warn)(`_getElementsByName - element not allowed: ${U}`);continue}A.push({id:U,exportValue:it,domElement:St})}return A}for(const k of document.getElementsByName(a)){const{exportValue:F}=k,U=k.getAttribute("data-element-id");U!==b&&i.has(k)&&A.push({id:U,exportValue:F,domElement:k})}return A}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const a=this.getElementsToTriggerPopup();if(Array.isArray(a))for(const b of a)b.classList.add("highlightArea");else a.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:a,data:{id:b}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:a,editId:b})})}}class g extends e{constructor(a,b=null){super(a,{isRenderable:!0,ignoreBorder:!!b?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=a.data.isTooltipOnly}render(){const{data:a,linkService:b}=this,A=document.createElement("a");A.setAttribute("data-element-id",a.id);let k=!1;return a.url?(b.addLinkAttributes(A,a.url,a.newWindow),k=!0):a.action?(this._bindNamedAction(A,a.action),k=!0):a.attachment?(this._bindAttachment(A,a.attachment),k=!0):a.setOCGState?(this.#e(A,a.setOCGState),k=!0):a.dest?(this._bindLink(A,a.dest),k=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(A,a),k=!0),a.resetForm?(this._bindResetFormAction(A,a.resetForm),k=!0):this.isTooltipOnly&&!k&&(this._bindLink(A,""),k=!0)),this.container.classList.add("linkAnnotation"),k&&this.container.append(A),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(a,b){a.href=this.linkService.getDestinationHash(b),a.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&this.#t()}_bindNamedAction(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(b),!1),this.#t()}_bindAttachment(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,b.content,b.filename),!1),this.#t()}#e(a,b){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(b),!1),this.#t()}_bindJSAction(a,b){a.href=this.linkService.getAnchorUrl("");const A=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const k of Object.keys(b.actions)){const F=A.get(k);F&&(a[F]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:k}}),!1))}a.onclick||(a.onclick=()=>!1),this.#t()}_bindResetFormAction(a,b){const A=a.onclick;if(A||(a.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,u.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),A||(a.onclick=()=>!1);return}a.onclick=()=>{A?.();const{fields:k,refs:F,include:U}=b,X=[];if(k.length!==0||F.length!==0){const rt=new Set(F);for(const st of k){const ut=this._fieldObjects[st]||[];for(const{id:ht}of ut)rt.add(ht)}for(const st of Object.values(this._fieldObjects))for(const ut of st)rt.has(ut.id)===U&&X.push(ut)}else for(const rt of Object.values(this._fieldObjects))X.push(...rt);const it=this.annotationStorage,St=[];for(const rt of X){const{id:st}=rt;switch(St.push(st),rt.type){case"text":{const ht=rt.defaultValue||"";it.setValue(st,{value:ht});break}case"checkbox":case"radiobutton":{const ht=rt.defaultValue===rt.exportValues;it.setValue(st,{value:ht});break}case"combobox":case"listbox":{const ht=rt.defaultValue||"";it.setValue(st,{value:ht});break}default:continue}const ut=document.querySelector(`[data-element-id="${st}"]`);if(ut){if(!i.has(ut)){(0,u.warn)(`_bindResetFormAction - element not allowed: ${st}`);continue}}else continue;ut.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:St,name:"ResetForm"}}),!1}}}class _ extends e{constructor(a){super(a,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const a=document.createElement("img");return a.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",a.alt="[{{type}} Annotation]",a.dataset.l10nId="text_annotation_type",a.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(a),this.container}}class c extends e{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(a){this.data.hasOwnCanvas&&(a.previousSibling?.nodeName==="CANVAS"&&(a.previousSibling.hidden=!0),a.hidden=!1)}_getKeyModifier(a){const{isWin:b,isMac:A}=u.FeatureTest.platform;return b&&a.ctrlKey||A&&a.metaKey}_setEventListener(a,b,A,k,F){A.includes("mouse")?a.addEventListener(A,U=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:k,value:F(U),shift:U.shiftKey,modifier:this._getKeyModifier(U)}})}):a.addEventListener(A,U=>{if(A==="blur"){if(!b.focused||!U.relatedTarget)return;b.focused=!1}else if(A==="focus"){if(b.focused)return;b.focused=!0}F&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:k,value:F(U)}})})}_setEventListeners(a,b,A,k){for(const[F,U]of A)(U==="Action"||this.data.actions?.[U])&&((U==="Focus"||U==="Blur")&&(b||={focused:!1}),this._setEventListener(a,b,F,U,k),U==="Focus"&&!this.data.actions?.Blur?this._setEventListener(a,b,"blur","Blur",null):U==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(a,b,"focus","Focus",null))}_setBackgroundColor(a){const b=this.data.backgroundColor||null;a.style.backgroundColor=b===null?"transparent":u.Util.makeHexColor(b[0],b[1],b[2])}_setTextStyle(a){const b=["left","center","right"],{fontColor:A}=this.data.defaultAppearanceData,k=this.data.defaultAppearanceData.fontSize||t,F=a.style;let U;const X=2,it=St=>Math.round(10*St)/10;if(this.data.multiLine){const St=Math.abs(this.data.rect[3]-this.data.rect[1]-X),rt=Math.round(St/(u.LINE_FACTOR*k))||1,st=St/rt;U=Math.min(k,it(st/u.LINE_FACTOR))}else{const St=Math.abs(this.data.rect[3]-this.data.rect[1]-X);U=Math.min(k,it(St/u.LINE_FACTOR))}F.fontSize=`calc(${U}px * var(--scale-factor))`,F.color=u.Util.makeHexColor(A[0],A[1],A[2]),this.data.textAlignment!==null&&(F.textAlign=b[this.data.textAlignment])}_setRequired(a,b){b?a.setAttribute("required",!0):a.removeAttribute("required"),a.setAttribute("aria-required",b)}}class w extends c{constructor(a){const b=a.renderForms||!a.data.hasAppearance&&!!a.data.fieldValue;super(a,{isRenderable:b})}setPropertyOnSiblings(a,b,A,k){const F=this.annotationStorage;for(const U of this._getElementsByName(a.name,a.id))U.domElement&&(U.domElement[b]=A),F.setValue(U.id,{[k]:A})}render(){const a=this.annotationStorage,b=this.data.id;this.container.classList.add("textWidgetAnnotation");let A=null;if(this.renderForms){const k=a.getValue(b,{value:this.data.fieldValue});let F=k.value||"";const U=a.getValue(b,{charLimit:this.data.maxLen}).charLimit;U&&F.length>U&&(F=F.slice(0,U));let X=k.formattedValue||this.data.textContent?.join(`
`)||null;X&&this.data.comb&&(X=X.replaceAll(/\s+/g,""));const it={userValue:F,formattedValue:X,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(A=document.createElement("textarea"),A.textContent=X??F,this.data.doNotScroll&&(A.style.overflowY="hidden")):(A=document.createElement("input"),A.type="text",A.setAttribute("value",X??F),this.data.doNotScroll&&(A.style.overflowX="hidden")),this.data.hasOwnCanvas&&(A.hidden=!0),i.add(A),A.setAttribute("data-element-id",b),A.disabled=this.data.readOnly,A.name=this.data.fieldName,A.tabIndex=s,this._setRequired(A,this.data.required),U&&(A.maxLength=U),A.addEventListener("input",rt=>{a.setValue(b,{value:rt.target.value}),this.setPropertyOnSiblings(A,"value",rt.target.value,"value"),it.formattedValue=null}),A.addEventListener("resetform",rt=>{const st=this.data.defaultFieldValue??"";A.value=it.userValue=st,it.formattedValue=null});let St=rt=>{const{formattedValue:st}=it;st!=null&&(rt.target.value=st),rt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){A.addEventListener("focus",st=>{if(it.focused)return;const{target:ut}=st;it.userValue&&(ut.value=it.userValue),it.lastCommittedValue=ut.value,it.commitKey=1,it.focused=!0}),A.addEventListener("updatefromsandbox",st=>{this.showElementAndHideCanvas(st.target);const ut={value(ht){it.userValue=ht.detail.value??"",a.setValue(b,{value:it.userValue.toString()}),ht.target.value=it.userValue},formattedValue(ht){const{formattedValue:gt}=ht.detail;it.formattedValue=gt,gt!=null&&ht.target!==document.activeElement&&(ht.target.value=gt),a.setValue(b,{formattedValue:gt})},selRange(ht){ht.target.setSelectionRange(...ht.detail.selRange)},charLimit:ht=>{const{charLimit:gt}=ht.detail,{target:Ct}=ht;if(gt===0){Ct.removeAttribute("maxLength");return}Ct.setAttribute("maxLength",gt);let Lt=it.userValue;!Lt||Lt.length<=gt||(Lt=Lt.slice(0,gt),Ct.value=it.userValue=Lt,a.setValue(b,{value:Lt}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:Lt,willCommit:!0,commitKey:1,selStart:Ct.selectionStart,selEnd:Ct.selectionEnd}}))}};this._dispatchEventFromSandbox(ut,st)}),A.addEventListener("keydown",st=>{it.commitKey=1;let ut=-1;if(st.key==="Escape"?ut=0:st.key==="Enter"&&!this.data.multiLine?ut=2:st.key==="Tab"&&(it.commitKey=3),ut===-1)return;const{value:ht}=st.target;it.lastCommittedValue!==ht&&(it.lastCommittedValue=ht,it.userValue=ht,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:ht,willCommit:!0,commitKey:ut,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}}))});const rt=St;St=null,A.addEventListener("blur",st=>{if(!it.focused||!st.relatedTarget)return;it.focused=!1;const{value:ut}=st.target;it.userValue=ut,it.lastCommittedValue!==ut&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:ut,willCommit:!0,commitKey:it.commitKey,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}}),rt(st)}),this.data.actions?.Keystroke&&A.addEventListener("beforeinput",st=>{it.lastCommittedValue=null;const{data:ut,target:ht}=st,{value:gt,selectionStart:Ct,selectionEnd:Lt}=ht;let Bt=Ct,Xt=Lt;switch(st.inputType){case"deleteWordBackward":{const $t=gt.substring(0,Ct).match(/\w*[^\w]*$/);$t&&(Bt-=$t[0].length);break}case"deleteWordForward":{const $t=gt.substring(Ct).match(/^[^\w]*\w*/);$t&&(Xt+=$t[0].length);break}case"deleteContentBackward":Ct===Lt&&(Bt-=1);break;case"deleteContentForward":Ct===Lt&&(Xt+=1);break}st.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:gt,change:ut||"",willCommit:!1,selStart:Bt,selEnd:Xt}})}),this._setEventListeners(A,it,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.value)}if(St&&A.addEventListener("blur",St),this.data.comb){const st=(this.data.rect[2]-this.data.rect[0])/U;A.classList.add("comb"),A.style.letterSpacing=`calc(${st}px * var(--scale-factor) - 1ch)`}}else A=document.createElement("div"),A.textContent=this.data.fieldValue,A.style.verticalAlign="middle",A.style.display="table-cell";return this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class L extends c{constructor(a){super(a,{isRenderable:!!a.data.hasOwnCanvas})}}class M extends c{constructor(a){super(a,{isRenderable:a.renderForms})}render(){const a=this.annotationStorage,b=this.data,A=b.id;let k=a.getValue(A,{value:b.exportValue===b.fieldValue}).value;typeof k=="string"&&(k=k!=="Off",a.setValue(A,{value:k})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const F=document.createElement("input");return i.add(F),F.setAttribute("data-element-id",A),F.disabled=b.readOnly,this._setRequired(F,this.data.required),F.type="checkbox",F.name=b.fieldName,k&&F.setAttribute("checked",!0),F.setAttribute("exportValue",b.exportValue),F.tabIndex=s,F.addEventListener("change",U=>{const{name:X,checked:it}=U.target;for(const St of this._getElementsByName(X,A)){const rt=it&&St.exportValue===b.exportValue;St.domElement&&(St.domElement.checked=rt),a.setValue(St.id,{value:rt})}a.setValue(A,{value:it})}),F.addEventListener("resetform",U=>{const X=b.defaultFieldValue||"Off";U.target.checked=X===b.exportValue}),this.enableScripting&&this.hasJSActions&&(F.addEventListener("updatefromsandbox",U=>{const X={value(it){it.target.checked=it.detail.value!=="Off",a.setValue(A,{value:it.target.checked})}};this._dispatchEventFromSandbox(X,U)}),this._setEventListeners(F,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.checked)),this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class m extends c{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const a=this.annotationStorage,b=this.data,A=b.id;let k=a.getValue(A,{value:b.fieldValue===b.buttonValue}).value;typeof k=="string"&&(k=k!==b.buttonValue,a.setValue(A,{value:k}));const F=document.createElement("input");if(i.add(F),F.setAttribute("data-element-id",A),F.disabled=b.readOnly,this._setRequired(F,this.data.required),F.type="radio",F.name=b.fieldName,k&&F.setAttribute("checked",!0),F.tabIndex=s,F.addEventListener("change",U=>{const{name:X,checked:it}=U.target;for(const St of this._getElementsByName(X,A))a.setValue(St.id,{value:!1});a.setValue(A,{value:it})}),F.addEventListener("resetform",U=>{const X=b.defaultFieldValue;U.target.checked=X!=null&&X===b.buttonValue}),this.enableScripting&&this.hasJSActions){const U=b.buttonValue;F.addEventListener("updatefromsandbox",X=>{const it={value:St=>{const rt=U===St.detail.value;for(const st of this._getElementsByName(St.target.name)){const ut=rt&&st.id===A;st.domElement&&(st.domElement.checked=ut),a.setValue(st.id,{value:ut})}}};this._dispatchEventFromSandbox(it,X)}),this._setEventListeners(F,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],X=>X.target.checked)}return this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class C extends g{constructor(a){super(a,{ignoreBorder:a.data.hasAppearance})}render(){const a=super.render();a.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(a.title=this.data.alternativeText);const b=a.lastChild;return this.enableScripting&&this.hasJSActions&&b&&(this._setDefaultPropertiesFromJS(b),b.addEventListener("updatefromsandbox",A=>{this._dispatchEventFromSandbox({},A)})),a}}class z extends c{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const a=this.annotationStorage,b=this.data.id,A=a.getValue(b,{value:this.data.fieldValue}),k=document.createElement("select");i.add(k),k.setAttribute("data-element-id",b),k.disabled=this.data.readOnly,this._setRequired(k,this.data.required),k.name=this.data.fieldName,k.tabIndex=s;let F=this.data.combo&&this.data.options.length>0;this.data.combo||(k.size=this.data.options.length,this.data.multiSelect&&(k.multiple=!0)),k.addEventListener("resetform",rt=>{const st=this.data.defaultFieldValue;for(const ut of k.options)ut.selected=ut.value===st});for(const rt of this.data.options){const st=document.createElement("option");st.textContent=rt.displayValue,st.value=rt.exportValue,A.value.includes(rt.exportValue)&&(st.setAttribute("selected",!0),F=!1),k.append(st)}let U=null;if(F){const rt=document.createElement("option");rt.value=" ",rt.setAttribute("hidden",!0),rt.setAttribute("selected",!0),k.prepend(rt),U=()=>{rt.remove(),k.removeEventListener("input",U),U=null},k.addEventListener("input",U)}const X=rt=>{const st=rt?"value":"textContent",{options:ut,multiple:ht}=k;return ht?Array.prototype.filter.call(ut,gt=>gt.selected).map(gt=>gt[st]):ut.selectedIndex===-1?null:ut[ut.selectedIndex][st]};let it=X(!1);const St=rt=>{const st=rt.target.options;return Array.prototype.map.call(st,ut=>({displayValue:ut.textContent,exportValue:ut.value}))};return this.enableScripting&&this.hasJSActions?(k.addEventListener("updatefromsandbox",rt=>{const st={value(ut){U?.();const ht=ut.detail.value,gt=new Set(Array.isArray(ht)?ht:[ht]);for(const Ct of k.options)Ct.selected=gt.has(Ct.value);a.setValue(b,{value:X(!0)}),it=X(!1)},multipleSelection(ut){k.multiple=!0},remove(ut){const ht=k.options,gt=ut.detail.remove;ht[gt].selected=!1,k.remove(gt),ht.length>0&&Array.prototype.findIndex.call(ht,Lt=>Lt.selected)===-1&&(ht[0].selected=!0),a.setValue(b,{value:X(!0),items:St(ut)}),it=X(!1)},clear(ut){for(;k.length!==0;)k.remove(0);a.setValue(b,{value:null,items:[]}),it=X(!1)},insert(ut){const{index:ht,displayValue:gt,exportValue:Ct}=ut.detail.insert,Lt=k.children[ht],Bt=document.createElement("option");Bt.textContent=gt,Bt.value=Ct,Lt?Lt.before(Bt):k.append(Bt),a.setValue(b,{value:X(!0),items:St(ut)}),it=X(!1)},items(ut){const{items:ht}=ut.detail;for(;k.length!==0;)k.remove(0);for(const gt of ht){const{displayValue:Ct,exportValue:Lt}=gt,Bt=document.createElement("option");Bt.textContent=Ct,Bt.value=Lt,k.append(Bt)}k.options.length>0&&(k.options[0].selected=!0),a.setValue(b,{value:X(!0),items:St(ut)}),it=X(!1)},indices(ut){const ht=new Set(ut.detail.indices);for(const gt of ut.target.options)gt.selected=ht.has(gt.index);a.setValue(b,{value:X(!0)}),it=X(!1)},editable(ut){ut.target.disabled=!ut.detail.editable}};this._dispatchEventFromSandbox(st,rt)}),k.addEventListener("input",rt=>{const st=X(!0);a.setValue(b,{value:st}),rt.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b,name:"Keystroke",value:it,changeEx:st,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(k,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],rt=>rt.target.value)):k.addEventListener("input",function(rt){a.setValue(b,{value:X(!0)})}),this.data.combo&&this._setTextStyle(k),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class $ extends e{constructor(a){const{data:b,elements:A}=a;super(a,{isRenderable:e._hasPopupData(b)}),this.elements=A}render(){this.container.classList.add("popupAnnotation");const a=new j({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),b=[];for(const A of this.elements)A.popup=a,b.push(A.data.id),A.addHighlightArea();return this.container.setAttribute("aria-controls",b.map(A=>`${u.AnnotationPrefix}${A}`).join(",")),this.container}}class j{#t=null;#e=this.#u.bind(this);#n=this.#S.bind(this);#i=this.#E.bind(this);#o=this.#_.bind(this);#a=null;#s=null;#l=null;#c=null;#r=null;#f=null;#h=!1;#d=null;#p=null;#v=null;#m=null;#g=!1;constructor({container:a,color:b,elements:A,titleObj:k,modificationDate:F,contentsObj:U,richText:X,parent:it,rect:St,parentRect:rt,open:st}){this.#s=a,this.#m=k,this.#l=U,this.#v=X,this.#r=it,this.#a=b,this.#p=St,this.#f=rt,this.#c=A;const ut=y.PDFDateString.toDateObject(F);ut&&(this.#t=it.l10n.get("annotation_date_string",{date:ut.toLocaleDateString(),time:ut.toLocaleTimeString()})),this.trigger=A.flatMap(ht=>ht.getElementsToTriggerPopup());for(const ht of this.trigger)ht.addEventListener("click",this.#o),ht.addEventListener("mouseenter",this.#i),ht.addEventListener("mouseleave",this.#n),ht.classList.add("popupTriggerArea");for(const ht of A)ht.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,st&&this.#_()}render(){if(this.#d)return;const{page:{view:a},viewport:{rawDims:{pageWidth:b,pageHeight:A,pageX:k,pageY:F}}}=this.#r,U=this.#d=document.createElement("div");if(U.className="popup",this.#a){const $t=U.style.outlineColor=u.Util.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?U.style.backgroundColor=`color-mix(in srgb, ${$t} 30%, white)`:U.style.backgroundColor=u.Util.makeHexColor(...this.#a.map(Me=>Math.floor(.7*(255-Me)+Me)))}const X=document.createElement("span");X.className="header";const it=document.createElement("h1");if(X.append(it),{dir:it.dir,str:it.textContent}=this.#m,U.append(X),this.#t){const $t=document.createElement("span");$t.classList.add("popupDate"),this.#t.then(ne=>{$t.textContent=ne}),X.append($t)}const St=this.#l,rt=this.#v;if(rt?.str&&(!St?.str||St.str===rt.str))q.XfaLayer.render({xfaHtml:rt.html,intent:"richText",div:U}),U.lastChild.classList.add("richText","popupContent");else{const $t=this._formatContents(St);U.append($t)}let st=!!this.#f,ut=st?this.#f:this.#p;for(const $t of this.#c)if(!ut||u.Util.intersect($t.data.rect,ut)!==null){ut=$t.data.rect,st=!0;break}const ht=u.Util.normalizeRect([ut[0],a[3]-ut[1]+a[1],ut[2],a[3]-ut[3]+a[1]]),Ct=st?ut[2]-ut[0]+5:0,Lt=ht[0]+Ct,Bt=ht[1],{style:Xt}=this.#s;Xt.left=`${100*(Lt-k)/b}%`,Xt.top=`${100*(Bt-F)/A}%`,this.#s.append(U)}_formatContents({str:a,dir:b}){const A=document.createElement("p");A.classList.add("popupContent"),A.dir=b;const k=a.split(/(?:\r\n?|\n)/);for(let F=0,U=k.length;F<U;++F){const X=k[F];A.append(document.createTextNode(X)),F<U-1&&A.append(document.createElement("br"))}return A}#u(a){a.altKey||a.shiftKey||a.ctrlKey||a.metaKey||(a.key==="Enter"||a.key==="Escape"&&this.#h)&&this.#_()}#_(){this.#h=!this.#h,this.#h?(this.#E(),this.#s.addEventListener("click",this.#o),this.#s.addEventListener("keydown",this.#e)):(this.#S(),this.#s.removeEventListener("click",this.#o),this.#s.removeEventListener("keydown",this.#e))}#E(){this.#d||this.render(),this.isVisible?this.#h&&this.#s.classList.add("focused"):(this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#S(){this.#s.classList.remove("focused"),!(this.#h||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#s.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class tt extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.textContent=a.data.textContent,this.textPosition=a.data.textPosition,this.annotationEditorType=u.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const a=document.createElement("div");a.classList.add("annotationTextContent"),a.setAttribute("role","comment");for(const b of this.textContent){const A=document.createElement("span");A.textContent=b,a.append(A)}this.container.append(a)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}o.FreeTextAnnotationElement=tt;class nt extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const a=this.data,{width:b,height:A}=f(a.rect),k=this.svgFactory.create(b,A,!0),F=this.#t=this.svgFactory.createElement("svg:line");return F.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),F.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),F.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),F.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),F.setAttribute("stroke-width",a.borderStyle.width||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),k.append(F),this.container.append(k),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class bt extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const a=this.data,{width:b,height:A}=f(a.rect),k=this.svgFactory.create(b,A,!0),F=a.borderStyle.width,U=this.#t=this.svgFactory.createElement("svg:rect");return U.setAttribute("x",F/2),U.setAttribute("y",F/2),U.setAttribute("width",b-F),U.setAttribute("height",A-F),U.setAttribute("stroke-width",F||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),k.append(U),this.container.append(k),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class dt extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const a=this.data,{width:b,height:A}=f(a.rect),k=this.svgFactory.create(b,A,!0),F=a.borderStyle.width,U=this.#t=this.svgFactory.createElement("svg:ellipse");return U.setAttribute("cx",b/2),U.setAttribute("cy",A/2),U.setAttribute("rx",b/2-F/2),U.setAttribute("ry",A/2-F/2),U.setAttribute("stroke-width",F||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),k.append(U),this.container.append(k),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class mt extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:b,height:A}=f(a.rect),k=this.svgFactory.create(b,A,!0);let F=[];for(const X of a.vertices){const it=X.x-a.rect[0],St=a.rect[3]-X.y;F.push(it+","+St)}F=F.join(" ");const U=this.#t=this.svgFactory.createElement(this.svgElementName);return U.setAttribute("points",F),U.setAttribute("stroke-width",a.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),k.append(U),this.container.append(k),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class At extends mt{constructor(a){super(a),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ot extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class N extends e{#t=[];constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=u.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:b,height:A}=f(a.rect),k=this.svgFactory.create(b,A,!0);for(const F of a.inkLists){let U=[];for(const it of F){const St=it.x-a.rect[0],rt=a.rect[3]-it.y;U.push(`${St},${rt}`)}U=U.join(" ");const X=this.svgFactory.createElement(this.svgElementName);this.#t.push(X),X.setAttribute("points",U),X.setAttribute("stroke-width",a.borderStyle.width||1),X.setAttribute("stroke","transparent"),X.setAttribute("fill","transparent"),!a.popupRef&&this.hasPopupData&&this._createPopup(),k.append(X)}return this.container.append(k),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}o.InkAnnotationElement=N;class E extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class p extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class r extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class v extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class T extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}o.StampAnnotationElement=T;class P extends e{#t=null;constructor(a){super(a,{isRenderable:!0});const{filename:b,content:A}=this.data.file;this.filename=(0,y.getFilenameFromUrl)(b,!0),this.content=A,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:b,content:A})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:a,data:b}=this;let A;b.hasAppearance||b.fillAlpha===0?A=document.createElement("div"):(A=document.createElement("img"),A.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(b.name)?"paperclip":"pushpin"}.svg`,b.fillAlpha&&b.fillAlpha<1&&(A.style=`filter: opacity(${Math.round(b.fillAlpha*100)}%);`)),A.addEventListener("dblclick",this.#e.bind(this)),this.#t=A;const{isMac:k}=u.FeatureTest.platform;return a.addEventListener("keydown",F=>{F.key==="Enter"&&(k?F.metaKey:F.ctrlKey)&&this.#e()}),!b.popupRef&&this.hasPopupData?this._createPopup():A.classList.add("popupTriggerArea"),a.append(A),a}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class D{#t=null;#e=null;#n=new Map;constructor({div:a,accessibilityManager:b,annotationCanvasMap:A,l10n:k,page:F,viewport:U}){this.div=a,this.#t=b,this.#e=A,this.l10n=k,this.page=F,this.viewport=U,this.zIndex=0,this.l10n||=V.NullL10n}#i(a,b){const A=a.firstChild||a;A.id=`${u.AnnotationPrefix}${b}`,this.div.append(a),this.#t?.moveElementInDOM(this.div,a,A,!1)}async render(a){const{annotations:b}=a,A=this.div;(0,y.setLayerDimensions)(A,this.viewport);const k=new Map,F={data:null,layer:A,linkService:a.linkService,downloadManager:a.downloadManager,imageResourcesPath:a.imageResourcesPath||"",renderForms:a.renderForms!==!1,svgFactory:new y.DOMSVGFactory,annotationStorage:a.annotationStorage||new n.AnnotationStorage,enableScripting:a.enableScripting===!0,hasJSActions:a.hasJSActions,fieldObjects:a.fieldObjects,parent:this,elements:null};for(const U of b){if(U.noHTML)continue;const X=U.annotationType===u.AnnotationType.POPUP;if(X){const rt=k.get(U.id);if(!rt)continue;F.elements=rt}else{const{width:rt,height:st}=f(U.rect);if(rt<=0||st<=0)continue}F.data=U;const it=h.create(F);if(!it.isRenderable)continue;if(!X&&U.popupRef){const rt=k.get(U.popupRef);rt?rt.push(it):k.set(U.popupRef,[it])}it.annotationEditorType>0&&this.#n.set(it.data.id,it);const St=it.render();U.hidden&&(St.style.visibility="hidden"),this.#i(St,U.id)}this.#o(),await this.l10n.translate(A)}update({viewport:a}){const b=this.div;this.viewport=a,(0,y.setLayerDimensions)(b,{rotation:a.rotation}),this.#o(),b.hidden=!1}#o(){if(!this.#e)return;const a=this.div;for(const[b,A]of this.#e){const k=a.querySelector(`[data-annotation-id="${b}"]`);if(!k)continue;const{firstChild:F}=k;F?F.nodeName==="CANVAS"?F.replaceWith(A):F.before(A):k.append(A)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(a){return this.#n.get(a)}}o.AnnotationLayer=D}),((d,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorConverters=void 0;function I(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function u(n){return Math.max(0,Math.min(255,255*n))}class y{static CMYK_G([x,V,q,s]){return["G",1-Math.min(1,.3*x+.59*q+.11*V+s)]}static G_CMYK([x]){return["CMYK",0,0,0,1-x]}static G_RGB([x]){return["RGB",x,x,x]}static G_rgb([x]){return x=u(x),[x,x,x]}static G_HTML([x]){const V=I(x);return`#${V}${V}${V}`}static RGB_G([x,V,q]){return["G",.3*x+.59*V+.11*q]}static RGB_rgb(x){return x.map(u)}static RGB_HTML(x){return`#${x.map(I).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([x,V,q,s]){return["RGB",1-Math.min(1,x+s),1-Math.min(1,q+s),1-Math.min(1,V+s)]}static CMYK_rgb([x,V,q,s]){return[u(1-Math.min(1,x+s)),u(1-Math.min(1,q+s)),u(1-Math.min(1,V+s))]}static CMYK_HTML(x){const V=this.CMYK_RGB(x).slice(1);return this.RGB_HTML(V)}static RGB_CMYK([x,V,q]){const s=1-x,t=1-V,i=1-q,f=Math.min(s,t,i);return["CMYK",s,t,i,f]}}o.ColorConverters=y}),((d,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.NullL10n=void 0,o.getL10nFallback=u;const I={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};I.print_progress_percent="{{progress}}%";function u(x,V){switch(x){case"find_match_count":x=`find_match_count[${V.total===1?"one":"other"}]`;break;case"find_match_count_limit":x=`find_match_count_limit[${V.limit===1?"one":"other"}]`;break}return I[x]||""}function y(x,V){return V?x.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(q,s)=>s in V?V[s]:"{{"+s+"}}"):x}const n={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(x,V=null,q=u(x,V)){return y(q,V)},async translate(x){}};o.NullL10n=n}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.XfaLayer=void 0;var u=I(25);class y{static setupStorage(x,V,q,s,t){const i=s.getValue(V,{value:null});switch(q.name){case"textarea":if(i.value!==null&&(x.textContent=i.value),t==="print")break;x.addEventListener("input",f=>{s.setValue(V,{value:f.target.value})});break;case"input":if(q.attributes.type==="radio"||q.attributes.type==="checkbox"){if(i.value===q.attributes.xfaOn?x.setAttribute("checked",!0):i.value===q.attributes.xfaOff&&x.removeAttribute("checked"),t==="print")break;x.addEventListener("change",f=>{s.setValue(V,{value:f.target.checked?f.target.getAttribute("xfaOn"):f.target.getAttribute("xfaOff")})})}else{if(i.value!==null&&x.setAttribute("value",i.value),t==="print")break;x.addEventListener("input",f=>{s.setValue(V,{value:f.target.value})})}break;case"select":if(i.value!==null){x.setAttribute("value",i.value);for(const f of q.children)f.attributes.value===i.value?f.attributes.selected=!0:f.attributes.hasOwnProperty("selected")&&delete f.attributes.selected}x.addEventListener("input",f=>{const h=f.target.options,e=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(V,{value:e})});break}}static setAttributes({html:x,element:V,storage:q=null,intent:s,linkService:t}){const{attributes:i}=V,f=x instanceof HTMLAnchorElement;i.type==="radio"&&(i.name=`${i.name}-${s}`);for(const[h,e]of Object.entries(i))if(e!=null)switch(h){case"class":e.length&&x.setAttribute(h,e.join(" "));break;case"dataId":break;case"id":x.setAttribute("data-element-id",e);break;case"style":Object.assign(x.style,e);break;case"textContent":x.textContent=e;break;default:(!f||h!=="href"&&h!=="newWindow")&&x.setAttribute(h,e)}f&&t.addLinkAttributes(x,i.href,i.newWindow),q&&i.dataId&&this.setupStorage(x,i.dataId,V,q)}static render(x){const V=x.annotationStorage,q=x.linkService,s=x.xfaHtml,t=x.intent||"display",i=document.createElement(s.name);s.attributes&&this.setAttributes({html:i,element:s,intent:t,linkService:q});const f=[[s,-1,i]],h=x.div;if(h.append(i),x.viewport){const g=`matrix(${x.viewport.transform.join(",")})`;h.style.transform=g}t!=="richText"&&h.setAttribute("class","xfaLayer xfaFont");const e=[];for(;f.length>0;){const[g,_,c]=f.at(-1);if(_+1===g.children.length){f.pop();continue}const w=g.children[++f.at(-1)[1]];if(w===null)continue;const{name:L}=w;if(L==="#text"){const m=document.createTextNode(w.value);e.push(m),c.append(m);continue}const M=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,L):document.createElement(L);if(c.append(M),w.attributes&&this.setAttributes({html:M,element:w,storage:V,intent:t,linkService:q}),w.children&&w.children.length>0)f.push([w,-1,M]);else if(w.value){const m=document.createTextNode(w.value);u.XfaText.shouldBuildText(L)&&e.push(m),M.append(m)}}for(const g of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:e}}static update(x){const V=`matrix(${x.viewport.transform.join(",")})`;x.div.style.transform=V,x.div.hidden=!1}}o.XfaLayer=y}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.InkEditor=void 0;var u=I(1),y=I(4),n=I(29),x=I(6),V=I(5);class q extends y.AnnotationEditor{#t=0;#e=0;#n=this.canvasPointermove.bind(this);#i=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#a=this.canvasPointerdown.bind(this);#s=new Path2D;#l=!1;#c=!1;#r=!1;#f=null;#h=0;#d=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t){y.AnnotationEditor.initialize(t,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(t,i){switch(t){case u.AnnotationEditorParamsType.INK_THICKNESS:q._defaultThickness=i;break;case u.AnnotationEditorParamsType.INK_COLOR:q._defaultColor=i;break;case u.AnnotationEditorParamsType.INK_OPACITY:q._defaultOpacity=i/100;break}}updateParams(t,i){switch(t){case u.AnnotationEditorParamsType.INK_THICKNESS:this.#v(i);break;case u.AnnotationEditorParamsType.INK_COLOR:this.#m(i);break;case u.AnnotationEditorParamsType.INK_OPACITY:this.#g(i);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.INK_THICKNESS,q._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,q._defaultColor||y.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(q._defaultOpacity*100)]]}get propertiesToUpdate(){return[[u.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||q._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,this.color||q._defaultColor||y.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??q._defaultOpacity))]]}#v(t){const i=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#C()},undo:()=>{this.thickness=i,this.#C()},mustExec:!0,type:u.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(t){const i=this.color;this.addCommands({cmd:()=>{this.color=t,this.#b()},undo:()=>{this.color=i,this.#b()},mustExec:!0,type:u.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(t){t/=100;const i=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#b()},undo:()=>{this.opacity=i,this.#b()},mustExec:!0,type:u.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#k(),this.#M()),this.isAttachedToDOM||(this.parent.add(this),this.#y()),this.#C()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#f.disconnect(),this.#f=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,i]=this.parentDimensions,f=this.width*t,h=this.height*i;this.setDimensions(f,h)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#a))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#a))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#u(){const{parentRotation:t,parentDimensions:[i,f]}=this;switch(t){case 90:return[0,f,f,i];case 180:return[i,f,i,f];case 270:return[i,0,f,i];default:return[0,0,i,f]}}#_(){const{ctx:t,color:i,opacity:f,thickness:h,parentScale:e,scaleFactor:g}=this;t.lineWidth=h*e/g,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${i}${(0,V.opacityToHex)(f)}`}#E(t,i){this.canvas.addEventListener("contextmenu",x.noContextMenu),this.canvas.addEventListener("pointerleave",this.#i),this.canvas.addEventListener("pointermove",this.#n),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#a),this.isEditing=!0,this.#r||(this.#r=!0,this.#y(),this.thickness||=q._defaultThickness,this.color||=q._defaultColor||y.AnnotationEditor._defaultLineColor,this.opacity??=q._defaultOpacity),this.currentPath.push([t,i]),this.#c=!1,this.#_(),this.#p=()=>{this.#D(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#S(t,i){const[f,h]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===f&&i===h)return;const e=this.currentPath;let g=this.#s;if(e.push([t,i]),this.#c=!0,e.length<=2){g.moveTo(...e[0]),g.lineTo(t,i);return}e.length===3&&(this.#s=g=new Path2D,g.moveTo(...e[0])),this.#I(g,...e.at(-3),...e.at(-2),t,i)}#P(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);this.#s.lineTo(...t)}#R(t,i){this.#p=null,t=Math.min(Math.max(t,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),this.#S(t,i),this.#P();let f;if(this.currentPath.length!==1)f=this.#O();else{const c=[t,i];f=[[c,c.slice(),c.slice(),c]]}const h=this.#s,e=this.currentPath;this.currentPath=[],this.#s=new Path2D;const g=()=>{this.allRawPaths.push(e),this.paths.push(f),this.bezierPath2D.push(h),this.rebuild()},_=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#k(),this.#M()),this.#C())};this.addCommands({cmd:g,undo:_,mustExec:!0})}#D(){if(!this.#c)return;this.#c=!1;const t=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),f=i.map(g=>g[0]),h=i.map(g=>g[1]);Math.min(...f)-t,Math.max(...f)+t,Math.min(...h)-t,Math.max(...h)+t;const{ctx:e}=this;e.save(),e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const g of this.bezierPath2D)e.stroke(g);e.stroke(this.#s),e.restore()}#I(t,i,f,h,e,g,_){const c=(i+h)/2,w=(f+e)/2,L=(h+g)/2,M=(e+_)/2;t.bezierCurveTo(c+2*(h-c)/3,w+2*(e-w)/3,L+2*(h-L)/3,M+2*(e-M)/3,L,M)}#O(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const i=[];let f,[h,e]=t[0];for(f=1;f<t.length-2;f++){const[m,C]=t[f],[z,$]=t[f+1],j=(m+z)/2,tt=(C+$)/2,nt=[h+2*(m-h)/3,e+2*(C-e)/3],bt=[j+2*(m-j)/3,tt+2*(C-tt)/3];i.push([[h,e],nt,bt,[j,tt]]),[h,e]=[j,tt]}const[g,_]=t[f],[c,w]=t[f+1],L=[h+2*(g-h)/3,e+2*(_-e)/3],M=[c+2*(g-c)/3,w+2*(_-w)/3];return i.push([[h,e],L,M,[c,w]]),i}#b(){if(this.isEmpty()){this.#w();return}this.#_();const{canvas:t,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height),this.#w();for(const f of this.bezierPath2D)i.stroke(f)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#C(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),t.preventDefault(),t.type!=="mouse"&&this.div.focus(),this.#E(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#S(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#L(t)}canvasPointerleave(t){this.#L(t)}#L(t){this.canvas.removeEventListener("pointerleave",this.#i),this.canvas.removeEventListener("pointermove",this.#n),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#a),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",x.noContextMenu)},10),this.#R(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#k(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",y.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#M(){this.#f=new ResizeObserver(t=>{const i=t[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)}),this.#f.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),y.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(_=>this.div?.setAttribute("aria-label",_));const[f,h,e,g]=this.#u();if(this.setAt(f,h,0,0),this.setDims(e,g),this.#k(),this.width){const[_,c]=this.parentDimensions;this.setAspectRatio(this.width*_,this.height*c),this.setAt(t*_,i*c,this.width*_,this.height*c),this.#r=!0,this.#y(),this.setDims(this.width*_,this.height*c),this.#b(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#M(),this.div}#y(){if(!this.#r)return;const[t,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*i),this.#w()}setDimensions(t,i){const f=Math.round(t),h=Math.round(i);if(this.#h===f&&this.#d===h)return;this.#h=f,this.#d=h,this.canvas.style.visibility="hidden";const[e,g]=this.parentDimensions;this.width=t/e,this.height=i/g,this.fixAndSetPosition(),this.#l&&this.#T(t,i),this.#y(),this.#b(),this.canvas.style.visibility="visible",this.fixDims()}#T(t,i){const f=this.#F(),h=(t-f)/this.#e,e=(i-f)/this.#t;this.scaleFactor=Math.min(h,e)}#w(){const t=this.#F()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#N(t){const i=new Path2D;for(let f=0,h=t.length;f<h;f++){const[e,g,_,c]=t[f];f===0&&i.moveTo(...e),i.bezierCurveTo(g[0],g[1],_[0],_[1],c[0],c[1])}return i}static#B(t,i,f){const[h,e,g,_]=i;switch(f){case 0:for(let c=0,w=t.length;c<w;c+=2)t[c]+=h,t[c+1]=_-t[c+1];break;case 90:for(let c=0,w=t.length;c<w;c+=2){const L=t[c];t[c]=t[c+1]+h,t[c+1]=L+e}break;case 180:for(let c=0,w=t.length;c<w;c+=2)t[c]=g-t[c],t[c+1]+=e;break;case 270:for(let c=0,w=t.length;c<w;c+=2){const L=t[c];t[c]=g-t[c+1],t[c+1]=_-L}break;default:throw new Error("Invalid rotation")}return t}static#H(t,i,f){const[h,e,g,_]=i;switch(f){case 0:for(let c=0,w=t.length;c<w;c+=2)t[c]-=h,t[c+1]=_-t[c+1];break;case 90:for(let c=0,w=t.length;c<w;c+=2){const L=t[c];t[c]=t[c+1]-e,t[c+1]=L-h}break;case 180:for(let c=0,w=t.length;c<w;c+=2)t[c]=g-t[c],t[c+1]-=e;break;case 270:for(let c=0,w=t.length;c<w;c+=2){const L=t[c];t[c]=_-t[c+1],t[c+1]=g-L}break;default:throw new Error("Invalid rotation")}return t}#j(t,i,f,h){const e=[],g=this.thickness/2,_=t*i+g,c=t*f+g;for(const w of this.paths){const L=[],M=[];for(let m=0,C=w.length;m<C;m++){const[z,$,j,tt]=w[m],nt=t*z[0]+_,bt=t*z[1]+c,dt=t*$[0]+_,mt=t*$[1]+c,At=t*j[0]+_,ot=t*j[1]+c,N=t*tt[0]+_,E=t*tt[1]+c;m===0&&(L.push(nt,bt),M.push(nt,bt)),L.push(dt,mt,At,ot,N,E),M.push(dt,mt),m===C-1&&M.push(N,E)}e.push({bezier:q.#B(L,h,this.rotation),points:q.#B(M,h,this.rotation)})}return e}#x(){let t=1/0,i=-1/0,f=1/0,h=-1/0;for(const e of this.paths)for(const[g,_,c,w]of e){const L=u.Util.bezierBoundingBox(...g,..._,...c,...w);t=Math.min(t,L[0]),f=Math.min(f,L[1]),i=Math.max(i,L[2]),h=Math.max(h,L[3])}return[t,f,i,h]}#F(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#C(t=!1){if(this.isEmpty())return;if(!this.#l){this.#b();return}const i=this.#x(),f=this.#F();this.#e=Math.max(y.AnnotationEditor.MIN_SIZE,i[2]-i[0]),this.#t=Math.max(y.AnnotationEditor.MIN_SIZE,i[3]-i[1]);const h=Math.ceil(f+this.#e*this.scaleFactor),e=Math.ceil(f+this.#t*this.scaleFactor),[g,_]=this.parentDimensions;this.width=h/g,this.height=e/_,this.setAspectRatio(h,e);const c=this.translationX,w=this.translationY;this.translationX=-i[0],this.translationY=-i[1],this.#y(),this.#b(),this.#h=h,this.#d=e,this.setDims(h,e);const L=t?f/this.scaleFactor/2:0;this.translate(c-this.translationX-L,w-this.translationY-L)}static deserialize(t,i,f){if(t instanceof n.InkAnnotationElement)return null;const h=super.deserialize(t,i,f);h.thickness=t.thickness,h.color=u.Util.makeHexColor(...t.color),h.opacity=t.opacity;const[e,g]=h.pageDimensions,_=h.width*e,c=h.height*g,w=h.parentScale,L=t.thickness/2;h.#l=!0,h.#h=Math.round(_),h.#d=Math.round(c);const{paths:M,rect:m,rotation:C}=t;for(let{bezier:$}of M){$=q.#H($,m,C);const j=[];h.paths.push(j);let tt=w*($[0]-L),nt=w*($[1]-L);for(let dt=2,mt=$.length;dt<mt;dt+=6){const At=w*($[dt]-L),ot=w*($[dt+1]-L),N=w*($[dt+2]-L),E=w*($[dt+3]-L),p=w*($[dt+4]-L),r=w*($[dt+5]-L);j.push([[tt,nt],[At,ot],[N,E],[p,r]]),tt=p,nt=r}const bt=this.#N(j);h.bezierPath2D.push(bt)}const z=h.#x();return h.#e=Math.max(y.AnnotationEditor.MIN_SIZE,z[2]-z[0]),h.#t=Math.max(y.AnnotationEditor.MIN_SIZE,z[3]-z[1]),h.#T(_,c),h}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),i=y.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:u.AnnotationEditorType.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:this.#j(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}o.InkEditor=q}),((d,o,I)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.StampEditor=void 0;var u=I(1),y=I(4),n=I(6),x=I(29);class V extends y.AnnotationEditor{#t=null;#e=null;#n=null;#i=null;#o=null;#a=null;#s=null;#l=null;#c=!1;#r=!1;static _type="stamp";constructor(s){super({...s,name:"stampEditor"}),this.#i=s.bitmapUrl,this.#o=s.bitmapFile}static initialize(s){y.AnnotationEditor.initialize(s)}static get supportedTypes(){const s=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,u.shadow)(this,"supportedTypes",s.map(t=>`image/${t}`))}static get supportedTypesStr(){return(0,u.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(s){return this.supportedTypes.includes(s)}static paste(s,t){t.pasteEditor(u.AnnotationEditorType.STAMP,{bitmapFile:s.getAsFile()})}#f(s,t=!1){if(!s){this.remove();return}this.#t=s.bitmap,t||(this.#e=s.id,this.#c=s.isSvg),this.#p()}#h(){this.#n=null,this._uiManager.enableWaiting(!1),this.#a&&this.div.focus()}#d(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(t=>this.#f(t,!0)).finally(()=>this.#h());return}if(this.#i){const t=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(t).then(i=>this.#f(i)).finally(()=>this.#h());return}if(this.#o){const t=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(t).then(i=>this.#f(i)).finally(()=>this.#h());return}const s=document.createElement("input");s.type="file",s.accept=V.supportedTypesStr,this.#n=new Promise(t=>{s.addEventListener("change",async()=>{if(!s.files||s.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(s.files[0]);this.#f(i)}t()}),s.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>this.#h()),s.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#s?.disconnect(),this.#s=null),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#d();return}super.rebuild(),this.div!==null&&(this.#e&&this.#d(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let s,t;if(this.width&&(s=this.x,t=this.y),super.render(),this.div.hidden=!0,this.#t?this.#p():this.#d(),this.width){const[i,f]=this.parentDimensions;this.setAt(s*i,t*f,this.width*i,this.height*f)}return this.div}#p(){const{div:s}=this;let{width:t,height:i}=this.#t;const[f,h]=this.pageDimensions,e=.75;if(this.width)t=this.width*f,i=this.height*h;else if(t>e*f||i>e*h){const w=Math.min(e*f/t,e*h/i);t*=w,i*=w}const[g,_]=this.parentDimensions;this.setDims(t*g/f,i*_/h),this._uiManager.enableWaiting(!1);const c=this.#a=document.createElement("canvas");s.append(c),s.hidden=!1,this.#g(t,i),this.#_(),this.#r||(this.parent.addUndoableEditor(this),this.#r=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#v(s,t){const[i,f]=this.parentDimensions;this.width=s/i,this.height=t/f,this.setDims(s,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);const h=200;this.#l=setTimeout(()=>{this.#l=null,this.#g(s,t)},h)}#m(s,t){const{width:i,height:f}=this.#t;let h=i,e=f,g=this.#t;for(;h>2*s||e>2*t;){const _=h,c=e;h>2*s&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2)),e>2*t&&(e=e>=16384?Math.floor(e/2)-1:Math.ceil(e/2));const w=new OffscreenCanvas(h,e);w.getContext("2d").drawImage(g,0,0,_,c,0,0,h,e),g=w.transferToImageBitmap()}return g}#g(s,t){s=Math.ceil(s),t=Math.ceil(t);const i=this.#a;if(!i||i.width===s&&i.height===t)return;i.width=s,i.height=t;const f=this.#c?this.#t:this.#m(s,t),h=i.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(f,0,0,f.width,f.height,0,0,s,t)}#u(s){if(s){if(this.#c){const f=this._uiManager.imageManager.getSvgUrl(this.#e);if(f)return f}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#t,t.getContext("2d").drawImage(this.#t,0,0),t.toDataURL()}if(this.#c){const[t,i]=this.pageDimensions,f=Math.round(this.width*t*n.PixelsPerInch.PDF_TO_CSS_UNITS),h=Math.round(this.height*i*n.PixelsPerInch.PDF_TO_CSS_UNITS),e=new OffscreenCanvas(f,h);return e.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,f,h),e.transferToImageBitmap()}return structuredClone(this.#t)}#_(){this.#s=new ResizeObserver(s=>{const t=s[0].contentRect;t.width&&t.height&&this.#v(t.width,t.height)}),this.#s.observe(this.div)}static deserialize(s,t,i){if(s instanceof x.StampAnnotationElement)return null;const f=super.deserialize(s,t,i),{rect:h,bitmapUrl:e,bitmapId:g,isSvg:_,accessibilityData:c}=s;g&&i.imageManager.isValidId(g)?f.#e=g:f.#i=e,f.#c=_;const[w,L]=f.pageDimensions;return f.width=(h[2]-h[0])/w,f.height=(h[3]-h[1])/L,c&&(f.altTextData=c),f}serialize(s=!1,t=null){if(this.isEmpty())return null;const i={annotationType:u.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(s)return i.bitmapUrl=this.#u(!0),i.accessibilityData=this.altTextData,i;const{decorative:f,altText:h}=this.altTextData;if(!f&&h&&(i.accessibilityData={type:"Figure",alt:h}),t===null)return i;t.stamps||=new Map;const e=this.#c?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#e))t.stamps.set(this.#e,{area:e,serialized:i}),i.bitmap=this.#u(!1);else if(this.#c){const g=t.stamps.get(this.#e);e>g.area&&(g.area=e,g.serialized.bitmap.close(),g.serialized.bitmap=this.#u(!1))}return i}}o.StampEditor=V})],__webpack_module_cache__={};function __w_pdfjs_require__(d){var o=__webpack_module_cache__[d];if(o!==void 0)return o.exports;var I=__webpack_module_cache__[d]={exports:{}};return __webpack_modules__[d](I,I.exports,__w_pdfjs_require__),I.exports}var __webpack_exports__={};return(()=>{var d=__webpack_exports__;Object.defineProperty(d,"__esModule",{value:!0}),Object.defineProperty(d,"AbortException",{enumerable:!0,get:function(){return o.AbortException}}),Object.defineProperty(d,"AnnotationEditorLayer",{enumerable:!0,get:function(){return n.AnnotationEditorLayer}}),Object.defineProperty(d,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return o.AnnotationEditorParamsType}}),Object.defineProperty(d,"AnnotationEditorType",{enumerable:!0,get:function(){return o.AnnotationEditorType}}),Object.defineProperty(d,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return x.AnnotationEditorUIManager}}),Object.defineProperty(d,"AnnotationLayer",{enumerable:!0,get:function(){return V.AnnotationLayer}}),Object.defineProperty(d,"AnnotationMode",{enumerable:!0,get:function(){return o.AnnotationMode}}),Object.defineProperty(d,"CMapCompressionType",{enumerable:!0,get:function(){return o.CMapCompressionType}}),Object.defineProperty(d,"DOMSVGFactory",{enumerable:!0,get:function(){return u.DOMSVGFactory}}),Object.defineProperty(d,"FeatureTest",{enumerable:!0,get:function(){return o.FeatureTest}}),Object.defineProperty(d,"GlobalWorkerOptions",{enumerable:!0,get:function(){return q.GlobalWorkerOptions}}),Object.defineProperty(d,"ImageKind",{enumerable:!0,get:function(){return o.ImageKind}}),Object.defineProperty(d,"InvalidPDFException",{enumerable:!0,get:function(){return o.InvalidPDFException}}),Object.defineProperty(d,"MissingPDFException",{enumerable:!0,get:function(){return o.MissingPDFException}}),Object.defineProperty(d,"OPS",{enumerable:!0,get:function(){return o.OPS}}),Object.defineProperty(d,"PDFDataRangeTransport",{enumerable:!0,get:function(){return I.PDFDataRangeTransport}}),Object.defineProperty(d,"PDFDateString",{enumerable:!0,get:function(){return u.PDFDateString}}),Object.defineProperty(d,"PDFWorker",{enumerable:!0,get:function(){return I.PDFWorker}}),Object.defineProperty(d,"PasswordResponses",{enumerable:!0,get:function(){return o.PasswordResponses}}),Object.defineProperty(d,"PermissionFlag",{enumerable:!0,get:function(){return o.PermissionFlag}}),Object.defineProperty(d,"PixelsPerInch",{enumerable:!0,get:function(){return u.PixelsPerInch}}),Object.defineProperty(d,"PromiseCapability",{enumerable:!0,get:function(){return o.PromiseCapability}}),Object.defineProperty(d,"RenderingCancelledException",{enumerable:!0,get:function(){return u.RenderingCancelledException}}),Object.defineProperty(d,"SVGGraphics",{enumerable:!0,get:function(){return I.SVGGraphics}}),Object.defineProperty(d,"UnexpectedResponseException",{enumerable:!0,get:function(){return o.UnexpectedResponseException}}),Object.defineProperty(d,"Util",{enumerable:!0,get:function(){return o.Util}}),Object.defineProperty(d,"VerbosityLevel",{enumerable:!0,get:function(){return o.VerbosityLevel}}),Object.defineProperty(d,"XfaLayer",{enumerable:!0,get:function(){return s.XfaLayer}}),Object.defineProperty(d,"build",{enumerable:!0,get:function(){return I.build}}),Object.defineProperty(d,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return o.createValidAbsoluteUrl}}),Object.defineProperty(d,"getDocument",{enumerable:!0,get:function(){return I.getDocument}}),Object.defineProperty(d,"getFilenameFromUrl",{enumerable:!0,get:function(){return u.getFilenameFromUrl}}),Object.defineProperty(d,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return u.getPdfFilenameFromUrl}}),Object.defineProperty(d,"getXfaPageViewport",{enumerable:!0,get:function(){return u.getXfaPageViewport}}),Object.defineProperty(d,"isDataScheme",{enumerable:!0,get:function(){return u.isDataScheme}}),Object.defineProperty(d,"isPdfFile",{enumerable:!0,get:function(){return u.isPdfFile}}),Object.defineProperty(d,"loadScript",{enumerable:!0,get:function(){return u.loadScript}}),Object.defineProperty(d,"noContextMenu",{enumerable:!0,get:function(){return u.noContextMenu}}),Object.defineProperty(d,"normalizeUnicode",{enumerable:!0,get:function(){return o.normalizeUnicode}}),Object.defineProperty(d,"renderTextLayer",{enumerable:!0,get:function(){return y.renderTextLayer}}),Object.defineProperty(d,"setLayerDimensions",{enumerable:!0,get:function(){return u.setLayerDimensions}}),Object.defineProperty(d,"shadow",{enumerable:!0,get:function(){return o.shadow}}),Object.defineProperty(d,"updateTextLayer",{enumerable:!0,get:function(){return y.updateTextLayer}}),Object.defineProperty(d,"version",{enumerable:!0,get:function(){return I.version}});var o=__w_pdfjs_require__(1),I=__w_pdfjs_require__(2),u=__w_pdfjs_require__(6),y=__w_pdfjs_require__(26),n=__w_pdfjs_require__(27),x=__w_pdfjs_require__(5),V=__w_pdfjs_require__(29),q=__w_pdfjs_require__(14),s=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf)),pdf.exports}var hasRequiredCore_min;function requireCore_min(){return hasRequiredCore_min||(hasRequiredCore_min=1,(function(d){var o=requireReact(),I=requirePdf();function u(l){var S=Object.create(null);return l&&Object.keys(l).forEach((function(O){if(O!=="default"){var B=Object.getOwnPropertyDescriptor(l,O);Object.defineProperty(S,O,B.get?B:{enumerable:!0,get:function(){return l[O]}})}})),S.default=l,Object.freeze(S)}var y,n=u(o),x=u(I);d.AnnotationType=void 0,(y=d.AnnotationType||(d.AnnotationType={}))[y.Text=1]="Text",y[y.Link=2]="Link",y[y.FreeText=3]="FreeText",y[y.Line=4]="Line",y[y.Square=5]="Square",y[y.Circle=6]="Circle",y[y.Polygon=7]="Polygon",y[y.Polyline=8]="Polyline",y[y.Highlight=9]="Highlight",y[y.Underline=10]="Underline",y[y.Squiggly=11]="Squiggly",y[y.StrikeOut=12]="StrikeOut",y[y.Stamp=13]="Stamp",y[y.Caret=14]="Caret",y[y.Ink=15]="Ink",y[y.Popup=16]="Popup",y[y.FileAttachment=17]="FileAttachment";var V=function(l,S){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,B){O.__proto__=B}||function(O,B){for(var W in B)Object.prototype.hasOwnProperty.call(B,W)&&(O[W]=B[W])},V(l,S)};function q(l,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");function O(){this.constructor=l}V(l,S),l.prototype=S===null?Object.create(S):(O.prototype=S.prototype,new O)}var s,t=function(){return t=Object.assign||function(l){for(var S,O=1,B=arguments.length;O<B;O++)for(var W in S=arguments[O])Object.prototype.hasOwnProperty.call(S,W)&&(l[W]=S[W]);return l},t.apply(this,arguments)};d.TextDirection=void 0,(s=d.TextDirection||(d.TextDirection={})).RightToLeft="RTL",s.LeftToRight="LTR";var i,f=n.createContext({currentTheme:"light",direction:d.TextDirection.LeftToRight,setCurrentTheme:function(){}}),h=function(l){var S=[];return Object.keys(l).forEach((function(O){O&&l[O]&&S.push(O)})),S.join(" ")},e=typeof window<"u"?n.useLayoutEffect:n.useEffect,g=function(l){var S=n.useRef(null),O=l.once,B=l.threshold,W=l.onVisibilityChanged;return e((function(){var G=S.current;if(G){var Z=new IntersectionObserver((function(Y){Y.forEach((function(H){var J=H.isIntersecting,K=H.intersectionRatio;W({isVisible:J,ratio:K}),J&&O&&(Z.unobserve(G),Z.disconnect())}))}),{threshold:B||0});return Z.observe(G),function(){Z.unobserve(G),Z.disconnect()}}}),[]),S},_=function(l){var S=l.children,O=l.ignoreDirection,B=O!==void 0&&O,W=l.size,G=W===void 0?24:W,Z=n.useContext(f).direction,Y=!B&&Z===d.TextDirection.RightToLeft,H="".concat(G||24,"px");return n.createElement("svg",{"aria-hidden":"true",className:h({"rpv-core__icon":!0,"rpv-core__icon--rtl":Y}),focusable:"false",height:H,viewBox:"0 0 24 24",width:H},S)},c=function(){return n.createElement(_,{size:16},n.createElement("path",{d:"M23.5,0.499l-16.5,23l-6.5-6.5"}))},w=function(l){var S=l.children,O=l.testId,B=l.onClick,W=n.useContext(f).direction===d.TextDirection.RightToLeft,G=O?{"data-testid":O}:{};return n.createElement("button",t({className:h({"rpv-core__primary-button":!0,"rpv-core__primary-button--rtl":W}),type:"button",onClick:B},G),S)},L=function(l){var S=l.size,O=S===void 0?"4rem":S,B=l.testId,W=n.useState(!1),G=W[0],Z=W[1],Y=B?{"data-testid":B}:{},H=g({onVisibilityChanged:function(J){Z(J.isVisible)}});return n.createElement("div",t({},Y,{className:h({"rpv-core__spinner":!0,"rpv-core__spinner--animating":G}),ref:H,style:{height:O,width:O}}))},M=function(l){var S=l.ariaLabel,O=S===void 0?"":S,B=l.autoFocus,W=B!==void 0&&B,G=l.placeholder,Z=G===void 0?"":G,Y=l.testId,H=l.type,J=H===void 0?"text":H,K=l.value,ct=K===void 0?"":K,lt=l.onChange,at=l.onKeyDown,yt=at===void 0?function(){}:at,vt=n.useContext(f).direction,pt=n.useRef(),Gt=vt===d.TextDirection.RightToLeft,xt={ref:pt,"data-testid":"","aria-label":O,className:h({"rpv-core__textbox":!0,"rpv-core__textbox--rtl":Gt}),placeholder:Z,value:ct,onChange:function(Ft){return lt(Ft.target.value)},onKeyDown:yt};return Y&&(xt["data-testid"]=Y),e((function(){if(W){var Ft=pt.current;if(Ft){var Nt=window.scrollX,Pt=window.scrollY;Ft.focus(),window.scrollTo(Nt,Pt)}}}),[]),J==="text"?n.createElement("input",t({type:"text"},xt)):n.createElement("input",t({type:"password"},xt))};(function(l){l[l.ExitFullScreen=0]="ExitFullScreen",l[l.FullScreenChange=1]="FullScreenChange",l[l.FullScreenElement=2]="FullScreenElement",l[l.FullScreenEnabled=3]="FullScreenEnabled",l[l.RequestFullScreen=4]="RequestFullScreen"})(i||(i={}));var m,C={ExitFullScreen:"exitFullscreen",FullScreenChange:"fullscreenchange",FullScreenElement:"fullscreenElement",FullScreenEnabled:"fullscreenEnabled",RequestFullScreen:"requestFullscreen"},z={ExitFullScreen:"webkitExitFullscreen",FullScreenChange:"webkitfullscreenchange",FullScreenElement:"webkitFullscreenElement",FullScreenEnabled:"webkitFullscreenEnabled",RequestFullScreen:"webkitRequestFullscreen"},$={ExitFullScreen:"msExitFullscreen",FullScreenChange:"msFullscreenChange",FullScreenElement:"msFullscreenElement",FullScreenEnabled:"msFullscreenEnabled",RequestFullScreen:"msRequestFullscreen"},j=typeof window<"u",tt=j&&(i.FullScreenEnabled in document&&C||z.FullScreenEnabled in document&&z||$.FullScreenEnabled in document&&$)||C,nt=function(){return j&&tt.FullScreenEnabled in document&&document[tt.FullScreenEnabled]===!0},bt=function(l){return j?l[tt.ExitFullScreen]():Promise.resolve({})},dt=function(){return j?document[tt.FullScreenElement]:null},mt=function(l,S){var O=n.useRef(),B=function(){O.current&&clearTimeout(O.current)};return n.useEffect((function(){return function(){return B()}}),[]),n.useCallback((function(){for(var W=[],G=0;G<arguments.length;G++)W[G]=arguments[G];B(),O.current=setTimeout((function(){l.apply(void 0,W)}),S)}),[l,S])},At=function(){var l=n.useRef(!1);return n.useEffect((function(){return l.current=!0,function(){l.current=!1}}),[]),l},ot=function(l){var S=n.useRef(l);return n.useEffect((function(){S.current=l}),[l]),S.current};(function(l){l.NotRenderedYet="NotRenderedYet",l.Rendering="Rendering",l.Rendered="Rendered"})(m||(m={}));var N,E=-9999,p=function(l){var S=l.doc,O=S.numPages,B=S.loadingTask.docId,W=n.useMemo((function(){return Array(O).fill(null).map((function(Y,H){return{pageIndex:H,renderStatus:m.NotRenderedYet,visibility:E}}))}),[B]),G=n.useRef({currentRenderingPage:-1,startRange:0,endRange:O-1,visibilities:W}),Z=function(Y,H){G.current.visibilities[Y].visibility=H};return{getHighestPriorityPage:function(){var Y=G.current.visibilities.slice(G.current.startRange,G.current.endRange+1).filter((function(lt){return lt.visibility>E}));if(!Y.length)return-1;for(var H=Y[0].pageIndex,J=Y[Y.length-1].pageIndex,K=Y.length,ct=0;ct<K;ct++){if(Y[ct].renderStatus===m.Rendering)return-1;if(Y[ct].renderStatus===m.NotRenderedYet)return Y[ct].pageIndex}return J+1<O&&G.current.visibilities[J+1].renderStatus!==m.Rendered?J+1:H-1>=0&&G.current.visibilities[H-1].renderStatus!==m.Rendered?H-1:-1},isInRange:function(Y){return Y>=G.current.startRange&&Y<=G.current.endRange},markNotRendered:function(){for(var Y=0;Y<O;Y++)G.current.visibilities[Y].renderStatus=m.NotRenderedYet},markRendered:function(Y){G.current.visibilities[Y].renderStatus=m.Rendered},markRendering:function(Y){G.current.currentRenderingPage!==-1&&G.current.currentRenderingPage!==Y&&G.current.visibilities[G.current.currentRenderingPage].renderStatus===m.Rendering&&(G.current.visibilities[G.current.currentRenderingPage].renderStatus=m.NotRenderedYet),G.current.visibilities[Y].renderStatus=m.Rendering,G.current.currentRenderingPage=Y},setOutOfRange:function(Y){Z(Y,E)},setRange:function(Y,H){G.current.startRange=Y,G.current.endRange=H;for(var J=0;J<O;J++)(J<Y||J>H)&&(G.current.visibilities[J].visibility=E,G.current.visibilities[J].renderStatus=m.NotRenderedYet)},setVisibility:Z}},r={core:{askingPassword:{requirePasswordToOpen:"This document requires a password to open",submit:"Submit"},wrongPassword:{tryAgain:"The password is wrong. Please try again"},pageLabel:"Page {{pageIndex}}"}},v=n.createContext({l10n:r,setL10n:function(){}}),T=0,P=function(){return T++},D=function(l,S,O){var B=function(W){var G=S.current;if(G){var Z=W.target;if(Z instanceof Element&&Z.shadowRoot){var Y=W.composedPath();Y.length>0&&!G.contains(Y[0])&&O()}else G.contains(Z)||O()}};n.useEffect((function(){if(l){var W={capture:!0};return document.addEventListener("click",B,W),function(){document.removeEventListener("click",B,W)}}}),[])},R=function(l){var S=function(O){O.key==="Escape"&&l()};n.useEffect((function(){return document.addEventListener("keyup",S),function(){document.removeEventListener("keyup",S)}}),[])},a=function(l){var S=l.ariaControlsSuffix,O=l.children,B=l.closeOnClickOutside,W=l.closeOnEscape,G=l.onToggle,Z=n.useRef(),Y=n.useContext(f).direction===d.TextDirection.RightToLeft;return n.useEffect((function(){var H=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=H}}),[]),R((function(){Z.current&&W&&G()})),D(B,Z,G),e((function(){var H=Z.current;if(H){var J=.75*document.body.clientHeight;H.getBoundingClientRect().height>=J&&(H.style.overflow="auto",H.style.maxHeight="".concat(J,"px"))}}),[]),n.createElement("div",{"aria-modal":"true",className:h({"rpv-core__modal-body":!0,"rpv-core__modal-body--rtl":Y}),id:"rpv-core__modal-body-".concat(S),ref:Z,role:"dialog",tabIndex:-1},O)},b=function(l){var S=l.children;return n.createElement("div",{className:"rpv-core__modal-overlay"},S)};d.ToggleStatus=void 0,(N=d.ToggleStatus||(d.ToggleStatus={})).Close="Close",N.Open="Open",N.Toggle="Toggle";var A,k=function(l){var S=n.useState(l),O=S[0],B=S[1];return{opened:O,toggle:function(W){switch(W){case d.ToggleStatus.Close:B(!1);break;case d.ToggleStatus.Open:B(!0);break;case d.ToggleStatus.Toggle:default:B((function(G){return!G}))}}}},F=function(l){var S=l.content,O=l.isOpened,B=O!==void 0&&O,W=l.target,G=k(B),Z=G.opened,Y=G.toggle;return n.createElement(n.Fragment,null,W&&W(Y,Z),Z&&S(Y))};d.Position=void 0,(A=d.Position||(d.Position={})).TopLeft="TOP_LEFT",A.TopCenter="TOP_CENTER",A.TopRight="TOP_RIGHT",A.RightTop="RIGHT_TOP",A.RightCenter="RIGHT_CENTER",A.RightBottom="RIGHT_BOTTOM",A.BottomLeft="BOTTOM_LEFT",A.BottomCenter="BOTTOM_CENTER",A.BottomRight="BOTTOM_RIGHT",A.LeftTop="LEFT_TOP",A.LeftCenter="LEFT_CENTER",A.LeftBottom="LEFT_BOTTOM";var U,X,it,St,rt,st,ut,ht,gt=function(l,S,O,B,W){e((function(){var G=S.current,Z=l.current,Y=O.current;if(Z&&G&&Y){var H=Y.getBoundingClientRect(),J=(function(lt,at,yt,vt){var pt=at.getBoundingClientRect(),Gt=lt.getBoundingClientRect(),xt=Gt.height,Ft=Gt.width,Nt=0,Pt=0;switch(yt){case d.Position.TopLeft:Nt=pt.top-xt,Pt=pt.left;break;case d.Position.TopCenter:Nt=pt.top-xt,Pt=pt.left+pt.width/2-Ft/2;break;case d.Position.TopRight:Nt=pt.top-xt,Pt=pt.left+pt.width-Ft;break;case d.Position.RightTop:Nt=pt.top,Pt=pt.left+pt.width;break;case d.Position.RightCenter:Nt=pt.top+pt.height/2-xt/2,Pt=pt.left+pt.width;break;case d.Position.RightBottom:Nt=pt.top+pt.height-xt,Pt=pt.left+pt.width;break;case d.Position.BottomLeft:Nt=pt.top+pt.height,Pt=pt.left;break;case d.Position.BottomCenter:Nt=pt.top+pt.height,Pt=pt.left+pt.width/2-Ft/2;break;case d.Position.BottomRight:Nt=pt.top+pt.height,Pt=pt.left+pt.width-Ft;break;case d.Position.LeftTop:Nt=pt.top,Pt=pt.left-Ft;break;case d.Position.LeftCenter:Nt=pt.top+pt.height/2-xt/2,Pt=pt.left-Ft;break;case d.Position.LeftBottom:Nt=pt.top+pt.height-xt,Pt=pt.left-Ft}return{left:Pt+(vt.left||0),top:Nt+(vt.top||0)}})(Z,G,B,W),K=J.top,ct=J.left;Z.style.top="".concat(K-H.top,"px"),Z.style.left="".concat(ct-H.left,"px")}}),[])},Ct=function(l){var S,O=l.customClassName,B=l.position;return n.createElement("div",{className:h((S={"rpv-core__arrow":!0,"rpv-core__arrow--tl":B===d.Position.TopLeft,"rpv-core__arrow--tc":B===d.Position.TopCenter,"rpv-core__arrow--tr":B===d.Position.TopRight,"rpv-core__arrow--rt":B===d.Position.RightTop,"rpv-core__arrow--rc":B===d.Position.RightCenter,"rpv-core__arrow--rb":B===d.Position.RightBottom,"rpv-core__arrow--bl":B===d.Position.BottomLeft,"rpv-core__arrow--bc":B===d.Position.BottomCenter,"rpv-core__arrow--br":B===d.Position.BottomRight,"rpv-core__arrow--lt":B===d.Position.LeftTop,"rpv-core__arrow--lc":B===d.Position.LeftCenter,"rpv-core__arrow--lb":B===d.Position.LeftBottom},S["".concat(O)]=O!=="",S))})},Lt=function(l){var S=l.ariaControlsSuffix,O=l.children,B=l.closeOnClickOutside,W=l.offset,G=l.position,Z=l.targetRef,Y=l.onClose,H=n.useRef(),J=n.useRef(),K=n.useRef(),ct=n.useContext(f).direction===d.TextDirection.RightToLeft;D(B,H,Y),gt(H,Z,K,G,W),e((function(){var at=J.current;if(at){var yt=.75*document.body.clientHeight;at.getBoundingClientRect().height>=yt&&(at.style.overflow="auto",at.style.maxHeight="".concat(yt,"px"))}}),[]);var lt="rpv-core__popover-body-inner-".concat(S);return n.createElement(n.Fragment,null,n.createElement("div",{ref:K,style:{left:0,position:"absolute",top:0}}),n.createElement("div",{"aria-describedby":lt,className:h({"rpv-core__popover-body":!0,"rpv-core__popover-body--rtl":ct}),id:"rpv-core__popover-body-".concat(S),ref:H,role:"dialog",tabIndex:-1},n.createElement(Ct,{customClassName:"rpv-core__popover-body-arrow",position:G}),n.createElement("div",{id:lt,ref:J},O)))},Bt=function(l){var S=l.closeOnEscape,O=l.onClose,B=n.useRef();return R((function(){B.current&&S&&O()})),n.createElement("div",{className:"rpv-core__popover-overlay",ref:B})},Xt=function(l){var S=l.ariaControlsSuffix,O=l.children,B=l.contentRef,W=l.offset,G=l.position,Z=l.targetRef,Y=n.useRef(),H=n.useContext(f).direction===d.TextDirection.RightToLeft;return gt(B,Z,Y,G,W),n.createElement(n.Fragment,null,n.createElement("div",{ref:Y,style:{left:0,position:"absolute",top:0}}),n.createElement("div",{className:h({"rpv-core__tooltip-body":!0,"rpv-core__tooltip-body--rtl":H}),id:"rpv-core__tooltip-body-".concat(S),ref:B,role:"tooltip"},n.createElement(Ct,{customClassName:"rpv-core__tooltip-body-arrow",position:G}),n.createElement("div",{className:"rpv-core__tooltip-body-content"},O)))};d.FullScreenMode=void 0,(U=d.FullScreenMode||(d.FullScreenMode={})).Normal="Normal",U.Entering="Entering",U.Entered="Entered",U.EnteredCompletely="EnteredCompletely",U.Exitting="Exitting",U.Exited="Exited",d.LayerRenderStatus=void 0,(X=d.LayerRenderStatus||(d.LayerRenderStatus={}))[X.PreRender=0]="PreRender",X[X.DidRender=1]="DidRender",d.PageMode=void 0,(it=d.PageMode||(d.PageMode={})).Attachments="UseAttachments",it.Bookmarks="UseOutlines",it.ContentGroup="UseOC",it.Default="UserNone",it.FullScreen="FullScreen",it.Thumbnails="UseThumbs",d.PasswordStatus=void 0,(St=d.PasswordStatus||(d.PasswordStatus={})).RequiredPassword="RequiredPassword",St.WrongPassword="WrongPassword",d.RotateDirection=void 0,(rt=d.RotateDirection||(d.RotateDirection={})).Backward="Backward",rt.Forward="Forward",d.ScrollMode=void 0,(st=d.ScrollMode||(d.ScrollMode={})).Page="Page",st.Horizontal="Horizontal",st.Vertical="Vertical",st.Wrapped="Wrapped",d.SpecialZoomLevel=void 0,(ut=d.SpecialZoomLevel||(d.SpecialZoomLevel={})).ActualSize="ActualSize",ut.PageFit="PageFit",ut.PageWidth="PageWidth",d.ViewMode=void 0,(ht=d.ViewMode||(d.ViewMode={})).DualPage="DualPage",ht.DualPageWithCover="DualPageWithCover",ht.SinglePage="SinglePage";var $t,ne=function(l,S){return l.reduce((function(O,B,W){return W%S?O[O.length-1].push(B):O.push([B]),O}),[])},Me=function(l,S){switch(S[1].name){case"XYZ":return{bottomOffset:function(O,B){return S[3]===null?B:S[3]},leftOffset:function(O,B){return S[2]===null?0:S[2]},pageIndex:l,scaleTo:S[4]};case"Fit":case"FitB":return{bottomOffset:0,leftOffset:0,pageIndex:l,scaleTo:d.SpecialZoomLevel.PageFit};case"FitH":case"FitBH":return{bottomOffset:S[2],leftOffset:0,pageIndex:l,scaleTo:d.SpecialZoomLevel.PageWidth};default:return{bottomOffset:0,leftOffset:0,pageIndex:l,scaleTo:1}}},Ae=new Map,je=new Map,Pe=function(l,S){return"".concat(l.loadingTask.docId,"___").concat(S.num,"R").concat(S.gen===0?"":S.gen)},Oe=function(l,S,O){Ae.set(Pe(l,S),O)},qe=function(l,S){if(!l)return Promise.reject("The document is not loaded yet");var O="".concat(l.loadingTask.docId,"___").concat(S),B=je.get(O);return B?Promise.resolve(B):new Promise((function(W,G){l.getPage(S+1).then((function(Z){je.set(O,Z),Z.ref&&Oe(l,Z.ref,S),W(Z)}))}))},un=function(l,S){return new Promise((function(O){new Promise((function(B){typeof S=="string"?l.getDestination(S).then((function(W){B(W)})):B(S)})).then((function(B){if(typeof B[0]=="object"&&B[0]!==null){var W=B[0],G=(function(Y,H){var J=Pe(Y,H);return Ae.has(J)?Ae.get(J):null})(l,W);G===null?l.getPageIndex(W).then((function(Y){Oe(l,W,Y),un(l,S).then((function(H){return O(H)}))})):O(Me(G,B))}else{var Z=Me(B[0],B);O(Z)}}))}))};(function(l){l[l.Solid=1]="Solid",l[l.Dashed=2]="Dashed",l[l.Beveled=3]="Beveled",l[l.Inset=4]="Inset",l[l.Underline=5]="Underline"})($t||($t={}));var Ne,_t=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),et=function(l,S,O,B){var W=parseInt(l,10);return W>=S&&W<=O?W:B},Q=function(l){return l.contentsObj?l.contentsObj.str:l.contents||""},Et=function(l){return l.titleObj?l.titleObj.str:l.title||""},oe=function(l){var S=l.annotation,O=n.useContext(f).direction,B=Et(S),W=Q(S),G=O===d.TextDirection.RightToLeft,Z=n.useRef(),Y="";if(S.modificationDate){var H=(function(J){var K=_t.exec(J);if(!K)return null;var ct=parseInt(K[1],10),lt=et(K[2],1,12,1)-1,at=et(K[3],1,31,1),yt=et(K[4],0,23,0),vt=et(K[5],0,59,0),pt=et(K[6],0,59,0),Gt=K[7]||"Z",xt=et(K[8],0,23,0),Ft=et(K[9],0,59,0);switch(Gt){case"-":yt+=xt,vt+=Ft;break;case"+":yt-=xt,vt-=Ft}return new Date(Date.UTC(ct,lt,at,yt,vt,pt))})(S.modificationDate);Y=H?"".concat(H.toLocaleDateString(),", ").concat(H.toLocaleTimeString()):""}return n.useLayoutEffect((function(){if(Z.current){var J=document.querySelector('[data-annotation-id="'.concat(S.id,'"]'));if(J){var K=J;return K.style.zIndex+=1,function(){K.style.zIndex="".concat(parseInt(K.style.zIndex,10)-1)}}}}),[]),n.createElement("div",{ref:Z,className:h({"rpv-core__annotation-popup-wrapper":!0,"rpv-core__annotation-popup-wrapper--rtl":G}),style:{top:S.annotationType===d.AnnotationType.Popup?"":"100%"}},B&&n.createElement(n.Fragment,null,n.createElement("div",{className:h({"rpv-core__annotation-popup-title":!0,"rpv-core__annotation-popup-title--ltr":!G,"rpv-core__annotation-popup-title--rtl":G})},B),n.createElement("div",{className:"rpv-core__annotation-popup-date"},Y)),W&&n.createElement("div",{className:"rpv-core__annotation-popup-content"},W.split(`
`).map((function(J,K){return n.createElement(n.Fragment,{key:K},J,n.createElement("br",null))}))))};(function(l){l.Click="Click",l.Hover="Hover"})(Ne||(Ne={}));var Wt,Qt=function(l){var S,O=l.annotation,B=l.children,W=l.ignoreBorder,G=l.hasPopup,Z=l.isRenderable,Y=l.page,H=l.viewport,J=O.rect,K=(function(){var It=k(!1),te=It.opened,Zt=It.toggle,ee=n.useState(Ne.Hover),ie=ee[0],se=ee[1];return{opened:te,closeOnHover:function(){ie===Ne.Hover&&Zt(d.ToggleStatus.Close)},openOnHover:function(){ie===Ne.Hover&&Zt(d.ToggleStatus.Open)},toggleOnClick:function(){switch(ie){case Ne.Click:te&&se(Ne.Hover),Zt(d.ToggleStatus.Toggle);break;case Ne.Hover:se(Ne.Click),Zt(d.ToggleStatus.Open)}}}})(),ct=K.closeOnHover,lt=K.opened,at=K.openOnHover,yt=K.toggleOnClick,vt=(S=[J[0],Y.view[3]+Y.view[1]-J[1],J[2],Y.view[3]+Y.view[1]-J[3]],[Math.min(S[0],S[2]),Math.min(S[1],S[3]),Math.max(S[0],S[2]),Math.max(S[1],S[3])]),pt=J[2]-J[0],Gt=J[3]-J[1],xt={borderColor:"",borderRadius:"",borderStyle:"",borderWidth:""};if(!W&&O.borderStyle.width>0){switch(O.borderStyle.style){case $t.Dashed:xt.borderStyle="dashed";break;case $t.Solid:xt.borderStyle="solid";break;case $t.Underline:xt=Object.assign({borderBottomStyle:"solid"},xt);case $t.Beveled:case $t.Inset:}var Ft=O.borderStyle.width;xt.borderWidth="".concat(Ft,"px"),O.borderStyle.style!==$t.Underline&&(pt-=2*Ft,Gt-=2*Ft);var Nt=O.borderStyle,Pt=Nt.horizontalCornerRadius,Ht=Nt.verticalCornerRadius;(Pt>0||Ht>0)&&(xt.borderRadius="".concat(Pt,"px / ").concat(Ht,"px")),O.color?xt.borderColor="rgb(".concat(0|O.color[0],", ").concat(0|O.color[1],", ").concat(0|O.color[2],")"):xt.borderWidth="0"}return n.createElement(n.Fragment,null,Z&&B({popup:{opened:lt,closeOnHover:ct,openOnHover:at,toggleOnClick:yt},slot:{attrs:{style:Object.assign({height:"".concat(Gt,"px"),left:"".concat(vt[0],"px"),top:"".concat(vt[1],"px"),transform:"matrix(".concat(H.transform.join(","),")"),transformOrigin:"-".concat(vt[0],"px -").concat(vt[1],"px"),width:"".concat(pt,"px")},xt)},children:n.createElement(n.Fragment,null,G&&lt&&n.createElement(oe,{annotation:O}))}}))},Ge=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z);return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--caret","data-annotation-id":S.id,onClick:H.popup.toggleOnClick,onMouseEnter:H.popup.openOnHover,onMouseLeave:H.popup.closeOnHover}),H.slot.children)}))},Xe=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z),H=S.rect,J=H[2]-H[0],K=H[3]-H[1],ct=S.borderStyle.width;return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(lt){return n.createElement("div",t({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--circle","data-annotation-id":S.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("circle",{cy:K/2,fill:"none",rx:J/2-ct/2,ry:K/2-ct/2,stroke:"transparent",strokeWidth:ct||1})),lt.slot.children)}))},ze=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=Et(S),G=Q(S),Z=!(S.hasPopup!==!1||!W&&!G),Y=function(){var H,J,K,ct,lt=S.file;lt&&(H=lt.filename,J=lt.content,K=typeof J=="string"?"":URL.createObjectURL(new Blob([J],{type:""})),(ct=document.createElement("a")).style.display="none",ct.href=K||H,ct.setAttribute("download",(function(at){var yt=at.split("/").pop();return yt?yt.split("#")[0].split("?")[0]:at})(H)),document.body.appendChild(ct),ct.click(),document.body.removeChild(ct),K&&URL.revokeObjectURL(K))};return n.createElement(Qt,{annotation:S,hasPopup:Z,ignoreBorder:!0,isRenderable:!0,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--file-attachment","data-annotation-id":S.id,onClick:H.popup.toggleOnClick,onDoubleClick:Y,onMouseEnter:H.popup.openOnHover,onMouseLeave:H.popup.closeOnHover}),H.slot.children)}))},xe=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z);return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--free-text","data-annotation-id":S.id,onClick:H.popup.toggleOnClick,onMouseEnter:H.popup.openOnHover,onMouseLeave:H.popup.closeOnHover}),H.slot.children)}))},Ue=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=Et(S),G=Q(S),Z=!(!W&&!G),Y=!S.parentType||["Circle","Ink","Line","Polygon","PolyLine","Square"].indexOf(S.parentType)!==-1;return e((function(){if(S.parentId){var H=document.querySelector('[data-annotation-id="'.concat(S.parentId,'"]')),J=document.querySelector('[data-annotation-id="'.concat(S.id,'"]'));if(H&&J){var K=parseFloat(H.style.left),ct=parseFloat(H.style.top)+parseFloat(H.style.height);J.style.left="".concat(K,"px"),J.style.top="".concat(ct,"px"),J.style.transformOrigin="-".concat(K,"px -").concat(ct,"px")}}}),[]),n.createElement(Qt,{annotation:S,hasPopup:Y,ignoreBorder:!1,isRenderable:Z,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--popup","data-annotation-id":S.id}),n.createElement(oe,{annotation:S}))}))},Be=function(l){var S=l.annotation,O=l.childAnnotation,B=l.page,W=l.viewport,G=S.hasPopup===!1,Z=Et(S),Y=Q(S),H=!!(S.hasPopup||Z||Y);if(S.quadPoints&&S.quadPoints.length>0){var J=S.quadPoints.map((function(K){return Object.assign({},S,{rect:[K[2].x,K[2].y,K[1].x,K[1].y],quadPoints:[]})}));return n.createElement(n.Fragment,null,J.map((function(K,ct){return n.createElement(Be,{key:ct,annotation:K,childAnnotation:O,page:B,viewport:W})})))}return n.createElement(Qt,{annotation:S,hasPopup:G,ignoreBorder:!0,isRenderable:H,page:B,viewport:W},(function(K){return n.createElement(n.Fragment,null,n.createElement("div",t({},K.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--highlight","data-annotation-id":S.id,onClick:K.popup.toggleOnClick,onMouseEnter:K.popup.openOnHover,onMouseLeave:K.popup.closeOnHover}),K.slot.children),O&&O.annotationType===d.AnnotationType.Popup&&K.popup.opened&&n.createElement(Ue,{annotation:O,page:B,viewport:W}))}))},rn=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z),H=S.rect,J=H[2]-H[0],K=H[3]-H[1],ct=S.borderStyle.width;return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(lt){return n.createElement("div",t({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--ink","data-annotation-id":S.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),S.inkLists&&S.inkLists.length&&n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},S.inkLists.map((function(at,yt){return n.createElement("polyline",{key:yt,fill:"none",stroke:"transparent",strokeWidth:ct||1,points:at.map((function(vt){return"".concat(vt.x-H[0],",").concat(H[3]-vt.y)})).join(" ")})}))),lt.slot.children)}))},Se=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z),H=S.rect,J=H[2]-H[0],K=H[3]-H[1],ct=S.borderStyle.width;return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(lt){return n.createElement("div",t({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--line","data-annotation-id":S.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("line",{stroke:"transparent",strokeWidth:ct||1,x1:H[2]-S.lineCoordinates[0],x2:H[2]-S.lineCoordinates[2],y1:H[3]-S.lineCoordinates[1],y2:H[3]-S.lineCoordinates[3]})),lt.slot.children)}))},sn=/^([^\w]*)(javascript|data|vbscript)/im,an=/&#(\w+)(^\w|;)?/g,hn=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,dn=/^([^:]+):/gm,Qe=function(l,S){var O,B=(O=l||"",O.replace(an,(function(Y,H){return String.fromCharCode(H)}))).replace(hn,"").trim();if(!B)return S;var W=B[0];if(W==="."||W==="/")return B;var G=B.match(dn);if(!G)return B;var Z=G[0];return sn.test(Z)?S:B},Fe=function(l){var S,O=l.annotation,B=l.annotationContainerRef,W=l.doc,G=l.outlines,Z=l.page,Y=l.pageIndex,H=l.scale,J=l.viewport,K=l.onExecuteNamedAction,ct=l.onJumpFromLinkAnnotation,lt=l.onJumpToDest,at=n.useRef(),yt=G&&G.length&&O.dest&&typeof O.dest=="string"?(S=G.find((function(xt){return xt.dest===O.dest})))===null||S===void 0?void 0:S.title:"",vt=!!(O.url||O.dest||O.action||O.unsafeUrl),pt={};if(O.url||O.unsafeUrl){var Gt=Qe(O.url||O.unsafeUrl,"");Gt?pt={"data-target":"external",href:Gt,rel:"noopener noreferrer nofollow",target:O.newWindow?"_blank":"",title:Gt}:vt=!1}else pt={href:"","data-annotation-link":O.id,onClick:function(xt){xt.preventDefault(),O.action?K(O.action):un(W,O.dest).then((function(Ft){var Nt=at.current,Pt=B.current;if(Nt&&Pt){var Ht=Nt.getBoundingClientRect();Pt.style.setProperty("height","100%"),Pt.style.setProperty("width","100%");var It=Pt.getBoundingClientRect();Pt.style.removeProperty("height"),Pt.style.removeProperty("width");var te=(Ht.left-It.left)/H,Zt=(It.bottom-Ht.bottom+Ht.height)/H;ct({bottomOffset:Zt,label:yt,leftOffset:te,pageIndex:Y})}lt(Ft)}))}};return yt&&(pt=Object.assign({},pt,{title:yt,"aria-label":yt})),n.createElement(Qt,{annotation:O,hasPopup:!1,ignoreBorder:!1,isRenderable:vt,page:Z,viewport:J},(function(xt){return n.createElement("div",t({},xt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--link","data-annotation-id":O.id,"data-testid":"core__annotation--link-".concat(O.id)}),n.createElement("a",t({ref:at},pt)))}))},tn=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z),H=S.rect,J=H[2]-H[0],K=H[3]-H[1],ct=S.borderStyle.width;return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(lt){return n.createElement("div",t({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polygon","data-annotation-id":S.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),S.vertices&&S.vertices.length&&n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("polygon",{fill:"none",stroke:"transparent",strokeWidth:ct||1,points:S.vertices.map((function(at){return"".concat(at.x-H[0],",").concat(H[3]-at.y)})).join(" ")})),lt.slot.children)}))},fn=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z),H=S.rect,J=H[2]-H[0],K=H[3]-H[1],ct=S.borderStyle.width;return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(lt){return n.createElement("div",t({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polyline","data-annotation-id":S.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),S.vertices&&S.vertices.length&&n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("polyline",{fill:"none",stroke:"transparent",strokeWidth:ct||1,points:S.vertices.map((function(at){return"".concat(at.x-H[0],",").concat(H[3]-at.y)})).join(" ")})),lt.slot.children)}))},Qn=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z),H=S.rect,J=H[2]-H[0],K=H[3]-H[1],ct=S.borderStyle.width;return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(lt){return n.createElement("div",t({},lt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--square","data-annotation-id":S.id,onClick:lt.popup.toggleOnClick,onMouseEnter:lt.popup.openOnHover,onMouseLeave:lt.popup.closeOnHover}),n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("rect",{height:K-ct,fill:"none",stroke:"transparent",strokeWidth:ct||1,x:ct/2,y:ct/2,width:J-ct})),lt.slot.children)}))},ti=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z);return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--squiggly","data-annotation-id":S.id,onClick:H.popup.toggleOnClick,onMouseEnter:H.popup.openOnHover,onMouseLeave:H.popup.closeOnHover}),H.slot.children)}))},ei=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z);return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--stamp","data-annotation-id":S.id,onClick:H.popup.toggleOnClick,onMouseEnter:H.popup.openOnHover,onMouseLeave:H.popup.closeOnHover}),H.slot.children)}))},ni=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z);return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--strike-out","data-annotation-id":S.id,onClick:H.popup.toggleOnClick,onMouseEnter:H.popup.openOnHover,onMouseLeave:H.popup.closeOnHover}),H.slot.children)}))},ii=function(){return n.createElement(_,{size:16},n.createElement("path",{d:"M.5,16.5a1,1,0,0,0,1,1h2v4l4-4h15a1,1,0,0,0,1-1V3.5a1,1,0,0,0-1-1H1.5a1,1,0,0,0-1,1Z"}),n.createElement("path",{d:"M7.25,9.75A.25.25,0,1,1,7,10a.25.25,0,0,1,.25-.25"}),n.createElement("path",{d:"M12,9.75a.25.25,0,1,1-.25.25A.25.25,0,0,1,12,9.75"}),n.createElement("path",{d:"M16.75,9.75a.25.25,0,1,1-.25.25.25.25,0,0,1,.25-.25"}))},ri=function(){return n.createElement(_,{size:16},n.createElement("path",{d:"M0.500 12.001 A11.500 11.500 0 1 0 23.500 12.001 A11.500 11.500 0 1 0 0.500 12.001 Z"}),n.createElement("path",{d:"M6.000 12.001 A6.000 6.000 0 1 0 18.000 12.001 A6.000 6.000 0 1 0 6.000 12.001 Z"}),n.createElement("path",{d:"M21.423 5.406L17.415 9.414"}),n.createElement("path",{d:"M14.587 6.585L18.607 2.565"}),n.createElement("path",{d:"M5.405 21.424L9.413 17.416"}),n.createElement("path",{d:"M6.585 14.588L2.577 18.596"}),n.createElement("path",{d:"M18.602 21.419L14.595 17.412"}),n.createElement("path",{d:"M17.419 14.58L21.428 18.589"}),n.createElement("path",{d:"M2.582 5.399L6.588 9.406"}),n.createElement("path",{d:"M9.421 6.581L5.412 2.572"}))},si=function(){return n.createElement(_,{size:16},n.createElement("path",{d:"M4.000 18.500 A1.500 1.500 0 1 0 7.000 18.500 A1.500 1.500 0 1 0 4.000 18.500 Z"}),n.createElement("path",{d:"M20.5.5l-9.782,9.783a7,7,0,1,0,3,3L17,10h1.5V8.5L19,8h1.5V6.5L21,6h1.5V4.5l1-1V.5Z"}))},ai=function(){return n.createElement(_,{size:16},n.createElement("path",{d:"M2.000 2.500 L22.000 2.500 L22.000 23.500 L2.000 23.500 Z"}),n.createElement("path",{d:"M6 4.5L6 0.5"}),n.createElement("path",{d:"M18 4.5L18 0.5"}),n.createElement("path",{d:"M10 4.5L10 0.5"}),n.createElement("path",{d:"M14 4.5L14 0.5"}))},oi=function(){return n.createElement(_,{size:16},n.createElement("path",{d:"M17.5 0.498L17.5 23.498"}),n.createElement("path",{d:"M10.5 0.498L10.5 23.498"}),n.createElement("path",{d:"M23.5.5H6.5a6,6,0,0,0,0,12h4"}))},li=function(){return n.createElement(_,{size:16},n.createElement("path",{d:"M2.5 22.995L12 6.005 21.5 22.995 2.5 22.995z"}))},ci=function(l){var S=l.annotation,O=l.childAnnotation,B=l.page,W=l.viewport,G=S.hasPopup===!1,Z=Et(S),Y=Q(S),H=!!(S.hasPopup||Z||Y),J=S.name?S.name.toLowerCase():"";return n.createElement(Qt,{annotation:S,hasPopup:G,ignoreBorder:!1,isRenderable:H,page:B,viewport:W},(function(K){return n.createElement(n.Fragment,null,n.createElement("div",t({},K.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--text","data-annotation-id":S.id,onClick:K.popup.toggleOnClick,onMouseEnter:K.popup.openOnHover,onMouseLeave:K.popup.closeOnHover}),J&&n.createElement("div",{className:"rpv-core__annotation-text-icon"},J==="check"&&n.createElement(c,null),J==="comment"&&n.createElement(ii,null),J==="help"&&n.createElement(ri,null),J==="insert"&&n.createElement(li,null),J==="key"&&n.createElement(si,null),J==="note"&&n.createElement(ai,null),(J==="newparagraph"||J==="paragraph")&&n.createElement(oi,null)),K.slot.children),O&&O.annotationType===d.AnnotationType.Popup&&K.popup.opened&&n.createElement(Ue,{annotation:O,page:B,viewport:W}))}))},ui=function(l){var S=l.annotation,O=l.page,B=l.viewport,W=S.hasPopup===!1,G=Et(S),Z=Q(S),Y=!!(S.hasPopup||G||Z);return n.createElement(Qt,{annotation:S,hasPopup:W,ignoreBorder:!0,isRenderable:Y,page:O,viewport:B},(function(H){return n.createElement("div",t({},H.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--underline","data-annotation-id":S.id,onClick:H.popup.toggleOnClick,onMouseEnter:H.popup.openOnHover,onMouseLeave:H.popup.closeOnHover}),H.slot.children)}))},hi=function(l){var S=l.annotations,O=l.doc,B=l.outlines,W=l.page,G=l.pageIndex,Z=l.plugins,Y=l.rotation,H=l.scale,J=l.onExecuteNamedAction,K=l.onJumpFromLinkAnnotation,ct=l.onJumpToDest,lt=n.useRef(),at=W.getViewport({rotation:Y,scale:H}).clone({dontFlip:!0}),yt=S.filter((function(vt){return!vt.parentId}));return e((function(){var vt=lt.current;vt&&Z.forEach((function(pt){pt.onAnnotationLayerRender&&pt.onAnnotationLayerRender({annotations:yt,container:vt,pageIndex:G,rotation:Y,scale:H})}))}),[]),n.createElement("div",{ref:lt,className:"rpv-core__annotation-layer","data-testid":"core__annotation-layer-".concat(G)},yt.map((function(vt){var pt=S.find((function(Gt){return Gt.parentId===vt.id}));switch(vt.annotationType){case d.AnnotationType.Caret:return n.createElement(Ge,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Circle:return n.createElement(Xe,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.FileAttachment:return n.createElement(ze,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.FreeText:return n.createElement(xe,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Highlight:return n.createElement(Be,{key:vt.id,annotation:vt,childAnnotation:pt,page:W,viewport:at});case d.AnnotationType.Ink:return n.createElement(rn,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Line:return n.createElement(Se,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Link:return n.createElement(Fe,{key:vt.id,annotation:vt,annotationContainerRef:lt,doc:O,outlines:B,page:W,pageIndex:G,scale:H,viewport:at,onExecuteNamedAction:J,onJumpFromLinkAnnotation:K,onJumpToDest:ct});case d.AnnotationType.Polygon:return n.createElement(tn,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Polyline:return n.createElement(fn,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Popup:return n.createElement(Ue,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Square:return n.createElement(Qn,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Squiggly:return n.createElement(ti,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Stamp:return n.createElement(ei,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.StrikeOut:return n.createElement(ni,{key:vt.id,annotation:vt,page:W,viewport:at});case d.AnnotationType.Text:return n.createElement(ci,{key:vt.id,annotation:vt,childAnnotation:pt,page:W,viewport:at});case d.AnnotationType.Underline:return n.createElement(ui,{key:vt.id,annotation:vt,page:W,viewport:at});default:return n.createElement(n.Fragment,{key:vt.id})}})))},di=function(l){var S=l.page,O=l.renderAnnotations,B=At(),W=n.useState({loading:!0,annotations:[]}),G=W[0],Z=W[1];return n.useEffect((function(){S.getAnnotations({intent:"display"}).then((function(Y){B.current&&Z({loading:!1,annotations:Y})}))}),[]),G.loading?n.createElement(n.Fragment,null):O(G.annotations)},fi=function(l){var S=l.doc,O=l.outlines,B=l.page,W=l.pageIndex,G=l.plugins,Z=l.rotation,Y=l.scale,H=l.onExecuteNamedAction,J=l.onJumpFromLinkAnnotation,K=l.onJumpToDest;return n.createElement(di,{page:B,renderAnnotations:function(ct){return n.createElement(hi,{annotations:ct,doc:S,outlines:O,page:B,pageIndex:W,plugins:G,rotation:Z,scale:Y,onExecuteNamedAction:H,onJumpFromLinkAnnotation:J,onJumpToDest:K})}})},mn=function(l,S){var O=l%S;return O===0?l:Math.floor(l-O)},pi=function(l){var S=l.canvasLayerRef,O=l.height,B=l.page,W=l.pageIndex,G=l.plugins,Z=l.rotation,Y=l.scale,H=l.width,J=l.onRenderCanvasCompleted,K=n.useRef();return e((function(){var ct=K.current;ct&&ct.cancel();var lt=S.current;lt.removeAttribute("data-testid"),G.forEach((function(It){It.onCanvasLayerRender&&It.onCanvasLayerRender({ele:lt,pageIndex:W,rotation:Z,scale:Y,status:d.LayerRenderStatus.PreRender})}));var at=B.getViewport({rotation:Z,scale:Y}),yt=window.devicePixelRatio||1,vt=Math.sqrt(16777216/(at.width*at.height)),pt=yt>vt;pt?lt.style.transform="scale(1, 1)":lt.style.removeProperty("transform");var Gt=Math.min(vt,yt),xt=(function(It,te){var Zt,ee;if(Math.floor(It)===It)return[It,1];var ie=1/It;if(ie>te)return[1,te];if(Math.floor(ie)===ie)return[1,ie];for(var se=It>1?ie:It,be=0,fe=1,ye=1,ge=1;;){var ve=be+ye,_e=fe+ge;if(_e>te)break;se<=ve/_e?(ye=(Zt=[ve,_e])[0],ge=Zt[1]):(be=(ee=[ve,_e])[0],fe=ee[1])}return se<(be/fe+ye/ge)/2?se===It?[be,fe]:[fe,be]:se===It?[ye,ge]:[ge,ye]})(Gt,8),Ft=xt[0],Nt=xt[1];lt.width=mn(at.width*Gt,Ft),lt.height=mn(at.height*Gt,Ft),lt.style.width="".concat(mn(at.width,Nt),"px"),lt.style.height="".concat(mn(at.height,Nt),"px"),lt.hidden=!0;var Pt=lt.getContext("2d",{alpha:!1}),Ht=pt||yt!==1?[Gt,0,0,Gt,0,0]:null;return K.current=B.render({canvasContext:Pt,transform:Ht,viewport:at}),K.current.promise.then((function(){lt.hidden=!1,lt.setAttribute("data-testid","core__canvas-layer-".concat(W)),G.forEach((function(It){It.onCanvasLayerRender&&It.onCanvasLayerRender({ele:lt,pageIndex:W,rotation:Z,scale:Y,status:d.LayerRenderStatus.DidRender})})),J()}),(function(){J()})),function(){lt&&(lt.width=0,lt.height=0)}}),[]),n.createElement("div",{className:"rpv-core__canvas-layer",style:{height:"".concat(O,"px"),width:"".concat(H,"px")}},n.createElement("canvas",{ref:S}))},gi=function(l){var S=l.height,O=l.page,B=l.rotation,W=l.scale,G=l.width,Z=n.useRef();return e((function(){var Y=Z.current,H=O.getViewport({rotation:B,scale:W});O.getOperatorList().then((function(J){(function(){var K=Z.current;K&&(K.innerHTML="")})(),new x.SVGGraphics(O.commonObjs,O.objs).getSVG(J,H).then((function(K){K.style.height="".concat(S,"px"),K.style.width="".concat(G,"px"),Y.appendChild(K)}))}))}),[]),n.createElement("div",{className:"rpv-core__svg-layer",ref:Z})},mi=function(l){var S=l.containerRef,O=l.page,B=l.pageIndex,W=l.plugins,G=l.rotation,Z=l.scale,Y=l.onRenderTextCompleted,H=n.useRef(),J=function(){var K=S.current;K&&([].slice.call(K.querySelectorAll(".rpv-core__text-layer-text")).forEach((function(ct){return K.removeChild(ct)})),[].slice.call(K.querySelectorAll('br[role="presentation"]')).forEach((function(ct){return K.removeChild(ct)})))};return e((function(){var K=H.current;K&&K.cancel();var ct=S.current;if(ct){ct.removeAttribute("data-testid");var lt=O.getViewport({rotation:G,scale:Z});return W.forEach((function(at){at.onTextLayerRender&&at.onTextLayerRender({ele:ct,pageIndex:B,scale:Z,status:d.LayerRenderStatus.PreRender})})),O.getTextContent().then((function(at){J(),H.current=x.renderTextLayer({container:ct,textContent:at,textContentSource:at,viewport:lt}),H.current.promise.then((function(){ct.setAttribute("data-testid","core__text-layer-".concat(B)),[].slice.call(ct.children).forEach((function(yt){yt.classList.contains("rpv-core__text-layer-text--not")||yt.classList.add("rpv-core__text-layer-text")})),W.forEach((function(yt){yt.onTextLayerRender&&yt.onTextLayerRender({ele:ct,pageIndex:B,scale:Z,status:d.LayerRenderStatus.DidRender})})),Y()}),(function(){ct.removeAttribute("data-testid"),Y()}))})),function(){var at;J(),(at=H.current)===null||at===void 0||at.cancel()}}}),[]),n.createElement("div",{className:"rpv-core__text-layer",ref:S})},vi=function(l){var S=l.doc,O=l.measureRef,B=l.outlines,W=l.pageIndex,G=l.pageRotation,Z=l.pageSize,Y=l.plugins,H=l.renderPage,J=l.renderQueueKey,K=l.rotation,ct=l.scale,lt=l.shouldRender,at=l.viewMode,yt=l.onExecuteNamedAction,vt=l.onJumpFromLinkAnnotation,pt=l.onJumpToDest,Gt=l.onRenderCompleted,xt=l.onRotatePage,Ft=At(),Nt=n.useState(null),Pt=Nt[0],Ht=Nt[1],It=n.useState(!1),te=It[0],Zt=It[1],ee=n.useState(!1),ie=ee[0],se=ee[1],be=n.useRef(),fe=n.useRef(),ye=Math.abs(K+G)%180==0,ge=Z.pageWidth*ct,ve=Z.pageHeight*ct,_e=ye?ge:ve,me=ye?ve:ge,ke=(Z.rotation+K+G)%360,We=n.useRef(0),He=H||function(Ce){return n.createElement(n.Fragment,null,Ce.canvasLayer.children,Ce.textLayer.children,Ce.annotationLayer.children)};return n.useEffect((function(){Ht(null),Zt(!1),se(!1)}),[G,K,ct]),n.useEffect((function(){lt&&Ft.current&&!Pt&&qe(S,W).then((function(Ce){Ft.current&&(We.current=J,Ht(Ce))}))}),[lt,Pt]),n.useEffect((function(){te&&ie&&(J!==We.current?(Ht(null),Zt(!1),se(!1)):Gt(W))}),[te,ie]),n.createElement("div",{className:h({"rpv-core__page-layer":!0,"rpv-core__page-layer--dual":at===d.ViewMode.DualPage,"rpv-core__page-layer--dual-cover":at===d.ViewMode.DualPageWithCover,"rpv-core__page-layer--single":at===d.ViewMode.SinglePage}),"data-testid":"core__page-layer-".concat(W),ref:O,style:{height:"".concat(me,"px"),width:"".concat(_e,"px")}},Pt?n.createElement(n.Fragment,null,He({annotationLayer:{attrs:{},children:n.createElement(fi,{doc:S,outlines:B,page:Pt,pageIndex:W,plugins:Y,rotation:ke,scale:ct,onExecuteNamedAction:yt,onJumpFromLinkAnnotation:vt,onJumpToDest:pt})},canvasLayer:{attrs:{},children:n.createElement(pi,{canvasLayerRef:be,height:me,page:Pt,pageIndex:W,plugins:Y,rotation:ke,scale:ct,width:_e,onRenderCanvasCompleted:function(){Ft.current&&Zt(!0)}})},canvasLayerRendered:te,doc:S,height:me,pageIndex:W,rotation:ke,scale:ct,svgLayer:{attrs:{},children:n.createElement(gi,{height:me,page:Pt,rotation:ke,scale:ct,width:_e})},textLayer:{attrs:{},children:n.createElement(mi,{containerRef:fe,page:Pt,pageIndex:W,plugins:Y,rotation:ke,scale:ct,onRenderTextCompleted:function(){Ft.current&&se(!0)}})},textLayerRendered:ie,width:_e,markRendered:Gt,onRotatePage:function(Ce){return xt(W,Ce)}}),Y.map((function(Ce,Le){return Ce.renderPageLayer?n.createElement(n.Fragment,{key:Le},Ce.renderPageLayer({canvasLayerRef:be,canvasLayerRendered:te,doc:S,height:me,pageIndex:W,rotation:ke,scale:ct,textLayerRef:fe,textLayerRendered:ie,width:_e})):n.createElement(n.Fragment,{key:Le})}))):n.createElement(L,{testId:"core__page-layer-loading-".concat(W)}))},_i=function(l,S){var O=S.rect;return l.height!==O.height||l.width!==O.width?O:l};(function(l){l.Horizontal="Horizontal",l.Vertical="Vertical",l.Both="Both"})(Wt||(Wt={}));var bi=function(l){return 1-Math.pow(1-l,4)},vn=1e-4,In={left:0,top:0},On={capture:!1,passive:!0},yi=function(l){var S=l.elementRef,O=l.enableSmoothScroll,B=l.isRtl,W=l.scrollDirection,G=l.onSmoothScroll,Z=n.useState(In),Y=Z[0],H=Z[1],J=n.useState(S.current),K=J[0],ct=J[1],lt=B?-1:1,at=n.useRef(W);at.current=W;var yt=n.useRef(In),vt=n.useRef(!0),pt=n.useCallback((function(){vt.current=!0,O&&H(yt.current),G(!1)}),[]),Gt=n.useCallback((function(){if(K){switch(at.current){case Wt.Horizontal:yt.current={left:lt*K.scrollLeft,top:0};break;case Wt.Both:yt.current={left:lt*K.scrollLeft,top:K.scrollTop};break;case Wt.Vertical:default:yt.current={left:0,top:K.scrollTop}}O&&!vt.current||H(yt.current)}}),[K]);e((function(){ct(S.current)})),e((function(){if(K)return K.addEventListener("scroll",Gt,On),function(){K.removeEventListener("scroll",Gt,On)}}),[K]);var xt=n.useCallback((function(Ft,Nt){var Pt=S.current;if(!Pt)return Promise.resolve();var Ht={left:0,top:0};switch(at.current){case Wt.Horizontal:Ht.left=lt*Ft.left;break;case Wt.Both:Ht.left=lt*Ft.left,Ht.top=Ft.top;break;case Wt.Vertical:default:Ht.top=Ft.top}return Nt?(vt.current=!1,G(!0),new Promise((function(It,te){(function(Zt,ee,ie,se,be,fe){be===void 0&&(be=function(Le){return Le}),fe===void 0&&(fe=function(){});var ye=0,ge=0,ve=!1;switch(ee){case Wt.Horizontal:ge=Zt.scrollLeft,ye=0;case Wt.Both:ge=Zt.scrollLeft,ye=Zt.scrollTop;break;case Wt.Vertical:default:ge=0,ye=Zt.scrollTop}var _e=function(){ve||(ve=!0,Zt.scrollLeft=ie.left,Zt.scrollTop=ie.top,fe())};if(Math.abs(ye-ie.top)<=vn&&ee===Wt.Vertical)_e();else if(Math.abs(ge-ie.left)<=vn&&ee===Wt.Horizontal)_e();else{var me,ke=-1,We=ge-ie.left,He=ye-ie.top,Ce=function(Le){ke===-1&&(ke=Le);var Ve=Le-ke,Ot=Math.min(Ve/se,1),Dt=be(Ot),Tt={left:ge-We*Dt,top:ye-He*Dt};switch(ee){case Wt.Horizontal:Zt.scrollLeft=Tt.left;break;case Wt.Both:Zt.scrollLeft=Tt.left,Zt.scrollTop=Tt.top;break;case Wt.Vertical:default:Zt.scrollTop=Tt.top}Math.abs(Tt.top-ie.top)<=vn&&Math.abs(Tt.left-ie.left)<=vn&&!ve&&(window.cancelAnimationFrame(me),_e()),Ve<se?me=window.requestAnimationFrame(Ce):window.cancelAnimationFrame(me)};me=window.requestAnimationFrame(Ce)}})(Pt,at.current,Ht,400,bi,(function(){pt(),It()}))}))):new Promise((function(It,te){switch(at.current){case Wt.Horizontal:Pt.scrollLeft=Ht.left;break;case Wt.Both:Pt.scrollLeft=Ht.left,Pt.scrollTop=Ht.top;break;case Wt.Vertical:default:Pt.scrollTop=Ht.top}It()}))}),[S]);return{scrollOffset:Y,scrollTo:xt}},pn=function(l,S,O){return Math.max(l,Math.min(O,S))},Ai=function(l,S){if(S!==d.ViewMode.DualPageWithCover)return 0;if(!(function(W){var G=W.length;if(G===1)return!1;for(var Z=1;Z<G;Z++)if(W[Z].height!==W[0].height||W[Z].width!==W[0].width)return!0;return!1})(l))return 2*l[0].width;var O=ne(l.slice(1),2).map((function(W){return W.length===2?W[0].width+W[1].width:W[0].width})),B=[l[0].width].concat(O);return Math.max.apply(Math,B)},Si={left:0,top:0},Ei={left:0,top:0},En={left:0,top:0},wi={left:0,top:0},Ci={height:0,width:0},Nn={left:0,top:0},Bn="data-virtual-index",Pi=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],Ti=function(l){var S=l.enableSmoothScroll,O=l.isRtl,B=l.numberOfItems,W=l.parentRef,G=l.setRenderRange,Z=l.sizes,Y=l.scrollMode,H=l.viewMode,J=n.useState(!1),K=J[0],ct=J[1],lt=n.useCallback((function(Ot){return ct(Ot)}),[]),at=n.useRef(Y);at.current=Y;var yt=n.useRef(H);yt.current=H;var vt=Y===d.ScrollMode.Wrapped||H===d.ViewMode.DualPageWithCover||H===d.ViewMode.DualPage?Wt.Both:Y===d.ScrollMode.Horizontal?Wt.Horizontal:Wt.Vertical,pt=yi({elementRef:W,enableSmoothScroll:S,isRtl:O,scrollDirection:vt,onSmoothScroll:lt}),Gt=pt.scrollOffset,xt=pt.scrollTo,Ft=(function(Ot){var Dt=Ot.elementRef,Tt=n.useState(Dt.current),kt=Tt[0],Rt=Tt[1],jt=n.useRef(!1),Ut=n.useReducer(_i,{height:0,width:0}),Mt=Ut[0],wt=Ut[1];return e((function(){Dt.current!==kt&&Rt(Dt.current)})),e((function(){if(kt&&!jt.current){jt.current=!0;var Vt=kt.getBoundingClientRect(),Yt=Vt.height,he=Vt.width;wt({rect:{height:Yt,width:he}})}}),[kt]),n.useEffect((function(){if(kt){var Vt=new ResizeObserver((function(Yt,he){Yt.forEach((function(ce){if(ce.target===kt){var Te=ce.contentRect,De=Te.height,qt=Te.width;wt({rect:{height:De,width:qt}})}}))}));return Vt.observe(kt),function(){Vt.unobserve(kt)}}}),[kt]),Mt})({elementRef:W}),Nt=n.useRef({scrollOffset:Nn,measurements:[]});Nt.current.scrollOffset=Gt;var Pt=n.useMemo((function(){return Array(B).fill(-1)}),[]),Ht=n.useState(Pt),It=Ht[0],te=Ht[1],Zt=n.useMemo((function(){var Ot=new IntersectionObserver((function(Dt){Dt.forEach((function(Tt){var kt=Tt.isIntersecting?Tt.intersectionRatio:-1,Rt=Tt.target.getAttribute(Bn);if(Rt){var jt=parseInt(Rt,10);0<=jt&&jt<B&&te((function(Ut){return Ut[jt]=kt,(function(Mt,wt,Vt){for(var Yt,he=0,ce=wt.length;he<ce;he++)!Yt&&he in wt||(Yt||(Yt=Array.prototype.slice.call(wt,0,he)),Yt[he]=wt[he]);return Mt.concat(Yt||Array.prototype.slice.call(wt))})([],Ut)}))}}))}),{threshold:Pi});return Ot}),[]),ee=n.useMemo((function(){return Y===d.ScrollMode.Page&&H===d.ViewMode.SinglePage?(function(Ot,Dt,Tt){for(var kt=[],Rt=0;Rt<Ot;Rt++){var jt={height:Math.max(Dt.height,Tt[Rt].height),width:Math.max(Dt.width,Tt[Rt].width)},Ut=Rt===0?wi:kt[Rt-1].end,Mt={left:Ut.left+jt.width,top:Ut.top+jt.height};kt[Rt]={index:Rt,start:Ut,size:jt,end:Mt,visibility:-1}}return kt})(B,Ft,Z):H===d.ViewMode.DualPageWithCover?(function(Ot,Dt,Tt,kt){for(var Rt=[],jt=0,Ut=0,Mt=En,wt=0;wt<Ot;wt++){var Vt=wt===0?{height:kt===d.ScrollMode.Page?Math.max(Dt.height,Tt[wt].height):Tt[wt].height,width:kt===d.ScrollMode.Page?Math.max(Dt.width,Tt[wt].width):Tt[wt].width}:{height:kt===d.ScrollMode.Page?Math.max(Dt.height,Tt[wt].height):Tt[wt].height,width:Math.max(Dt.width/2,Tt[wt].width)};kt===d.ScrollMode.Page?Mt=wt===0?En:{left:wt%2==0?Vt.width:0,top:Math.floor((wt-1)/2)*Vt.height+Rt[0].end.top}:wt===0?(Mt=En,jt=Tt[0].height,Ut=0):wt%2==1?(Mt={left:0,top:jt+=Ut},Ut=wt===Ot-1?Tt[wt].height:Math.max(Tt[wt].height,Tt[wt+1].height)):Mt={left:Rt[wt-1].end.left,top:jt};var Yt={left:Mt.left+Vt.width,top:Mt.top+Vt.height};Rt[wt]={index:wt,start:Mt,size:Vt,end:Yt,visibility:-1}}return Rt})(B,Ft,Z,Y):H===d.ViewMode.DualPage?(function(Ot,Dt,Tt,kt){for(var Rt=[],jt=0,Ut=0,Mt=Ei,wt=0;wt<Ot;wt++){var Vt={height:kt===d.ScrollMode.Page?Math.max(Dt.height,Tt[wt].height):Tt[wt].height,width:Math.max(Dt.width/2,Tt[wt].width)};kt===d.ScrollMode.Page?Mt={left:wt%2==0?0:Vt.width,top:Math.floor(wt/2)*Vt.height}:wt%2==0?(Mt={left:0,top:jt+=Ut},Ut=wt===Ot-1?Tt[wt].height:Math.max(Tt[wt].height,Tt[wt+1].height)):Mt={left:Rt[wt-1].end.left,top:jt};var Yt={left:Mt.left+Vt.width,top:Mt.top+Vt.height};Rt[wt]={index:wt,start:Mt,size:Vt,end:Yt,visibility:-1}}return Rt})(B,Ft,Z,Y):(function(Ot,Dt,Tt,kt){for(var Rt=[],jt=0,Ut={left:0,top:0},Mt=0,wt=Si,Vt=0;Vt<Ot;Vt++){var Yt=Tt[Vt];if(Vt===0)jt=Yt.width,Ut={left:0,top:0},Mt=Yt.height;else switch(kt){case d.ScrollMode.Wrapped:(jt+=Yt.width)<Dt.width?(wt={left:Rt[Vt-1].end.left,top:Ut.top},Mt=Math.max(Mt,Yt.height)):(jt=Yt.width,Ut={left:(wt={left:Ut.left,top:Ut.top+Mt}).left,top:wt.top},Mt=Yt.height);break;case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:wt=Rt[Vt-1].end}var he={left:wt.left+Yt.width,top:wt.top+Yt.height};Rt[Vt]={index:Vt,start:wt,size:Yt,end:he,visibility:-1}}return Rt})(B,Ft,Z,Y)}),[Y,Z,H,Ft]),ie=ee[B-1]?{height:ee[B-1].end.top,width:ee[B-1].end.left}:Ci;Nt.current.measurements=ee;var se=n.useMemo((function(){var Ot=(function(Vt,Yt,he,ce){var Te=0;switch(Vt){case Wt.Horizontal:Te=ce.left;break;case Wt.Vertical:default:Te=ce.top}var De=Yt.length-1,qt=(function(le,$e,ln,bn){for(;le<=$e;){var en=(le+$e)/2|0,gn=bn(en);if(gn<ln)le=en+1;else{if(!(gn>ln))return en;$e=en-1}}return le>0?le-1:0})(0,De,Te,(function(le){switch(Vt){case Wt.Horizontal:return Yt[le].start.left;case Wt.Both:case Wt.Vertical:default:return Yt[le].start.top}}));if(Vt===Wt.Both)for(var Re=Yt[qt].start.top;qt-1>=0&&Yt[qt-1].start.top===Re&&Yt[qt-1].start.left>=ce.left;)qt--;for(var de=qt;de<=De;){var pe={top:Yt[de].start.top-ce.top,left:Yt[de].start.left-ce.left},Ee={height:he.height-pe.top,width:he.width-pe.left};if(Vt===Wt.Horizontal&&Ee.width<0||Vt===Wt.Vertical&&Ee.height<0||Vt===Wt.Both&&(Ee.width<0||Ee.height<0))break;de++}return{start:qt,end:de}})(vt,ee,Ft,Gt),Dt=Ot.start,Tt=Ot.end,kt=It.slice(pn(0,B,Dt),pn(0,B,Tt)),Rt=Dt+kt.reduce((function(Vt,Yt,he,ce){return Yt>ce[Vt]?he:Vt}),0),jt=Rt=pn(0,B-1,Rt),Ut=G({endPage:Tt,numPages:B,startPage:Dt}),Mt=Ut.startPage,wt=Ut.endPage;switch(Mt=Math.max(Mt,0),wt=Math.min(wt,B-1),H){case d.ViewMode.DualPageWithCover:Rt>0&&(jt=Rt%2==1?Rt:Rt-1),Mt=Mt===0?0:Mt%2==1?Mt:Mt-1,B-(wt=wt%2==1?wt-1:wt)<=2&&(wt=B-1);break;case d.ViewMode.DualPage:jt=Rt%2==0?Rt:Rt-1,Mt=Mt%2==0?Mt:Mt-1,wt=wt%2==1?wt:wt-1;break;case d.ViewMode.SinglePage:default:jt=Rt}return{startPage:Mt,endPage:wt,maxVisbilityIndex:jt}}),[ee,Ft,Gt,H,It]),be=se.startPage,fe=se.endPage,ye=se.maxVisbilityIndex,ge=n.useMemo((function(){for(var Ot=[],Dt=function(kt){var Rt=ee[kt],jt=t(t({},Rt),{visibility:It[kt]!==void 0?It[kt]:-1,measureRef:function(Ut){Ut&&(Ut.setAttribute(Bn,"".concat(kt)),Zt.observe(Ut))}});Ot.push(jt)},Tt=be;Tt<=fe;Tt++)Dt(Tt);return Ot}),[be,fe,It,ee]),ve=n.useCallback((function(Ot,Dt){var Tt=Nt.current.measurements[pn(0,B-1,Ot)],kt=at.current===d.ScrollMode.Page?Nn:Dt;return Tt?xt({left:kt.left+Tt.start.left,top:kt.top+Tt.start.top},S):Promise.resolve()}),[xt,S]),_e=n.useCallback((function(Ot,Dt){var Tt=Nt.current.measurements,kt=Tt[Ot].start,Rt=Tt.find((function(Ut){return Ut.start.top-kt.top>1e-12}));if(!Rt)return Promise.resolve();var jt=Rt.index;switch(yt.current){case d.ViewMode.DualPage:jt=jt%2==0?jt:jt+1;break;case d.ViewMode.DualPageWithCover:jt=jt%2==1?jt:jt+1}return ve(jt,Dt)}),[]),me=n.useCallback((function(Ot,Dt){for(var Tt=Nt.current.measurements,kt=Tt[Ot].start,Rt=Ot,jt=!1,Ut=B-1;Ut>=0;Ut--)if(kt.top-Tt[Ut].start.top>1e-12){jt=!0,Rt=Tt[Ut].index;break}if(!jt)return Promise.resolve();switch(yt.current){case d.ViewMode.DualPage:Rt=Rt%2==0?Rt:Rt-1;break;case d.ViewMode.DualPageWithCover:Rt=Rt%2==0?Rt-1:Rt}return Rt===Ot&&(Rt=Ot-1),ve(Rt,Dt)}),[]),ke=n.useCallback((function(Ot,Dt){if(yt.current===d.ViewMode.DualPageWithCover||yt.current===d.ViewMode.DualPage)return _e(Ot,Dt);switch(at.current){case d.ScrollMode.Wrapped:return _e(Ot,Dt);case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:return ve(Ot+1,Dt)}}),[]),We=n.useCallback((function(Ot,Dt){if(yt.current===d.ViewMode.DualPageWithCover||yt.current===d.ViewMode.DualPage)return me(Ot,Dt);switch(at.current){case d.ScrollMode.Wrapped:return me(Ot,Dt);case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:return ve(Ot-1,Dt)}}),[]),He=n.useCallback((function(){return(function(Ot,Dt){switch(Dt){case d.ScrollMode.Horizontal:return{position:"relative",height:"100%",width:"".concat(Ot.width,"px")};case d.ScrollMode.Vertical:default:return{position:"relative",height:"".concat(Ot.height,"px"),width:"100%"}}})(ie,at.current)}),[ie]),Ce=n.useCallback((function(Ot){return(function(Dt,Tt,kt){return kt!==d.ScrollMode.Page?{}:{height:"".concat(Tt.height,"px"),width:"100%",position:"absolute",top:0,transform:"translateY(".concat(Dt.start.top,"px)")}})(Ot,Ft,at.current)}),[Ft]),Le=n.useCallback((function(Ot){return(function(Dt,Tt,kt,Rt,jt){var Ut,Mt,wt,Vt,Yt,he,ce,Te=Tt?"right":"left",De=Tt?-1:1,qt=kt.length,Re=Dt.start.left*De,de=Dt.size,pe=de.height,Ee=de.width;if(Rt===d.ViewMode.DualPageWithCover){var le=jt===d.ScrollMode.Page?0:Dt.start.top;return Dt.index===0||qt%2==0&&Dt.index===qt-1?((Ut={height:"".concat(pe,"px"),minWidth:"".concat(Ai(kt,Rt),"px"),width:"100%"})[Te]=0,Ut.position="absolute",Ut.top=0,Ut.transform="translate(".concat(Re,"px, ").concat(le,"px)"),Ut):((Mt={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,Mt.position="absolute",Mt.top=0,Mt.transform="translate(".concat(Re,"px, ").concat(le,"px)"),Mt)}if(Rt===d.ViewMode.DualPage)return(wt={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,wt.position="absolute",wt.top=0,wt.transform="translate(".concat(Re,"px, ").concat(jt===d.ScrollMode.Page?0:Dt.start.top,"px)"),wt;switch(jt){case d.ScrollMode.Horizontal:return(Vt={height:"100%",width:"".concat(Ee,"px")})[Te]=0,Vt.position="absolute",Vt.top=0,Vt.transform="translateX(".concat(Re,"px)"),Vt;case d.ScrollMode.Page:return(Yt={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,Yt.position="absolute",Yt.top=0,Yt;case d.ScrollMode.Wrapped:return(he={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,he.position="absolute",he.top=0,he.transform="translate(".concat(Re,"px, ").concat(Dt.start.top,"px)"),he;case d.ScrollMode.Vertical:default:return(ce={height:"".concat(pe,"px"),width:"100%"})[Te]=0,ce.position="absolute",ce.top=0,ce.transform="translateY(".concat(Dt.start.top,"px)"),ce}})(Ot,O,Z,yt.current,at.current)}),[O,Z]),Ve=n.useCallback((function(Ot,Dt){var Tt=Nt.current,kt=Tt.measurements,Rt=Tt.scrollOffset,jt=kt[pn(0,B-1,Dt)];if(jt){var Ut=at.current===d.ScrollMode.Page?{left:jt.start.left,top:jt.start.top}:{left:Rt.left*Ot,top:Rt.top*Ot};return xt(Ut,!1)}return Promise.resolve()}),[]);return n.useEffect((function(){return function(){Zt.disconnect()}}),[]),{boundingClientRect:Ft,isSmoothScrolling:K,startPage:be,endPage:fe,maxVisbilityIndex:ye,virtualItems:ge,getContainerStyles:He,getItemContainerStyles:Ce,getItemStyles:Le,scrollToItem:ve,scrollToNextItem:ke,scrollToPreviousItem:We,zoom:Ve}},wn=function(l,S,O,B,W,G){var Z=O;switch(!0){case(W===d.ViewMode.DualPageWithCover&&G>=3):case(W===d.ViewMode.DualPage&&G>=3):Z=2*O;break;default:Z=O}switch(B){case d.SpecialZoomLevel.ActualSize:return 1;case d.SpecialZoomLevel.PageFit:return Math.min((l.clientWidth-17)/Z,(l.clientHeight-16)/S);case d.SpecialZoomLevel.PageWidth:return(l.clientWidth-17)/Z}},Ri=function(l){var S,O,B=l.getCurrentPage,W=(S=50,O=n.useRef([]),n.useEffect((function(){return function(){O.current=[]}}),[]),{push:function(J){var K=O.current;K.length+1>S&&K.shift(),K.push(J),O.current=K},map:function(J){return O.current.map((function(K){return J(K)}))},pop:function(){var J=O.current;if(J.length===0)return null;var K=J.pop();return O.current=J,K}}),G=(function(J){var K=n.useRef([]);return n.useEffect((function(){return function(){K.current=[]}}),[]),{dequeue:function(){var ct=K.current;if(ct.length===0)return null;var lt=ct.shift();return K.current=ct,lt||null},enqueue:function(ct){var lt=K.current;lt.length+1>J&&lt.pop(),K.current=[ct].concat(lt)},map:function(ct){return K.current.map((function(lt){return ct(lt)}))}}})(50),Z=function(){var J=G.dequeue();return J&&W.push(J),J&&J.pageIndex===B()?Z():J},Y=function(){var J=W.pop();return J&&G.enqueue(J),J&&J.pageIndex===B()?Y():J},H=n.useCallback((function(J){W.push(J)}),[]);return{getNextDestination:Z,getPreviousDestination:Y,markVisitedDestination:H}},Hn=function(l){var S=[];return l.map((function(O){S=S.concat(O).concat((function(B){var W=[];return B.items&&B.items.length>0&&(W=W.concat(Hn(B.items))),W})(O))})),S},jn={capture:!1,passive:!0},ki={height:0,width:0},Cn={height:0,width:0},Mi=function(l){var S=l.getCurrentPage,O=l.getCurrentScrollMode,B=l.jumpToPage,W=l.targetRef,G=n.useState(d.FullScreenMode.Normal),Z=G[0],Y=G[1],H=(function(){var It=n.useState(ki),te=It[0],Zt=It[1],ee=mt((function(){Zt({height:window.innerHeight,width:window.innerWidth})}),100);return e((function(){return window.addEventListener("resize",ee,jn),function(){window.removeEventListener("resize",ee,jn)}}),[]),te})(),J=n.useState(Cn),K=J[0],ct=J[1],lt=n.useRef(Cn),at=n.useRef(S()),yt=n.useRef(Cn),vt=n.useState(W.current),pt=vt[0],Gt=vt[1],xt=n.useRef();e((function(){W.current!==pt&&Gt(W.current)}),[]),e((function(){if(pt){var It=new ResizeObserver((function(te){te.forEach((function(Zt){var ee=Zt.target.getBoundingClientRect(),ie=ee.height,se=ee.width;ct({height:ie,width:se})}))}));return It.observe(pt),function(){It.unobserve(pt),It.disconnect()}}}),[pt]);var Ft=n.useCallback((function(It){var te=dt();return te&&te!==It?(Y(d.FullScreenMode.Normal),bt(te)):Promise.resolve()}),[]),Nt=n.useCallback((function(It){It&&nt()&&(Gt(It),Ft(It).then((function(){xt.current=It,Y(d.FullScreenMode.Entering),(function(te){j&&te[tt.RequestFullScreen]()})(It)})))}),[]),Pt=n.useCallback((function(){dt()&&(Y(d.FullScreenMode.Exitting),bt(document))}),[]),Ht=n.useCallback((function(){pt&&dt()!==pt&&Y(d.FullScreenMode.Exitting)}),[pt]);return n.useEffect((function(){switch(Z){case d.FullScreenMode.Entering:xt.current&&(xt.current.style.backgroundColor="var(--rpv-core__full-screen-target-background-color)"),at.current=S(),lt.current={height:window.innerHeight,width:window.innerWidth};break;case d.FullScreenMode.Entered:O()===d.ScrollMode.Page?B(at.current).then((function(){Y(d.FullScreenMode.EnteredCompletely)})):Y(d.FullScreenMode.EnteredCompletely);break;case d.FullScreenMode.Exitting:xt.current&&(xt.current.style.backgroundColor="",xt.current=null),at.current=S();break;case d.FullScreenMode.Exited:Y(d.FullScreenMode.Normal),O()===d.ScrollMode.Page&&B(at.current)}}),[Z]),n.useEffect((function(){if(Z!==d.FullScreenMode.Normal)return Z===d.FullScreenMode.Entering&&H.height===K.height&&H.width===K.width&&H.height>0&&H.width>0&&(yt.current.height===0||H.height==yt.current.height)?(yt.current={height:window.innerHeight,width:window.innerWidth},void Y(d.FullScreenMode.Entered)):void(Z===d.FullScreenMode.Exitting&&lt.current.height===H.height&&lt.current.width===H.width&&H.height>0&&H.width>0&&Y(d.FullScreenMode.Exited))}),[Z,H,K]),n.useEffect((function(){var It;return It=Ht,j&&document.addEventListener(tt.FullScreenChange,It),function(){(function(te){j&&document.removeEventListener(tt.FullScreenChange,te)})(Ht)}}),[pt]),{enterFullScreenMode:Nt,exitFullScreenMode:Pt,fullScreenMode:Z}},xi={buildPageStyles:function(){return{}},transformSize:function(l){return l.size}},on={left:0,top:0},Fi=function(l){var S=l.currentFile,O=l.defaultScale,B=l.doc,W=l.enableSmoothScroll,G=l.initialPage,Z=l.initialRotation,Y=l.initialScale,H=l.pageLayout,J=l.pageSizes,K=l.plugins,ct=l.renderPage,lt=l.scrollMode,at=l.setRenderRange,yt=l.viewMode,vt=l.viewerState,pt=l.onDocumentLoad,Gt=l.onOpenFile,xt=l.onPageChange,Ft=l.onRotate,Nt=l.onRotatePage,Pt=l.onZoom,Ht=B.numPages,It=B.loadingTask.docId,te=n.useContext(v).l10n,Zt=n.useContext(f),ee=Zt.direction===d.TextDirection.RightToLeft,ie=n.useRef(),se=n.useRef(),be=n.useState(G),fe=be[0],ye=be[1],ge=n.useRef(null),ve=Ri({getCurrentPage:function(){return qt.current.pageIndex}}),_e=n.useState(Z),me=_e[0],ke=_e[1],We=ot(me),He=n.useState(!1),Ce=He[0],Le=He[1],Ve=n.useState(new Map),Ot=Ve[0],Dt=Ve[1],Tt=n.useState(lt),kt=Tt[0],Rt=Tt[1],jt=ot(kt),Ut=n.useState(yt),Mt=Ut[0],wt=Ut[1],Vt=ot(Mt),Yt=(function(ft){var zt=At(),Kt=n.useState([]),ae=Kt[0],re=Kt[1];return n.useEffect((function(){ft.getOutline().then((function(Jt){if(zt.current&&Jt!==null){var we=Hn(Jt);re(we)}}))}),[]),ae})(B),he=n.useState(Y),ce=he[0],Te=he[1],De=ot(ce),qt=n.useRef(vt),Re=n.useRef(typeof O=="string"?O:null),de=n.useRef(-1),pe=n.useRef(-1),Ee=n.useRef(G),le=Mi({getCurrentPage:function(){return qt.current.pageIndex},getCurrentScrollMode:function(){return qt.current.scrollMode},jumpToPage:function(ft){return Ke(ft)},targetRef:se}),$e=n.useState(-1),ln=$e[0],bn=$e[1],en=n.useState(0),gn=en[0],Bi=en[1],Ie=p({doc:B});n.useEffect((function(){return function(){Ae.clear(),je.clear()}}),[It]);var Vn=n.useMemo((function(){return Object.assign({},xi,H)}),[]),Hi=n.useMemo((function(){return Array(Ht).fill(0).map((function(ft,zt){var Kt=[J[zt].pageHeight,J[zt].pageWidth],ae=Math.abs(me)%180==0?{height:Kt[0],width:Kt[1]}:{height:Kt[1],width:Kt[0]},re={height:ae.height*ce,width:ae.width*ce};return Vn.transformSize({numPages:Ht,pageIndex:zt,size:re})}))}),[me,ce]),ue=Ti({enableSmoothScroll:W,isRtl:ee,numberOfItems:Ht,parentRef:se,scrollMode:kt,setRenderRange:at,sizes:Hi,viewMode:Mt}),ji=mt((function(){!Re.current||qt.current.fullScreenMode!==d.FullScreenMode.Normal||G>0&&Ee.current===G||nn(Re.current)}),200);(function(ft){var zt=ft.targetRef,Kt=ft.onResize;e((function(){var ae=new ResizeObserver((function(Jt){Jt.forEach((function(we){Kt(we.target)}))})),re=zt.current;if(re)return ae.observe(re),function(){ae.unobserve(re)}}),[])})({targetRef:se,onResize:ji});var Ye=function(ft){var zt=ft;K.forEach((function(Kt){Kt.onViewerStateChange&&(zt=Kt.onViewerStateChange(zt))})),qt.current=zt},Ui=function(){return se.current},Wi=function(){return qt.current},zi=n.useCallback((function(ft){ve.markVisitedDestination(ft)}),[]),Rn=n.useCallback((function(ft){var zt=ft.pageIndex,Kt=ft.bottomOffset,ae=ft.leftOffset,re=ft.scaleTo,Jt=se.current,we=qt.current;return Jt&&we?new Promise((function(Je,Dn){qe(B,zt).then((function(yn){var Ze=yn.getViewport({scale:1}),An=0,Zn=(typeof Kt=="function"?Kt(Ze.width,Ze.height):Kt)||0,Sn=(typeof ae=="function"?ae(Ze.width,Ze.height):ae)||0,cn=we.scale;switch(re){case d.SpecialZoomLevel.PageFit:An=0,Sn=0,nn(d.SpecialZoomLevel.PageFit);break;case d.SpecialZoomLevel.PageWidth:cn=wn(Jt,J[zt].pageHeight,J[zt].pageWidth,d.SpecialZoomLevel.PageWidth,yt,Ht),An=(Ze.height-Zn)*cn,Sn*=cn,nn(cn);break;default:An=(Ze.height-Zn)*cn,Sn*=cn}switch(we.scrollMode){case d.ScrollMode.Horizontal:ue.scrollToItem(zt,{left:Sn,top:0}).then((function(){Je()}));break;case d.ScrollMode.Vertical:default:ue.scrollToItem(zt,{left:0,top:An}).then((function(){Je()}))}}))})):Promise.resolve()}),[]),qn=n.useCallback((function(ft){return ve.markVisitedDestination(ft),Rn(ft)}),[]),Vi=n.useCallback((function(){var ft=ve.getNextDestination();return ft?Rn(ft):Promise.resolve()}),[]),qi=n.useCallback((function(){var ft=ve.getPreviousDestination();return ft?Rn(ft):Promise.resolve()}),[]),Gi=n.useCallback((function(){return ue.scrollToNextItem(qt.current.pageIndex,on)}),[]),Ke=n.useCallback((function(ft){return 0<=ft&&ft<Ht?ue.scrollToItem(ft,on):Promise.resolve()}),[]),Xi=n.useCallback((function(){return ue.scrollToPreviousItem(qt.current.pageIndex,on)}),[]),Gn=n.useCallback((function(ft){var zt,Kt;(zt=ft.name,Kt=zt.split(/\./).pop(),Kt?Kt.toLowerCase():"").toLowerCase()==="pdf"&&new Promise((function(ae){var re=new FileReader;re.readAsArrayBuffer(ft),re.onload=function(){var Jt=new Uint8Array(re.result);ae(Jt)}})).then((function(ae){Gt(ft.name,ae)}))}),[Gt]),Xn=n.useCallback((function(ft){var zt=ft===d.RotateDirection.Backward?-90:90,Kt=qt.current.rotation,ae=Kt===360||Kt===-360?zt:Kt+zt;Ie.markNotRendered(),ke(ae),Ye(t(t({},qt.current),{rotation:ae})),Ft({direction:ft,doc:B,rotation:ae})}),[]),kn=n.useCallback((function(ft,zt){var Kt=zt===d.RotateDirection.Backward?-90:90,ae=qt.current.pagesRotation,re=(ae.has(ft)?ae.get(ft):Z)+Kt,Jt=ae.set(ft,re);Dt(Jt),Le((function(we){return!we})),Ye(t(t({},qt.current),{pagesRotation:Jt,rotatedPage:ft})),Nt({direction:zt,doc:B,pageIndex:ft,rotation:re}),Ie.markRendering(ft),bn(ft)}),[]),$n=n.useCallback((function(ft){Ye(t(t({},qt.current),{scrollMode:ft})),Rt(ft)}),[]),Yn=n.useCallback((function(ft){Ye(t(t({},qt.current),{viewMode:ft})),wt(ft)}),[]),nn=n.useCallback((function(ft){var zt=se.current,Kt=qt.current.pageIndex;if(!(Kt<0||Kt>=Ht)){var ae=J[Kt].pageHeight,re=J[Kt].pageWidth,Jt=zt?typeof ft=="string"?wn(zt,ae,re,ft,qt.current.viewMode,Ht):ft:1;Re.current=typeof ft=="string"?ft:null,Jt!==qt.current.scale&&(Bi((function(we){return we+1})),Ie.markNotRendered(),Te(Jt),Pt({doc:B,scale:Jt}),Ye(t(t({},qt.current),{scale:Jt})))}}),[]),$i=n.useCallback((function(ft){le.enterFullScreenMode(ft)}),[]),Yi=n.useCallback((function(){le.exitFullScreenMode()}),[]);n.useEffect((function(){Ye(t(t({},qt.current),{fullScreenMode:le.fullScreenMode}))}),[le.fullScreenMode]),n.useEffect((function(){var ft={enterFullScreenMode:$i,exitFullScreenMode:Yi,getPagesContainer:Ui,getViewerState:Wi,jumpToDestination:qn,jumpToNextDestination:Vi,jumpToPreviousDestination:qi,jumpToNextPage:Gi,jumpToPreviousPage:Xi,jumpToPage:Ke,openFile:Gn,rotate:Xn,rotatePage:kn,setViewerState:Ye,switchScrollMode:$n,switchViewMode:Yn,zoom:nn};return K.forEach((function(zt){zt.install&&zt.install(ft)})),function(){K.forEach((function(zt){zt.uninstall&&zt.uninstall(ft)}))}}),[It]),n.useEffect((function(){pt({doc:B,file:S}),K.forEach((function(ft){ft.onDocumentLoad&&ft.onDocumentLoad({doc:B,file:S})}))}),[It]);var Mn,xn,Fn,Kn=ue.boundingClientRect;Mn=function(){G&&Ke(G)},xn=Kn.height>0&&Kn.width>0,Fn=n.useRef(!1),e((function(){xn&&!Fn.current&&(Fn.current=!0,Mn())}),[Mn,xn]),e((function(){var ft=qt.current.pageIndex;ft>-1&&jt!==kt&&ue.scrollToItem(ft,on).then((function(){le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&(W||Ie.markNotRendered(),de.current=-1)}))}),[kt]),e((function(){var ft=qt.current.pageIndex;ft>-1&&We!==me&&ue.scrollToItem(ft,on)}),[me]),e((function(){De!=0&&De!=qt.current.scale&&ue.zoom(qt.current.scale/De,qt.current.pageIndex).then((function(){le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&(pe.current=-1)}))}),[ce]),e((function(){if(Vt!==qt.current.viewMode){var ft=ue.startPage,zt=ue.endPage,Kt=ue.virtualItems;Ie.markNotRendered(),Ie.setRange(ft,zt);for(var ae=function(Jt){var we=Kt.find((function(Je){return Je.index===Jt}));we&&Ie.setVisibility(Jt,we.visibility)},re=ft;re<=zt;re++)ae(re);Ln()}}),[Mt]),e((function(){var ft=qt.current.pageIndex;ft>-1&&Vt!==Mt&&ue.scrollToItem(ft,on)}),[Mt]),e((function(){var ft=qt.current.pageIndex;ft>0&&ft===G&&Ee.current===G&&Re.current&&(Ee.current=-1,nn(Re.current))}),[fe]),n.useEffect((function(){ue.isSmoothScrolling||ge.current!==null&&ge.current===fe||(ge.current=fe,xt({currentPage:fe,doc:B}))}),[fe,ue.isSmoothScrolling]),n.useEffect((function(){le.fullScreenMode===d.FullScreenMode.Entering&&qt.current.scrollMode===d.ScrollMode.Page&&(de.current=qt.current.pageIndex),le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&qt.current.scrollMode===d.ScrollMode.Page&&W&&(de.current=-1),le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&Re.current&&(pe.current=qt.current.pageIndex,nn(Re.current))}),[le.fullScreenMode]),n.useEffect((function(){if(le.fullScreenMode!==d.FullScreenMode.Entering&&le.fullScreenMode!==d.FullScreenMode.Exitting&&!ue.isSmoothScrolling){var ft=ue.startPage,zt=ue.endPage,Kt=ue.maxVisbilityIndex,ae=ue.virtualItems,re=Kt,Jt=le.fullScreenMode===d.FullScreenMode.Entered||le.fullScreenMode===d.FullScreenMode.EnteredCompletely;if(!(Jt&&re!==de.current&&de.current>-1||Jt&&re!==pe.current&&pe.current>-1)){ye(re),Ye(t(t({},qt.current),{pageIndex:re})),Ie.setRange(ft,zt);for(var we=function(Dn){var yn=ae.find((function(Ze){return Ze.index===Dn}));yn&&Ie.setVisibility(Dn,yn.visibility)},Je=ft;Je<=zt;Je++)we(Je);Ln()}}}),[ue.startPage,ue.endPage,ue.isSmoothScrolling,ue.maxVisbilityIndex,le.fullScreenMode,Ce,me,ce]);var Ki=n.useCallback((function(ft){Ie.markRendered(ft),Ln()}),[gn]),Ln=function(){var ft=Ie.getHighestPriorityPage();ft>-1&&Ie.isInRange(ft)&&(Ie.markRendering(ft),bn(ft))},Ji=function(ft){var zt=fe-1,Kt=fe+1;switch(ft){case"FirstPage":Ke(0);break;case"LastPage":Ke(Ht-1);break;case"NextPage":Kt<Ht&&Ke(Kt);break;case"PrevPage":zt>=0&&Ke(zt)}},Zi=n.useCallback((function(){var ft=ue.virtualItems,zt=[];switch(Mt){case d.ViewMode.DualPage:zt=ne(ft,2);break;case d.ViewMode.DualPageWithCover:ft.length&&(zt=ft[0].index===0?[[ft[0]]].concat(ne(ft.slice(1),2)):ne(ft,2));break;case d.ViewMode.SinglePage:default:zt=ne(ft,1)}var Kt=te&&te.core?te.core.pageLabel:"Page {{pageIndex}}",ae={attrs:{className:"rpv-core__inner-container","data-testid":"core__inner-container",ref:ie,style:{height:"100%"}},children:n.createElement(n.Fragment,null),subSlot:{attrs:{"data-testid":"core__inner-pages",className:h({"rpv-core__inner-pages":!0,"rpv-core__inner-pages--horizontal":kt===d.ScrollMode.Horizontal,"rpv-core__inner-pages--rtl":ee,"rpv-core__inner-pages--single":kt===d.ScrollMode.Page,"rpv-core__inner-pages--vertical":kt===d.ScrollMode.Vertical,"rpv-core__inner-pages--wrapped":kt===d.ScrollMode.Wrapped}),ref:se,style:{height:"100%",position:"relative"}},children:n.createElement("div",{"data-testid":"core__inner-current-page-".concat(fe),style:Object.assign({"--scale-factor":ce},ue.getContainerStyles())},zt.map((function(re){return n.createElement("div",{className:h({"rpv-core__inner-page-container":!0,"rpv-core__inner-page-container--single":kt===d.ScrollMode.Page}),style:ue.getItemContainerStyles(re[0]),key:"".concat(re[0].index,"-").concat(Mt)},re.map((function(Jt){var we=Mt===d.ViewMode.DualPageWithCover&&(Jt.index===0||Ht%2==0&&Jt.index===Ht-1);return n.createElement("div",{"aria-label":Kt.replace("{{pageIndex}}","".concat(Jt.index+1)),className:h({"rpv-core__inner-page":!0,"rpv-core__inner-page--dual-even":Mt===d.ViewMode.DualPage&&Jt.index%2==0,"rpv-core__inner-page--dual-odd":Mt===d.ViewMode.DualPage&&Jt.index%2==1,"rpv-core__inner-page--dual-cover":we,"rpv-core__inner-page--dual-cover-even":Mt===d.ViewMode.DualPageWithCover&&!we&&Jt.index%2==0,"rpv-core__inner-page--dual-cover-odd":Mt===d.ViewMode.DualPageWithCover&&!we&&Jt.index%2==1,"rpv-core__inner-page--single":Mt===d.ViewMode.SinglePage&&kt===d.ScrollMode.Page}),role:"region",key:"".concat(Jt.index,"-").concat(Mt),style:Object.assign({},ue.getItemStyles(Jt),Vn.buildPageStyles({numPages:Ht,pageIndex:Jt.index,scrollMode:kt,viewMode:Mt}))},n.createElement(vi,{doc:B,measureRef:Jt.measureRef,outlines:Yt,pageIndex:Jt.index,pageRotation:Ot.has(Jt.index)?Ot.get(Jt.index):0,pageSize:J[Jt.index],plugins:K,renderPage:ct,renderQueueKey:gn,rotation:me,scale:ce,shouldRender:ln===Jt.index,viewMode:Mt,onExecuteNamedAction:Ji,onJumpFromLinkAnnotation:zi,onJumpToDest:qn,onRenderCompleted:Ki,onRotatePage:kn}))})))})))}};return K.forEach((function(re){re.renderViewer&&(ae=re.renderViewer({containerRef:ie,doc:B,pagesContainerRef:se,pagesRotation:Ot,pageSizes:J,rotation:me,slot:ae,themeContext:Zt,jumpToPage:Ke,openFile:Gn,rotate:Xn,rotatePage:kn,switchScrollMode:$n,switchViewMode:Yn,zoom:nn}))})),ae}),[K,ue]),Jn=n.useCallback((function(ft){return n.createElement("div",t({},ft.attrs,{style:ft.attrs&&ft.attrs.style?ft.attrs.style:{}}),ft.children,ft.subSlot&&Jn(ft.subSlot))}),[]);return Jn(Zi())},Un=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],Li=function(l){var S=l.defaultScale,O=l.doc,B=l.render,W=l.scrollMode,G=l.viewMode,Z=n.useRef(),Y=n.useState({pageSizes:[],scale:0}),H=Y[0],J=Y[1];return n.useLayoutEffect((function(){var K=Array(O.numPages).fill(0).map((function(ct,lt){return new Promise((function(at,yt){qe(O,lt).then((function(vt){var pt=vt.getViewport({scale:1});at({pageHeight:pt.height,pageWidth:pt.width,rotation:pt.rotation})}))}))}));Promise.all(K).then((function(ct){var lt=Z.current;if(lt&&ct.length!==0){var at=ct[0].pageWidth,yt=ct[0].pageHeight,vt=lt.parentElement,pt=(vt.clientWidth-45)/at,Gt=(vt.clientHeight-45)/yt,xt=pt;switch(W){case d.ScrollMode.Horizontal:xt=Math.min(pt,Gt);break;case d.ScrollMode.Vertical:default:xt=pt}var Ft,Nt,Pt=S?typeof S=="string"?wn(vt,yt,at,S,G,O.numPages):S:(Ft=xt,(Nt=Un.findIndex((function(Ht){return Ht>=Ft})))===-1||Nt===0?Ft:Un[Nt-1]);J({pageSizes:ct,scale:Pt})}}))}),[O.loadingTask.docId]),H.pageSizes.length===0||H.scale===0?n.createElement("div",{className:"rpv-core__page-size-calculator","data-testid":"core__page-size-calculating",ref:Z},n.createElement(L,null)):B(H.pageSizes,H.scale)},_n=function(){},Pn=(function(l){function S(O,B){var W=l.call(this)||this;return W.verifyPassword=O,W.passwordStatus=B,W}return q(S,l),S})(_n),Di=function(l){var S=l.passwordStatus,O=l.renderProtectedView,B=l.verifyPassword,W=l.onDocumentAskPassword,G=n.useContext(v).l10n,Z=n.useState(""),Y=Z[0],H=Z[1],J=n.useContext(f).direction===d.TextDirection.RightToLeft,K=function(){return B(Y)};return n.useEffect((function(){W&&W({verifyPassword:B})}),[]),O?O({passwordStatus:S,verifyPassword:B}):n.createElement("div",{className:"rpv-core__asking-password-wrapper"},n.createElement("div",{className:h({"rpv-core__asking-password":!0,"rpv-core__asking-password--rtl":J})},n.createElement("div",{className:"rpv-core__asking-password-message"},S===d.PasswordStatus.RequiredPassword&&G.core.askingPassword.requirePasswordToOpen,S===d.PasswordStatus.WrongPassword&&G.core.wrongPassword.tryAgain),n.createElement("div",{className:"rpv-core__asking-password-body"},n.createElement("div",{className:h({"rpv-core__asking-password-input":!0,"rpv-core__asking-password-input--ltr":!J,"rpv-core__asking-password-input--rtl":J})},n.createElement(M,{testId:"core__asking-password-input",type:"password",value:Y,onChange:H,onKeyDown:function(ct){ct.key==="Enter"&&K()}})),n.createElement(w,{onClick:K},G.core.askingPassword.submit))))},Wn=(function(l){function S(O){var B=l.call(this)||this;return B.doc=O,B}return q(S,l),S})(_n),zn=(function(l){function S(O){var B=l.call(this)||this;return B.error=O,B}return q(S,l),S})(_n),Tn=(function(l){function S(O){var B=l.call(this)||this;return B.percentages=O,B}return q(S,l),S})(_n),Ii=function(l){var S=l.characterMap,O=l.file,B=l.httpHeaders,W=l.render,G=l.renderError,Z=l.renderLoader,Y=l.renderProtectedView,H=l.transformGetDocumentParams,J=l.withCredentials,K=l.onDocumentAskPassword,ct=n.useContext(f).direction===d.TextDirection.RightToLeft,lt=n.useState(new Tn(0)),at=lt[0],yt=lt[1],vt=n.useRef(""),pt=At();return n.useEffect((function(){vt.current="",yt(new Tn(0));var Gt=new x.PDFWorker({name:"PDFWorker_".concat(Date.now())}),xt=Object.assign({httpHeaders:B,withCredentials:J,worker:Gt},typeof O=="string"?{url:O}:{data:O},S?{cMapUrl:S.url,cMapPacked:S.isCompressed}:{}),Ft=H?H(xt):xt,Nt=x.getDocument(Ft);return Nt.onPassword=function(Pt,Ht){switch(Ht){case x.PasswordResponses.NEED_PASSWORD:pt.current&&yt(new Pn(Pt,d.PasswordStatus.RequiredPassword));break;case x.PasswordResponses.INCORRECT_PASSWORD:pt.current&&yt(new Pn(Pt,d.PasswordStatus.WrongPassword))}},Nt.onProgress=function(Pt){var Ht=Pt.total>0?Math.min(100,100*Pt.loaded/Pt.total):100;pt.current&&vt.current===""&&yt(new Tn(Ht))},Nt.promise.then((function(Pt){vt.current=Pt.loadingTask.docId,pt.current&&yt(new Wn(Pt))}),(function(Pt){return pt.current&&!Gt.destroyed&&yt(new zn({message:Pt.message||"Cannot load document",name:Pt.name}))})),function(){Nt.destroy(),Gt.destroy()}}),[O]),at instanceof Pn?n.createElement(Di,{passwordStatus:at.passwordStatus,renderProtectedView:Y,verifyPassword:at.verifyPassword,onDocumentAskPassword:K}):at instanceof Wn?W(at.doc):at instanceof zn?G?G(at.error):n.createElement("div",{className:h({"rpv-core__doc-error":!0,"rpv-core__doc-error--rtl":ct})},n.createElement("div",{className:"rpv-core__doc-error-text"},at.error.message)):n.createElement("div",{"data-testid":"core__doc-loading",className:h({"rpv-core__doc-loading":!0,"rpv-core__doc-loading--rtl":ct})},Z?Z(at.percentages):n.createElement(L,null))},Oi=function(l,S){var O=n.useMemo((function(){return l==="auto"?typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":l}),[]),B=n.useState(O),W=B[0],G=B[1],Z=ot(W);return n.useEffect((function(){if(l==="auto"){var Y=window.matchMedia("(prefers-color-scheme: dark)"),H=function(J){G(J.matches?"dark":"light")};return Y.addEventListener("change",H),function(){return Y.removeEventListener("change",H)}}}),[]),n.useEffect((function(){W!==Z&&S&&S(W)}),[W]),n.useEffect((function(){l!==W&&G(l)}),[l]),{currentTheme:W,setCurrentTheme:G}},Ni=function(l){return{startPage:l.startPage-3,endPage:l.endPage+3}};d.Button=function(l){var S=l.children,O=l.testId,B=l.onClick,W=n.useContext(f).direction===d.TextDirection.RightToLeft,G=O?{"data-testid":O}:{};return n.createElement("button",t({className:h({"rpv-core__button":!0,"rpv-core__button--rtl":W}),type:"button",onClick:B},G),S)},d.Icon=_,d.LazyRender=function(l){var S=l.attrs,O=l.children,B=l.testId,W=n.useState(!1),G=W[0],Z=W[1],Y=B?t(t({},S),{"data-testid":B}):S,H=g({once:!0,onVisibilityChanged:function(J){J.isVisible&&Z(!0)}});return n.createElement("div",t({ref:H},Y),G&&O)},d.LocalizationContext=v,d.Menu=function(l){var S=l.children,O=n.useRef(),B=n.useRef([]),W=n.useContext(f).direction===d.TextDirection.RightToLeft,G=function(Y){if(O.current)switch(Y.key){case"Tab":Y.preventDefault();break;case"ArrowDown":Y.preventDefault(),Z((function(H,J){return J+1}));break;case"ArrowUp":Y.preventDefault(),Z((function(H,J){return J-1}));break;case"End":Y.preventDefault(),Z((function(H,J){return H.length-1}));break;case"Home":Y.preventDefault(),Z((function(H,J){return 0}))}},Z=function(Y){if(O.current){var H=B.current,J=H.findIndex((function(ct){return ct.getAttribute("tabindex")==="0"})),K=Math.min(H.length-1,Math.max(0,Y(H,J)));J>=0&&J<=H.length-1&&H[J].setAttribute("tabindex","-1"),H[K].setAttribute("tabindex","0"),H[K].focus()}};return e((function(){var Y=O.current;if(Y){var H=(function(J){var K=[];return J.querySelectorAll('.rpv-core__menu-item[role="menuitem"]').forEach((function(ct){if(ct instanceof HTMLElement){var lt=ct.parentElement;(lt===J||window.getComputedStyle(lt).display!=="none")&&K.push(ct)}})),K})(Y);B.current=H}}),[]),e((function(){return document.addEventListener("keydown",G),function(){document.removeEventListener("keydown",G)}}),[]),n.createElement("div",{ref:O,"aria-orientation":"vertical",className:h({"rpv-core__menu":!0,"rpv-core__menu--rtl":W}),role:"menu",tabIndex:0},S)},d.MenuDivider=function(){return n.createElement("div",{"aria-orientation":"horizontal",className:"rpv-core__menu-divider",role:"separator"})},d.MenuItem=function(l){var S=l.checked,O=S!==void 0&&S,B=l.children,W=l.icon,G=W===void 0?null:W,Z=l.isDisabled,Y=Z!==void 0&&Z,H=l.testId,J=l.onClick,K=n.useContext(f).direction===d.TextDirection.RightToLeft,ct=H?{"data-testid":H}:{};return n.createElement("button",t({className:h({"rpv-core__menu-item":!0,"rpv-core__menu-item--disabled":Y,"rpv-core__menu-item--ltr":!K,"rpv-core__menu-item--rtl":K}),role:"menuitem",tabIndex:-1,type:"button",onClick:J},ct),n.createElement("div",{className:h({"rpv-core__menu-item-icon":!0,"rpv-core__menu-item-icon--ltr":!K,"rpv-core__menu-item-icon--rtl":K})},G),n.createElement("div",{className:h({"rpv-core__menu-item-label":!0,"rpv-core__menu-item-label--ltr":!K,"rpv-core__menu-item-label--rtl":K})},B),n.createElement("div",{className:h({"rpv-core__menu-item-check":!0,"rpv-core__menu-item-check--ltr":!K,"rpv-core__menu-item-check--rtl":K})},O&&n.createElement(c,null)))},d.MinimalButton=function(l){var S=l.ariaLabel,O=S===void 0?"":S,B=l.ariaKeyShortcuts,W=B===void 0?"":B,G=l.children,Z=l.isDisabled,Y=Z!==void 0&&Z,H=l.isSelected,J=H!==void 0&&H,K=l.testId,ct=l.onClick,lt=n.useContext(f).direction===d.TextDirection.RightToLeft,at=K?{"data-testid":K}:{};return n.createElement("button",t({"aria-label":O},W&&{"aria-keyshortcuts":W},Y&&{"aria-disabled":!0},{className:h({"rpv-core__minimal-button":!0,"rpv-core__minimal-button--disabled":Y,"rpv-core__minimal-button--rtl":lt,"rpv-core__minimal-button--selected":J}),type:"button",onClick:ct},at),G)},d.Modal=function(l){var S=l.ariaControlsSuffix,O=l.closeOnClickOutside,B=l.closeOnEscape,W=l.content,G=l.isOpened,Z=G!==void 0&&G,Y=l.target,H=S||"".concat(P());return n.createElement(F,{target:Y?function(J,K){return n.createElement("div",{"aria-expanded":K?"true":"false","aria-haspopup":"dialog","aria-controls":"rpv-core__modal-body-".concat(H)},Y(J,K))}:null,content:function(J){return n.createElement(b,null,n.createElement(a,{ariaControlsSuffix:H,closeOnClickOutside:O,closeOnEscape:B,onToggle:J},W(J)))},isOpened:Z})},d.Popover=function(l){var S=l.ariaHasPopup,O=S===void 0?"dialog":S,B=l.ariaControlsSuffix,W=l.closeOnClickOutside,G=l.closeOnEscape,Z=l.content,Y=l.lockScroll,H=Y===void 0||Y,J=l.offset,K=l.position,ct=l.target,lt=k(!1),at=lt.opened,yt=lt.toggle,vt=n.useRef(),pt=n.useMemo((function(){return B||"".concat(P())}),[]);return n.createElement("div",{ref:vt,"aria-expanded":at?"true":"false","aria-haspopup":O,"aria-controls":"rpv-core__popver-body-".concat(pt)},ct(yt,at),at&&n.createElement(n.Fragment,null,H&&n.createElement(Bt,{closeOnEscape:G,onClose:yt}),n.createElement(Lt,{ariaControlsSuffix:pt,closeOnClickOutside:W,offset:J,position:K,targetRef:vt,onClose:yt},Z(yt))))},d.PrimaryButton=w,d.ProgressBar=function(l){var S=l.progress,O=n.useContext(f).direction===d.TextDirection.RightToLeft;return n.createElement("div",{className:h({"rpv-core__progress-bar":!0,"rpv-core__progress-bar--rtl":O})},n.createElement("div",{className:"rpv-core__progress-bar-progress",style:{width:"".concat(S,"%")}},S,"%"))},d.Separator=function(){return n.createElement("div",{className:"rpv-core__separator"})},d.Spinner=L,d.Splitter=function(l){var S=l.constrain,O=n.useContext(f).direction===d.TextDirection.RightToLeft,B=n.useRef(),W=n.useRef(),G=n.useRef(),Z=n.useRef(0),Y=n.useRef(0),H=n.useRef(0),J=n.useRef(0),K={capture:!0},ct=function(at){var yt=B.current,vt=W.current,pt=G.current;if(yt&&vt&&pt){var Gt=J.current,xt=at.clientX-Z.current,Ft=H.current+(O?-xt:xt),Nt=yt.parentElement.getBoundingClientRect().width,Pt=100*Ft/Nt;if(yt.classList.add("rpv-core__splitter--resizing"),S){var Ht=Nt-Ft-Gt;if(!S({firstHalfPercentage:Pt,firstHalfSize:Ft,secondHalfPercentage:100*Ht/Nt,secondHalfSize:Ht}))return}vt.style.width="".concat(Pt,"%"),document.body.classList.add("rpv-core__splitter-body--resizing"),vt.classList.add("rpv-core__splitter-sibling--resizing"),pt.classList.add("rpv-core__splitter-sibling--resizing")}},lt=function(at){var yt=B.current,vt=W.current,pt=G.current;yt&&vt&&pt&&(document.body.classList.remove("rpv-core__splitter-body--resizing"),yt.classList.remove("rpv-core__splitter--resizing"),vt.classList.remove("rpv-core__splitter-sibling--resizing"),pt.classList.remove("rpv-core__splitter-sibling--resizing"),document.removeEventListener("mousemove",ct,K),document.removeEventListener("mouseup",lt,K))};return n.useEffect((function(){var at=B.current;at&&(J.current=at.getBoundingClientRect().width,W.current=at.previousElementSibling,G.current=at.nextElementSibling)}),[]),n.createElement("div",{ref:B,className:"rpv-core__splitter",onMouseDown:function(at){var yt=W.current;yt&&(Z.current=at.clientX,Y.current=at.clientY,H.current=yt.getBoundingClientRect().width,document.addEventListener("mousemove",ct,K),document.addEventListener("mouseup",lt,K))}})},d.TextBox=M,d.ThemeContext=f,d.Tooltip=function(l){var S=l.ariaControlsSuffix,O=l.content,B=l.offset,W=l.position,G=l.target,Z=k(!1),Y=Z.opened,H=Z.toggle,J=n.useRef(),K=n.useRef(),ct=n.useMemo((function(){return S||"".concat(P())}),[]);R((function(){J.current&&document.activeElement&&J.current.contains(document.activeElement)&&at()}));var lt=function(){H(d.ToggleStatus.Open)},at=function(){H(d.ToggleStatus.Close)};return n.createElement(n.Fragment,null,n.createElement("div",{ref:J,"aria-describedby":"rpv-core__tooltip-body-".concat(ct),onBlur:function(yt){yt.relatedTarget instanceof HTMLElement&&yt.currentTarget.parentElement&&yt.currentTarget.parentElement.contains(yt.relatedTarget)?K.current&&(K.current.style.display="none"):at()},onFocus:lt,onMouseEnter:lt,onMouseLeave:at},G),Y&&n.createElement(Xt,{ariaControlsSuffix:ct,contentRef:K,offset:B,position:W,targetRef:J},O()))},d.Viewer=function(l){var S=l.characterMap,O=l.defaultScale,B=l.enableSmoothScroll,W=B===void 0||B,G=l.fileUrl,Z=l.httpHeaders,Y=Z===void 0?{}:Z,H=l.initialPage,J=H===void 0?0:H,K=l.pageLayout,ct=l.initialRotation,lt=ct===void 0?0:ct,at=l.localization,yt=l.plugins,vt=yt===void 0?[]:yt,pt=l.renderError,Gt=l.renderLoader,xt=l.renderPage,Ft=l.renderProtectedView,Nt=l.scrollMode,Pt=Nt===void 0?d.ScrollMode.Vertical:Nt,Ht=l.setRenderRange,It=Ht===void 0?Ni:Ht,te=l.transformGetDocumentParams,Zt=l.theme,ee=Zt===void 0?{direction:d.TextDirection.LeftToRight,theme:"light"}:Zt,ie=l.viewMode,se=ie===void 0?d.ViewMode.SinglePage:ie,be=l.withCredentials,fe=be!==void 0&&be,ye=l.onDocumentAskPassword,ge=l.onDocumentLoad,ve=ge===void 0?function(){}:ge,_e=l.onPageChange,me=_e===void 0?function(){}:_e,ke=l.onRotate,We=ke===void 0?function(){}:ke,He=l.onRotatePage,Ce=He===void 0?function(){}:He,Le=l.onSwitchTheme,Ve=Le===void 0?function(){}:Le,Ot=l.onZoom,Dt=Ot===void 0?function(){}:Ot,Tt=n.useState({data:G,name:typeof G=="string"?G:"",shouldLoad:!1}),kt=Tt[0],Rt=Tt[1],jt=function(de,pe){Rt({data:pe,name:de,shouldLoad:!0})},Ut=n.useState(!1),Mt=Ut[0],wt=Ut[1],Vt=ot(kt);n.useEffect((function(){var de,pe,Ee,le;de=Vt.data,le=typeof(pe=G),(Ee=typeof de)=="string"&&le==="string"&&de===pe||Ee==="object"&&le==="object"&&de.length===pe.length&&de.every((function($e,ln){return $e===pe[ln]}))||Rt({data:G,name:typeof G=="string"?G:"",shouldLoad:Mt})}),[G,Mt]);var Yt=g({onVisibilityChanged:function(de){wt(de.isVisible),de.isVisible&&Rt((function(pe){return Object.assign({},pe,{shouldLoad:!0})}))}}),he=typeof ee=="string"?{direction:d.TextDirection.LeftToRight,theme:ee}:ee,ce=n.useState(at||r),Te=ce[0],De=ce[1],qt={l10n:Te,setL10n:De},Re=Object.assign({},{direction:he.direction},Oi(he.theme||"light",Ve));return n.useEffect((function(){at&&De(at)}),[at]),n.createElement(v.Provider,{value:qt},n.createElement(f.Provider,{value:Re},n.createElement("div",{ref:Yt,className:"rpv-core__viewer rpv-core__viewer--".concat(Re.currentTheme),"data-testid":"core__viewer",style:{height:"100%",width:"100%"}},kt.shouldLoad&&n.createElement(Ii,{characterMap:S,file:kt.data,httpHeaders:Y,render:function(de){return n.createElement(Li,{defaultScale:O,doc:de,render:function(pe,Ee){return n.createElement(Fi,{currentFile:{data:kt.data,name:kt.name},defaultScale:O,doc:de,enableSmoothScroll:W,initialPage:J,initialRotation:lt,initialScale:Ee,pageLayout:K,pageSizes:pe,plugins:vt,renderPage:xt,scrollMode:Pt,setRenderRange:It,viewMode:se,viewerState:{file:kt,fullScreenMode:d.FullScreenMode.Normal,pageIndex:-1,pageHeight:pe[0].pageHeight,pageWidth:pe[0].pageWidth,pagesRotation:new Map,rotation:lt,scale:Ee,scrollMode:Pt,viewMode:se},onDocumentLoad:ve,onOpenFile:jt,onPageChange:me,onRotate:We,onRotatePage:Ce,onZoom:Dt})},scrollMode:Pt,viewMode:se})},renderError:pt,renderLoader:Gt,renderProtectedView:Ft,transformGetDocumentParams:te,withCredentials:fe,onDocumentAskPassword:ye}))))},d.Worker=function(l){var S=l.children,O=l.workerUrl;return x.GlobalWorkerOptions.workerSrc=O,n.createElement(n.Fragment,null,S)},d.chunk=ne,d.classNames=h,d.createStore=function(l){var S=l||{},O={},B=function(G,Z){var Y;S=t(t({},S),((Y={})[G]=Z,Y)),(O[G]||[]).forEach((function(H){return H(S[G])}))},W=function(G){return S[G]};return{subscribe:function(G,Z){O[G]=(O[G]||[]).concat(Z)},unsubscribe:function(G,Z){O[G]=(O[G]||[]).filter((function(Y){return Y!==Z}))},update:function(G,Z){B(G,Z)},updateCurrentValue:function(G,Z){var Y=W(G);Y!==void 0&&B(G,Z(Y))},get:function(G){return W(G)}}},d.getDestination=un,d.getPage=qe,d.isFullScreenEnabled=nt,d.isMac=function(){return typeof window<"u"&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)},d.useDebounceCallback=mt,d.useIntersectionObserver=g,d.useIsMounted=At,d.useIsomorphicLayoutEffect=e,d.usePrevious=ot,d.useRenderQueue=p})(core_min)),core_min}var hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib.exports;hasRequiredLib=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return lib.exports=requireCore_min(),lib.exports}export{requireLib as a,getDefaultExportFromCjs as g,requireReact as r};
