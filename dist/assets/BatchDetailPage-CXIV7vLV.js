import{c as o,g as $,r as t,j as e,b as y,s as m}from"./index-BfdL3V75.js";import{a as G}from"./batchAPI-r7r9bww9.js";import{g as N}from"./dateUtils-DuzDAtY7.js";import{a as O,b as V,u as A,X as w,S as W,U as X,F as Z,E as J,t as Q,C as Y,f as ee,d as ae}from"./whatsappUtils-BaARNaLu.js";import"./apiClient-BmXS3_vS.js";import{g as te}from"./genericApi-B1yEKLU8.js";import{u as se}from"./use-paginated-resource-DQv-Wxs9.js";import{P as le}from"./Pagination-C_09vddA.js";import{B as r}from"./button-Dyz-buuH.js";import{D as re}from"./download-CQgvu3-Q.js";import"./pdfjs-BzSgQdvw.js";import"./index-NIGUFBhG.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],oe=o("calendar",ne);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ie=o("file-text",ce);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],me=o("folder-open",de);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],xe=o("map-pin",he),pe=async l=>(await te("/examinations",l)).data;function Se(){const{id:l}=$(),[s,v]=t.useState(null),[_,h]=t.useState(!0),[x,k]=t.useState(null),[c,p]=t.useState(""),[C,i]=t.useState(!1),{data:S,handleFileUpload:M,resetData:B}=O(),{importData:D,loading:u}=V(),[f,g]=t.useState(null),E=()=>{K(c),d()},P=async()=>{try{const a=await ae();I(a,"employee_template.xlsx"),m({icon:"success",title:"Berhasil",text:"Template berhasil diunduh!",timer:2e3,showConfirmButton:!1})}catch(a){console.error(a),m({icon:"error",title:"Gagal",text:"Download gagal!",confirmButtonText:"Coba lagi"})}},F=async()=>{if(!f){m({icon:"warning",title:"Tidak ada file",text:"Silakan upload file Excel terlebih dahulu.",confirmButtonText:"Mengerti"});return}await D(f)&&(i(!1),g(null),B(),d())},T=()=>{p(""),q(),d()},{downloadBlob:I}=A();t.useEffect(()=>{l&&(h(!0),G(l).then(a=>v(a.data)).catch(a=>k(a.message||"Terjadi kesalahan")).finally(()=>h(!1)))},[l]);const{data:z,loading:H,error:b,page:j,lastPage:U,total:L,handleSearch:K,handlePageChange:R,resetSearch:q,invalidateCache:d}=se({queryFn:pe,defaultParams:{}});return _?e.jsx("p",{children:"Memuat detail batch..."}):x?e.jsx("p",{className:"text-error",children:x}):s?e.jsxs("div",{className:"p-8 space-y-6",children:[e.jsxs("div",{className:"relative bg-primary/20 rounded-lg p-6 overflow-visible flex items-center",children:[e.jsx("div",{className:"flex-1 flex flex-col justify-center",children:e.jsxs("h1",{className:"text-3xl font-bold text-base-content",children:["Batch ",s.batch_code]})}),e.jsx("div",{className:"absolute right-4 -top-6 w-20 h-20 sm:right-10 sm:-top-10 sm:w-32 sm:h-32 flex items-center justify-center opacity-60",children:e.jsx(me,{className:"w-full h-full text-primary"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-base-100 p-4 rounded-lg shadow-sm border border-base-200",children:[e.jsx(oe,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"font-medium text-base-content",children:N(s.exam_date)})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-base-100 p-4 rounded-lg shadow-sm border border-base-200",children:[e.jsx(xe,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"font-medium text-base-content",children:s.location})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-base-100 p-4 rounded-lg shadow-sm border border-base-200",children:[e.jsx(ie,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"font-medium text-base-content",children:s.notes||"-"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-stretch m-0 gap-2",children:[e.jsx("div",{className:"hidden md:flex flex-1 items-center overflow-hidden bg-primary/20 rounded-t-4xl justify-center border-t border-l border-r border-gray-300",children:e.jsx("p",{className:"break-words p-4 font-bold text-center sm:text-left",children:"Daftar Karyawan"})}),e.jsxs("div",{className:"flex-shrink-0 flex flex-col sm:flex-row gap-2 items-stretch sm:items-center px-2 mb-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex w-full sm:w-auto",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Search...",className:"input input-ghost rounded-l-full w-full border border-gray-300 h-10 pr-10",value:c,onChange:a=>p(a.target.value)}),c&&e.jsx("button",{type:"button",onClick:T,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-red-500",title:"Reset",children:e.jsx(w,{className:"w-4 h-4"})})]}),e.jsxs(r,{type:"button",className:"bg-accent text-accent-content hover:bg-accent-focus rounded-r-full h-10 flex items-center gap-2 px-4 w-auto",onClick:E,children:[e.jsx(W,{className:"size-5"}),"Search"]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx("div",{className:"tooltip flex-1 sm:flex-none","data-tip":"Download template Excel",children:e.jsxs(r,{type:"button",className:"bg-primary text-primary-content hover:bg-primary-focus rounded-full h-10 flex items-center gap-2 w-full",onClick:P,children:[e.jsx(re,{className:"size-5"}),"Download Template"]})}),e.jsx("div",{className:"tooltip flex-1 sm:flex-none","data-tip":"Upload File Excel",children:e.jsxs(r,{type:"button",className:"bg-secondary text-accent-content hover:bg-accent-focus rounded-full h-10 flex items-center gap-2 w-full",onClick:()=>i(!0),children:[e.jsx(X,{className:"size-5"}),"Import"]})})]})]}),C&&e.jsx("div",{className:"modal modal-open",children:e.jsxs("div",{className:"modal-box w-11/12 max-w-6xl",children:[e.jsxs("div",{className:"py-4",children:[e.jsx(Z,{label:"Upload File",infoText:"Max size 2MB, format .xlsx/.xls",accept:".xlsx,.xls",onChange:a=>{M(a);const n=a.target.files?.[0];n&&g(n)}}),e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsx(J,{data:S,headers:Q})})]}),e.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[e.jsxs(r,{variant:"outline",className:"gap-2 rounded-lg bg-error text-white hover:opacity-90",onClick:()=>i(!1),children:[e.jsx(w,{className:"size-4"}),"Close"]}),e.jsxs(r,{disabled:u,className:"gap-2 rounded-lg bg-primary text-white hover:opacity-90",onClick:F,children:[u?e.jsx(y,{}):null,e.jsx(Y,{className:"size-4"}),"Import Data"]})]})]})})]}),e.jsx("div",{className:"overflow-x-auto bg-base-100 rounded-bl-lg rounded-br-lg rounded-tr-lg border-l border-r border-b border-gray-300",children:H?e.jsx(y,{}):b?e.jsx("p",{className:"text-error p-4",children:b}):e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{className:"bg-primary/20 text-base-content",children:e.jsxs("tr",{className:"text-center align-middle",children:[e.jsx("th",{children:"No"}),e.jsx("th",{className:"max-w-[200px]",children:"Paket MCU"}),e.jsx("th",{children:"Nomor Pegawai"}),e.jsx("th",{children:"NIK"}),e.jsx("th",{children:"Nama"}),e.jsx("th",{children:"Gender"}),e.jsx("th",{children:"Tanggal Lahir"}),e.jsx("th",{children:"Usia"}),e.jsx("th",{children:"Kontak"})]})}),e.jsx("tbody",{className:"align-middle",children:z.map((a,n)=>e.jsxs("tr",{className:"hover:bg-base-200",children:[e.jsx("td",{className:"text-center",children:n+1+(j-1)*10}),e.jsxs("td",{className:"max-w-[200px]",children:[a.mcu_package.name,a.notes&&e.jsxs("div",{className:"text-xs text-base-content/70 mt-1",children:["Catatan: ",a.notes]})]}),e.jsx("td",{className:"text-center",children:a.company_employee_id.employee_number}),e.jsx("td",{className:"text-center",children:a.company_employee_id.nik}),e.jsx("td",{children:a.company_employee_id.name}),e.jsx("td",{className:"text-center",children:a.company_employee_id.gender}),e.jsx("td",{className:"text-center",children:N(a.company_employee_id.dob)}),e.jsx("td",{className:"text-center",children:a.company_employee_id.age_detail}),e.jsx("td",{children:a.company_employee_id.phone_number?e.jsx("a",{href:ee(a.company_employee_id.phone_number),target:"_blank",rel:"noopener noreferrer",className:" hover:underline",children:a.company_employee_id.phone_number}):"-"})]},a.id))})]})}),e.jsx(le,{page:j,lastPage:U,onPageChange:R,total:L})]}):e.jsx("p",{children:"Batch tidak ditemukan."})}export{Se as default};
